const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./YZAppHboxConfig-DNig8a74.js","./YZAppField-Cjf7z1IA.js","./YZAppHboxcellConfig-tkKkyOyL.js","./YZAppTabConfig-Bu-TdaE0.js","./YZAppTableConfig-DIni2dZX.js","./YZAppTablecellConfig-D-ifLh_8.js","./YZAppTabpanelConfig-gzMCGR1c.js","./YZAppAppgridConfig-BJgHB0Ix.js","./DataSource.hook-xWt3JEDX.js","./main-BnXXyOo5.js","./main-CVDmtNd4.css","./formStore-Byb73AL_.js","./YZAppFmsvrgridConfig-B_qPPVm6.js","./YZAppSegmentbarConfig-m6ExtRdf.js","./YZAppButtontoolConfig-UaPmzP6w.js","./YZAppFmdeletebtntoolConfig-C43x79iY.js","./YZAppFmsvcbuttontoolConfig-CsunTHch.js","./YZAppFmsvraddbuttontoolConfig-Bxnphd0-.js","./YZAppFmsvrdeletebuttontoolConfig-C3Ul4_4a.js","./YZAppFmsvreditbuttontoolConfig-DQnSCTVK.js","./YZAppFmsvrreadbuttontoolConfig-CMzDMxUA.js"])))=>i.map(i=>d[i]);
import{Z as FieldEnv,A as useRoute,E as useRouter,m as ref,o as onMounted,p as useGetQuery,K as useMessage,Y as v4,_ as __vitePreload,d as defineComponent,a as createElementBlock,g as openBlock,b as createVNode,r as resolveComponent,e as withCtx,h as createBaseVNode,s as createBlock,F as Fragment,j as renderList,a5 as resolveDynamicComponent,ab as Suspense,X as useLoading,n as createCommentVNode,u as unref}from"./main-BnXXyOo5.js";import{_ as __variableDynamicImportRuntimeHelper}from"./dynamic-import-helper-BheWnx7M.js";import{u as useAppRuntimeStore}from"./appStore-vESM88W9.js";import{A as Appurls}from"./appurl-DnExzjDg.js";const useParser=()=>{const parseSrcModel=controlStr=>{if(!controlStr.startsWith("Ext")){const d=controlStr.indexOf("Ext");d>-1&&(controlStr=controlStr.substring(d))}const startindex=controlStr.indexOf("{"),lastIndex=controlStr.lastIndexOf(")"),value=controlStr.substring(startindex,lastIndex),obj=eval("("+value+")");return obj},parseSrcComponent=d=>{const t=d.definition.components,u={definition:{components:{},items:d.definition.$items},validators:d.validators,funcs:d.funcs};return Object.keys(t).forEach(e=>{const g=t[e].allowBlank;u.definition.components[e]={fieldLabel:t[e].fieldLabel??t[e].title,bindModel:t[e].$bind,ctype:t[e].ctype,uniqueId:t[e].uniqueId,options:{},fieldKey:e,placeholder:t[e].emptyText,required:g!==void 0,$disable:t[e].$disable,$hidden:t[e].$hidden,$express:t[e].$express,fieldEnv:FieldEnv.POST,fieldRequeired:g!==void 0,flagSource:!1},delete t[e].fieldLabel,delete t[e].title,delete t[e].$bind,delete t[e].uniqueId,delete t[e].ctype,u.definition.components[e].options={...t[e]}}),u};return{parseSrcModel,parseSrcComponent}},appParse=()=>{const parseAppDefinedtion=defintionString=>{const obj=eval("("+defintionString+")");return obj},parseAppSrcComponent=d=>{const t=d.definition.components,u={definition:{components:{},items:d.definition.$items},funcs:d.funcs};return Object.keys(t).forEach(e=>{u.definition.components[e]={fieldLabel:t[e].fieldLabel??t[e].title,ctype:t[e].ctype,uniqueId:t[e].uniqueId,options:{},fieldKey:e,bindModel:t[e].$bind},delete t[e].fieldLabel,delete t[e].uniqueId,delete t[e].ctype,u.definition.components[e].options={...t[e]}}),u};return{parseAppDefinedtion,parseAppSrcComponent}},layoutConst=["hbox","table","hboxcell","tablecell","tab","tabpanel"],{parseAppDefinedtion,parseAppSrcComponent}=appParse(),{parseSrcModel}=useParser(),appStore=useAppRuntimeStore(),useAppHook=()=>{const d=useRoute(),t=useRouter(),u=ref("测试应用"),e=ref([]),g=ref(!1);onMounted(async()=>{await C(),g.value=!0});const C=async()=>{const o=d.params.appId;if(o){const n=Appurls.getAppDefinedtion.url.toFetchUrl({params1:o}),{data:i,success:y,errorMessage:f}=await useGetQuery(n);if(y){u.value=i.name;const m=parseAppDefinedtion(i.definition),v=parseSrcModel(m.src),_=parseAppSrcComponent(v),s=await w(String(o),_);return e.value=s,appStore.setAppCfgs(String(o),e.value),s}else return useMessage(f,"danger"),[]}return[]},w=async(o,n)=>{const{definition:i}=n,{items:y,components:f}=i;appStore.setAppFormId(o),appStore.setAppFuncs(o,n.funcs);const m=[],v=v4(),_="$$root";for(const s of y){const p=s.replace(/\d+/g,""),a=f[s];if(layoutConst.includes(p)){a.ctype=p;const r=await b(a);if(r){r.rowId=v,r.rowPId=_,r.uuid=v4();const c=r.options.$items,l=await A(f,v,r.rowPId,c);r.children.push(...l),m.push(r)}}else if(a.ctype==="fmsvrgrid"){const r=await P(a);if(r){const c=r;c.rowId=v,c.rowPId=_,c.uuid=v4();const l=c.options.$tools;if(l&&l.length>0)for(const $ of l){const h=f[$];h.ctype=h.ctype+"tool";const I=await E(h);I&&(I.uuid=v4(),c.tools.push(I))}m.push(r)}}else if(a.ctype==="appgrid"){const r=await P(a);if(r){const c=r;c.rowId=v,c.rowPId=_,c.uuid=v4();const l=c.options.$tools;if(l&&l.length>0)for(const $ of l){const h=f[$];h.ctype=h.ctype+"tool";const I=await E(h);I&&(I.uuid=v4(),c.tools.push(I))}m.push(r)}}else{const r=await P(a);r&&(r.rowId=v,r.rowPId=_,r.uuid=v4(),m.push(r))}}return m},b=async o=>{try{if(!o.ctype)return null;o.ctype=`YZApp${o.ctype.toPascalCase()}`;const n=`${o.ctype}Config`,i=await __variableDynamicImportRuntimeHelper(Object.assign({"./contorls/layouts/YZAppHboxConfig.ts":()=>__vitePreload(()=>import("./YZAppHboxConfig-DNig8a74.js"),__vite__mapDeps([0,1]),import.meta.url),"./contorls/layouts/YZAppHboxcellConfig.ts":()=>__vitePreload(()=>import("./YZAppHboxcellConfig-tkKkyOyL.js"),__vite__mapDeps([2,1]),import.meta.url),"./contorls/layouts/YZAppTabConfig.ts":()=>__vitePreload(()=>import("./YZAppTabConfig-Bu-TdaE0.js"),__vite__mapDeps([3,1]),import.meta.url),"./contorls/layouts/YZAppTableConfig.ts":()=>__vitePreload(()=>import("./YZAppTableConfig-DIni2dZX.js"),__vite__mapDeps([4,1]),import.meta.url),"./contorls/layouts/YZAppTablecellConfig.ts":()=>__vitePreload(()=>import("./YZAppTablecellConfig-D-ifLh_8.js"),__vite__mapDeps([5,1]),import.meta.url),"./contorls/layouts/YZAppTabpanelConfig.ts":()=>__vitePreload(()=>import("./YZAppTabpanelConfig-gzMCGR1c.js"),__vite__mapDeps([6,1]),import.meta.url)}),`./contorls/layouts/${n}.ts`,4);return i&&i[n]?new i[n](o):null}catch(n){return console.log("error",n),null}},A=async(o,n,i,y)=>{const f=[];for(const m of y){const v=m.replace(/\d+/g,""),_=o[m];if(layoutConst.includes(v)){_.ctype=v;const s=await b(_);if(s){s.rowId=n,s.rowPId=i,s.uuid=v4();const p=s.options.$items,a=await A(o,n,s.rowPId,p);s.children.push(...a),f.push(s)}}else if(_.ctype==="fmsvrgrid"){const s=await P(_);if(s){const p=s;p.rowId=n,p.rowPId=i,p.uuid=v4();const a=p.options.$tools;if(a&&a.length>0)for(const r of a){const c=o[r];c.ctype=c.ctype+"tool";const l=await E(c);l&&(l.uuid=v4(),p.tools.push(l))}f.push(s)}}else if(_.ctype==="appgrid"){const s=await P(_);if(s){const p=s;p.rowId=n,p.rowPId=i,p.uuid=v4();const a=p.options.$tools;if(a&&a.length>0)for(const r of a){const c=o[r];c.ctype=c.ctype+"tool";const l=await E(c);l&&(l.uuid=v4(),p.tools.push(l))}f.push(s)}}else{const s=await P(_);s&&(s.rowId=n,s.rowPId=i,s.uuid=v4(),f.push(s))}}return f},P=async o=>{try{if(!o.ctype)return null;o.ctype=`YZApp${o.ctype.toPascalCase()}`;const n=`${o.ctype}Config`,i=await __variableDynamicImportRuntimeHelper(Object.assign({"./contorls/fields/YZAppAppgridConfig.ts":()=>__vitePreload(()=>import("./YZAppAppgridConfig-BJgHB0Ix.js"),__vite__mapDeps([7,1,8,9,10,11]),import.meta.url),"./contorls/fields/YZAppFmsvrgridConfig.ts":()=>__vitePreload(()=>import("./YZAppFmsvrgridConfig-B_qPPVm6.js"),__vite__mapDeps([12,1,8,9,10,11]),import.meta.url),"./contorls/fields/YZAppSegmentbarConfig.ts":()=>__vitePreload(()=>import("./YZAppSegmentbarConfig-m6ExtRdf.js"),__vite__mapDeps([13,1]),import.meta.url)}),`./contorls/fields/${n}.ts`,4);return i&&i[n]?new i[n](o):null}catch(n){return console.log("error",n),null}},E=async o=>{try{if(!o.ctype)return null;o.ctype=`YZApp${o.ctype.toPascalCase()}`;const n=`${o.ctype}Config`,i=await __variableDynamicImportRuntimeHelper(Object.assign({"./contorls/tools/YZAppButtontoolConfig.ts":()=>__vitePreload(()=>import("./YZAppButtontoolConfig-UaPmzP6w.js"),__vite__mapDeps([14,1]),import.meta.url),"./contorls/tools/YZAppFmdeletebtntoolConfig.ts":()=>__vitePreload(()=>import("./YZAppFmdeletebtntoolConfig-C43x79iY.js"),__vite__mapDeps([15,1]),import.meta.url),"./contorls/tools/YZAppFmsvcbuttontoolConfig.ts":()=>__vitePreload(()=>import("./YZAppFmsvcbuttontoolConfig-CsunTHch.js"),__vite__mapDeps([16,1]),import.meta.url),"./contorls/tools/YZAppFmsvraddbuttontoolConfig.ts":()=>__vitePreload(()=>import("./YZAppFmsvraddbuttontoolConfig-Bxnphd0-.js"),__vite__mapDeps([17,1]),import.meta.url),"./contorls/tools/YZAppFmsvrdeletebuttontoolConfig.ts":()=>__vitePreload(()=>import("./YZAppFmsvrdeletebuttontoolConfig-C3Ul4_4a.js"),__vite__mapDeps([18,1]),import.meta.url),"./contorls/tools/YZAppFmsvreditbuttontoolConfig.ts":()=>__vitePreload(()=>import("./YZAppFmsvreditbuttontoolConfig-DQnSCTVK.js"),__vite__mapDeps([19,1]),import.meta.url),"./contorls/tools/YZAppFmsvrreadbuttontoolConfig.ts":()=>__vitePreload(()=>import("./YZAppFmsvrreadbuttontoolConfig-CMzDMxUA.js"),__vite__mapDeps([20,1]),import.meta.url)}),`./contorls/tools/${n}.ts`,4);return i&&i[n]?new i[n](o):null}catch(n){return console.log("error",n),null}};return{appName:u,onLeftClick:()=>{t.go(-1)},isRender:g,appCfgs:e}},_hoisted_1$1={class:""},_hoisted_2$1={class:"form-item"},_sfc_main$1=defineComponent({__name:"AppRender",props:{appCfgs:{default:()=>[]}},setup(d){const t=ref(),u=ref({}),e=()=>{setTimeout(()=>{t.value&&t.value.remove()},300)},g=()=>{const C=useLoading();t.value=C};return(C,w)=>{const b=resolveComponent("van-cell-group");return openBlock(),createElementBlock("div",_hoisted_1$1,[createVNode(b,{border:""},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$1,[(openBlock(),createBlock(Suspense,{onResolve:e,onPending:g},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(C.appCfgs,A=>(openBlock(),createElementBlock("div",{key:A.uniqueId},[(openBlock(),createBlock(resolveDynamicComponent(A.ctype),{parentId:A.rowId,appcfg:A,formRow:u.value},null,8,["parentId","appcfg","formRow"]))]))),128))]),_:1}))])]),_:1})])}}}),_hoisted_1={class:"app-main"},_hoisted_2={class:"app-main-header"},_hoisted_3={key:0,class:"app-main-list"},_sfc_main=defineComponent({__name:"index",setup(d){const{appName:t,onLeftClick:u,appCfgs:e,isRender:g}=useAppHook();return(C,w)=>{const b=resolveComponent("YZNav");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createVNode(b,{title:unref(t),leftText:C.$t("Global.Back"),onOnLeftClick:unref(u),rightText:""},null,8,["title","leftText","onOnLeftClick"])]),unref(g)?(openBlock(),createElementBlock("div",_hoisted_3,[createVNode(_sfc_main$1,{appCfgs:unref(e)},null,8,["appCfgs"])])):createCommentVNode("",!0)])}}});export{_sfc_main as default};
