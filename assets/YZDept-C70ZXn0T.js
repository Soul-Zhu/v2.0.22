import{d as S,L as w,W as _,M as x,m,c as F,o as O,Z as y,x as R,q as b,p as D,K as B,Q as E,w as N,a as T,l as W,v as k,u as i,h as G,b as U,i as K,r as L,G as Q,g as Z}from"./main-BnXXyOo5.js";import{u as q}from"./useFormEnv-VwQXjqJl.js";import{u as z}from"./formWatch-KqHO0hI-.js";import"./encodeext-DBC3bVZy.js";import"./useInitFieldState-EKN-2KHT.js";const X=S({__name:"YZDept",props:w({cfg:{},formRow:{}},{modelValue:{type:String,default:""},modelModifiers:{}}),emits:w(["update:field"],["update:modelValue"]),setup(f,{emit:V}){const{WatchSelfExpress:I,WatchChageExpress:$}=z(),d=_(),{getFormEnv:C}=q(),v=C(),c=x(f,"modelValue"),o=f,s=m(o.cfg),n=m(""),l=F(()=>{const e=d.getCurrentFormId;return d.getRuningOuId(e)}),u=F(()=>{const e=d.getCurrentFormId;return d.getRuningProviderName(e)});O(async()=>{let e=c.value;v===y.POST?!e&&u.value&&l.value&&(e=`${u.value}.${l.value}`):!e&&l.value&&l.value.indexOf(".")<0&&(e=u.value+"."+l.value),await p(e),R(()=>{M(),I(s.value,o.formRow,a=>{},a=>{s.value.hidden=a,g("update:field",s.value)},a=>{},a=>{})})});const p=async e=>{if(!e)return;const a=b.getInitUserDepart.url.toFetchUrl({params1:e}),{success:r,data:t,errorMessage:P}=await D(a,{dc:new Date().getTime(),showFullPath:o.cfg.showFullPath});r?(n.value=t.name,o.cfg.showFullPath&&(n.value=t.friendlyName),v===y.POST&&(c.value=e)):B(P)},g=V,h=m(""),M=()=>{const e=s.value,a=`setHidden_${e.uuid}_${e.fullKey}`,r=`setClose_${e.uuid}`;E.on(a,t=>{s.value.hidden=t,g("update:field",s.value)}),E.on(r,t=>{h.value=t})};return N(l,async(e,a)=>{e&&u.value&&await p(`${u.value}.${e}`)}),N(()=>c.value,async(e,a)=>{$(o.cfg,e)}),(e,a)=>{const r=L("van-field");return Z(),T("div",{class:Q(i(h))},[W(G("div",null,[U(r,{label:i(s).fieldLabel,disabled:"",placeholder:e.$t("Form.systemGenerate"),modelValue:i(n),"onUpdate:modelValue":a[0]||(a[0]=t=>K(n)?n.value=t:null)},null,8,["label","placeholder","modelValue"])],512),[[k,!i(s).hidden]])],2)}}});export{X as default};
