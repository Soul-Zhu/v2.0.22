import{d as g,W as p,c as v,m as h,s as F,e as I,u as _,r as y,g as C,k,t as E,q as R,p as b,P as i,y as c,Q as N,Z as l}from"./main-BnXXyOo5.js";import{u as D}from"./useFormEnv-VwQXjqJl.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const w=g({__name:"YZChangeField",props:{btnName:{},componentName:{},action:{},icon:{},others:{},hairline:{type:Boolean},env:{}},setup(B){const n=p(),a=v(()=>n.getCurrentFormId),{getFormEnv:u}=D(),d=()=>{const e=u();return e==l.READ?n.getProcessReadDefined(a.value).taskId:e==l.REQUEST?n.getProcessRequestDefined(a.value).taskId:n.getRuningProcessInfoDefined(a.value).taskId},t=h(!1),m=async()=>{if(t.value=!t.value,n.setRuningChangeFields(a.value,[]),t.value){const e=d(),o=R.getChangedfields.url.toFetchUrl({params1:e}),s=await b(o);if(s.success){let r=s.data.changedFields;if(r.length===0){i({type:"warning",message:c("Form.FieldNoEdit")}),t.value=!t.value;return}const f=r.length;i({type:"success",message:c("Form.EditCount",{count:f})}),n.setRuningChangeFields(a.value,r)}else i({type:"danger",message:s.errorMessage})}N.emit("onForm_MoreClose",!1)};return(e,o)=>{const s=y("van-button");return C(),F(s,{plain:"",type:_(t)?"primary":"default",icon:e.icon,hairline:e.hairline,size:"small",onClick:m,block:""},{default:I(()=>[k(E(e.btnName),1)]),_:1},8,["type","icon","hairline"])}}}),T=q(w,[["__scopeId","data-v-bd8df803"]]);export{T as default};
