import{d as M,L as y,M as R,m as v,w as V,o as D,x as F,Q as p,a as K,l as q,v as H,u as o,h as W,b as x,e as L,i as U,r as j,G as z,g as G}from"./main-BnXXyOo5.js";import{_ as I}from"./YZChangeFieldTag.vue_vue_type_style_index_0_lang-CU_sMXjx.js";import{u as O}from"./formWatch-KqHO0hI-.js";import"./encodeext-DBC3bVZy.js";import"./useFormEnv-VwQXjqJl.js";import"./useInitFieldState-EKN-2KHT.js";const X=M({__name:"YZNumber",props:y({cfg:{},formRow:{}},{modelValue:{type:[String,Number]},modelModifiers:{}}),emits:y(["update:field"],["update:modelValue"]),setup(h,{emit:w}){const n=R(h,"modelValue"),m=h,t=v(m.cfg),E=v(!1),r=v("");V(()=>n.value,(e,l)=>{r.value=g(n.value)});const g=e=>{E.value=!0;const l=t.value;let a=S(e);if(!a)return"";let s=a.replaceAll(",","").replaceAll(l.currency,"");l.digit&&l.digit>0&&(s=Number(s).toFixed(l.digit));let d=String(s).split(".")[0],i=String(s).split(".")[1];if(l.digit&&l.digit>0)if(i){i=b(i,l.digit);const f="."+b(i,l.digit);a=d+f}else{const f=".".padEnd(l.digit+1,"0");i=f.replace(".",""),a=d+f}else i="",a=d;if(l.thousands){const u=a.split(".")[0].replace(/\B(?=(\d{3})+$)/g,",");i?a=`${u}.${i}`:a=`${u}`}return l.currency&&(a=`${l.currency}${a}`),n.value=s,a},S=e=>{n.value==0&&e==""&&(e=null),typeof e!="string"&&(e=String(e));const l=t.value.currenctData,a=[];let s=0;for(let d=0;d<e.length;d++){const i=e[d];if((i===","||i==="-")&&a.push(i),l.includes(i)&&a.push(i),i==="."&&(s++,a.push(i)),isNaN(Number(i))||a.push(i),i!==","&&i!=="."&&i!=="-"&&!l.includes(i)&&isNaN(Number(i))){a.length=0;break}}return s>1?"":a.join("")},b=(e,l)=>{let a="";for(let s=0;s<e.length&&!(s>l);s++)s<l&&(a+=e[s]);return l-e.length!==0&&(a=a.padEnd(l,"0")),a},A=()=>{_(n.value)},_=e=>{if(!e){r.value="";return}String(e).replaceAll(",","").replaceAll(t.value.currency,""),r.value=e},{WatchChageExpress:$,WatchSelfExpress:C}=O();D(()=>{(n.value!=""||n.value!=null)&&(r.value=g(String(n.value))),F(()=>{C(t.value,m.formRow,e=>{n.value=e},e=>{t.value.hidden=e,c("update:field",t.value)},e=>{t.value.disabled=e,c("update:field",t.value)},e=>{t.value.hidden=e,c("update:field",t.value)})}),B()}),V(()=>r.value,(e,l)=>{k(e)});const k=e=>{e=String(e),_(e);const l=e.replaceAll(",","").replaceAll(t.value.currency,"");n.value=l,$(t.value,l,m.formRow)},c=w,N=v(""),B=()=>{const e=t.value,l=`setDisabled_${e.uuid}_${e.fullKey}`,a=`setHidden_${e.uuid}_${e.fullKey}`,s=`setColumnHidden_${e.uuid}_${e.fullKey}`,d=`setRules_${e.uuid}_${e.fullKey}`,i=`autoActiveEvent_${e.uuid}_${e.fullKey}`,f=`setClose_${e.uuid}`;p.on(l,u=>{t.value.disabled=u,c("update:field",t.value)}),p.on(a,u=>{t.value.hidden=u,c("update:field",t.value)}),p.on(s,u=>{t.value.hidden=u,c("update:field",t.value)}),p.on(d,u=>{t.value.rules=[u],c("update:field",t.value)}),p.on(i,u=>{$(m.cfg,n.value,m.formRow)}),p.on(f,u=>{N.value=u})};return(e,l)=>{const a=j("van-field");return G(),K("div",{class:z(o(N))},[q(W("div",null,[x(a,{border:"",modelValue:o(r),"onUpdate:modelValue":l[0]||(l[0]=s=>U(r)?r.value=s:null),disabled:o(t).disabled,required:o(t).required,rules:o(t).rules,onFocus:A,name:o(t).bindModel,label:o(t).fieldLabel,formatter:g,"format-trigger":"onBlur",placeholder:o(t).placeholder},{button:L(()=>[x(I,{field:o(t)},null,8,["field"])]),_:1},8,["modelValue","disabled","required","rules","name","label","placeholder"])],512),[[H,!o(t).hidden]])],2)}}});export{X as default};
