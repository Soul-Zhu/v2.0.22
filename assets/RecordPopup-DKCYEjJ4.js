const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ActivityNode-Ck9zNWes.js","./main-BnXXyOo5.js","./main-CVDmtNd4.css","./useFormEnv-VwQXjqJl.js","./_plugin-vue_export-helper-DlAUqK2U.js","./CallProcessNode-CHkK6tNm.js","./ConditionNode-CYl7dxNs.js","./DecisionNode-DJ8vpOy5.js","./EndNode-g8LYcBny.js","./InformNode-CgvM1kGY.js","./NodeText-Dmn4nlpl.js","./NotifyNode-BQABkVgM.js","./StartNode-ifew5xyC.js"])))=>i.map(i=>d[i]);
import{d as xa,s as Fe,g as H,r as Me,e as Lt,a as q,F as Or,j as en,h as lt,n as Dt,t as F,k as je,u as gt,aN as Ja,V as hu,b as de,y as pt,ap as vu,_ as be,Z as we,q as _r,p as po,K as wr,Y as _f,L as mf,M as yu,o as xf,A as gu,w as Ti,m as Ze,aI as Ef,x as bf,W as Of,c as wf,i as Qa,J as Sf}from"./main-BnXXyOo5.js";import{u as Mf}from"./useFormEnv-VwQXjqJl.js";import{_ as Ea}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Af={class:"step-div"},Tf={key:0},Pf={class:"step-name"},Df={class:"step-p",style:{color:"red"}},Nf={key:1},Cf={class:"step-name"},Rf={key:0,style:{color:"red"}},jf={key:1},Lf={class:"step-p"},If={class:"step-span"},Bf={key:0,class:"step-p",style:{color:"red"}},$f={class:"step-p"},Xf={class:"step-span",style:{color:"#ee7739"}},Ff={class:"step-p"},kf={key:0,class:"step-span"},Hf={class:"step-p"},Yf={key:2},Gf={key:0,class:"step-p",style:{margin:"0px"}},Uf={key:3},zf={key:0,class:"step-p",style:{margin:"0px"}},Wf=xa({__name:"TimeRecord",props:{steps:{}},setup(e){const t=r=>{if(r==="Rejected")return pt("Form.TaskReject");if(r==="Aborted")return pt("Form.TaskCancle");if(r==="Approved")return pt("Work.TaskApprov")};return(r,n)=>{const o=Me("van-tag"),i=Me("van-step"),a=Me("van-steps");return H(),Fe(a,{direction:"vertical",active:"1"},{default:Lt(()=>[(H(!0),q(Or,null,en(r.steps,(s,l)=>(H(),Fe(i,{key:l},{default:Lt(()=>[lt("div",Af,[s.isEndStep?(H(),q("div",Tf,[lt("p",Pf,F(s.NodeDisplayName),1),lt("p",Df,F(t(s.TaskState)),1)])):(H(),q("div",Nf,[lt("p",Cf,[s.NodeDisplayName=="SysTaskOpt"?(H(),q("span",Rf,F(s.SelActionDisplayString),1)):(H(),q("span",jf,F(s.NodeDisplayName),1))]),lt("p",Lf,[je(F(r.$t("Form.startTime"))+": ",1),lt("span",If,F(gt(Ja)(s.ReceiveAt)),1)]),lt("p",{class:"step-p",style:hu(s.handlerColor)},F(s.handlerText),5),s.otherRedText?(H(),q("p",Bf,F(s.otherRedText),1)):Dt("",!0),lt("p",$f,[je(F(r.$t("Form.comment"))+": ",1),lt("span",Xf,F(s.Comments),1)]),lt("p",Ff,[je(F(r.$t("Form.processDealDate"))+": ",1),s.Finished?(H(),q("span",kf,F(gt(Ja)(s.FinishAt)),1)):Dt("",!0)]),lt("p",Hf,[je(F(r.$t("Global.Status"))+": ",1),s.Finished?(H(),Fe(o,{key:0,type:"success"},{default:Lt(()=>[je(F(r.$t("Form.Handled")),1)]),_:1})):s.Finished?Dt("",!0):(H(),Fe(o,{key:1,type:"danger"},{default:Lt(()=>[je(F(r.$t("Form.Processing")),1)]),_:1}))])])),s.fllowSteps&&s.fllowSteps.length>0?(H(),q("div",Yf,[(H(!0),q(Or,null,en(s.fllowSteps,u=>(H(),q("div",{class:"child-div",key:u.StepID},[lt("b",null,F(u.RecipientDisplayName)+"("+F(u.RecipientAccount)+")",1),de(o,{type:u.Finished?"success":"warning"},{default:Lt(()=>[je(F(u.Finished?r.$t("Work.Read"):r.$t("Work.NotifyWork")),1)]),_:2},1032,["type"]),u.Finished?(H(),q("p",Gf,F(r.$t("Work.HandleComments"))+":"+F(u.Comments),1)):Dt("",!0)]))),128))])):Dt("",!0),s.consignSteps&&s.consignSteps.length>0?(H(),q("div",Uf,[(H(!0),q(Or,null,en(s.consignSteps,u=>(H(),q("div",{class:"child-div",key:u.StepID},[lt("b",null,F(u.RecipientDisplayName)+"("+F(u.RecipientAccount)+")",1),de(o,{type:u.Finished?"success":"warning"},{default:Lt(()=>[je(F(u.Finished?r.$t("Form.SignatureDealed"):r.$t("Form.Signing")),1)]),_:2},1032,["type"]),u.Finished?(H(),q("p",zf,F(r.$t("Work.HandleComments"))+":"+F(u.Comments),1)):Dt("",!0)]))),128))])):Dt("",!0)])]),_:2},1024))),128))]),_:1})}}}),Vf=Ea(Wf,[["__scopeId","data-v-686e5838"]]);var Ho,Y,_u,qe,ts,mu,xu,Eu,ba,Pi,Di,yn={},bu=[],Kf=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Tn=Array.isArray;function Ae(e,t){for(var r in t)e[r]=t[r];return e}function Oa(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Sr(e,t,r){var n,o,i,a={};for(i in t)i=="key"?n=t[i]:i=="ref"?o=t[i]:a[i]=t[i];if(arguments.length>2&&(a.children=arguments.length>3?Ho.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(i in e.defaultProps)a[i]==null&&(a[i]=e.defaultProps[i]);return so(e,a,n,o,null)}function so(e,t,r,n,o){var i={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++_u,__i:-1,__u:0};return o==null&&Y.vnode!=null&&Y.vnode(i),i}function Yo(){return{current:null}}function Mr(e){return e.children}function W(e,t){this.props=e,this.context=t}function Ar(e,t){if(t==null)return e.__?Ar(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?Ar(e):null}function Ou(e){var t,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return Ou(e)}}function es(e){(!e.__d&&(e.__d=!0)&&qe.push(e)&&!ho.__r++||ts!=Y.debounceRendering)&&((ts=Y.debounceRendering)||mu)(ho)}function ho(){for(var e,t,r,n,o,i,a,s=1;qe.length;)qe.length>s&&qe.sort(xu),e=qe.shift(),s=qe.length,e.__d&&(r=void 0,o=(n=(t=e).__v).__e,i=[],a=[],t.__P&&((r=Ae({},n)).__v=n.__v+1,Y.vnode&&Y.vnode(r),wa(t.__P,r,n,t.__n,t.__P.namespaceURI,32&n.__u?[o]:null,i,o??Ar(n),!!(32&n.__u),a),r.__v=n.__v,r.__.__k[r.__i]=r,Mu(i,r,a),r.__e!=o&&Ou(r)));ho.__r=0}function wu(e,t,r,n,o,i,a,s,l,u,f){var d,c,p,v,h,_,y=n&&n.__k||bu,m=t.length;for(l=Zf(r,t,y,l,m),d=0;d<m;d++)(p=r.__k[d])!=null&&(c=p.__i==-1?yn:y[p.__i]||yn,p.__i=d,_=wa(e,p,c,o,i,a,s,l,u,f),v=p.__e,p.ref&&c.ref!=p.ref&&(c.ref&&Sa(c.ref,null,p),f.push(p.ref,p.__c||v,p)),h==null&&v!=null&&(h=v),4&p.__u||c.__k===p.__k?l=Su(p,l,e):typeof p.type=="function"&&_!==void 0?l=_:v&&(l=v.nextSibling),p.__u&=-7);return r.__e=h,l}function Zf(e,t,r,n,o){var i,a,s,l,u,f=r.length,d=f,c=0;for(e.__k=new Array(o),i=0;i<o;i++)(a=t[i])!=null&&typeof a!="boolean"&&typeof a!="function"?(l=i+c,(a=e.__k[i]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?so(null,a,null,null,null):Tn(a)?so(Mr,{children:a},null,null,null):a.constructor==null&&a.__b>0?so(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=e,a.__b=e.__b+1,s=null,(u=a.__i=qf(a,r,l,d))!=-1&&(d--,(s=r[u])&&(s.__u|=2)),s==null||s.__v==null?(u==-1&&(o>f?c--:o<f&&c++),typeof a.type!="function"&&(a.__u|=4)):u!=l&&(u==l-1?c--:u==l+1?c++:(u>l?c--:c++,a.__u|=4))):e.__k[i]=null;if(d)for(i=0;i<f;i++)(s=r[i])!=null&&!(2&s.__u)&&(s.__e==n&&(n=Ar(s)),Tu(s,s));return n}function Su(e,t,r){var n,o;if(typeof e.type=="function"){for(n=e.__k,o=0;n&&o<n.length;o++)n[o]&&(n[o].__=e,t=Su(n[o],t,r));return t}e.__e!=t&&(t&&e.type&&!r.contains(t)&&(t=Ar(e)),r.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function vo(e,t){return t=t||[],e==null||typeof e=="boolean"||(Tn(e)?e.some(function(r){vo(r,t)}):t.push(e)),t}function qf(e,t,r,n){var o,i,a=e.key,s=e.type,l=t[r];if(l===null&&e.key==null||l&&a==l.key&&s==l.type&&!(2&l.__u))return r;if(n>(l!=null&&!(2&l.__u)?1:0))for(o=r-1,i=r+1;o>=0||i<t.length;){if(o>=0){if((l=t[o])&&!(2&l.__u)&&a==l.key&&s==l.type)return o;o--}if(i<t.length){if((l=t[i])&&!(2&l.__u)&&a==l.key&&s==l.type)return i;i++}}return-1}function rs(e,t,r){t[0]=="-"?e.setProperty(t,r??""):e[t]=r==null?"":typeof r!="number"||Kf.test(t)?r:r+"px"}function Xn(e,t,r,n,o){var i;t:if(t=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||rs(e.style,t,"");if(r)for(t in r)n&&r[t]==n[t]||rs(e.style,t,r[t])}else if(t[0]=="o"&&t[1]=="n")i=t!=(t=t.replace(Eu,"$1")),t=t.toLowerCase()in e||t=="onFocusOut"||t=="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=r,r?n?r.u=n.u:(r.u=ba,e.addEventListener(t,i?Di:Pi,i)):e.removeEventListener(t,i?Di:Pi,i);else{if(o=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=r??"";break t}catch{}typeof r=="function"||(r==null||r===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&r==1?"":r))}}function ns(e){return function(t){if(this.l){var r=this.l[t.type+e];if(t.t==null)t.t=ba++;else if(t.t<r.u)return;return r(Y.event?Y.event(t):t)}}}function wa(e,t,r,n,o,i,a,s,l,u){var f,d,c,p,v,h,_,y,m,S,M,A,b,g,x,T,P,j=t.type;if(t.constructor!=null)return null;128&r.__u&&(l=!!(32&r.__u),i=[s=t.__e=r.__e]),(f=Y.__b)&&f(t);t:if(typeof j=="function")try{if(y=t.props,m="prototype"in j&&j.prototype.render,S=(f=j.contextType)&&n[f.__c],M=f?S?S.props.value:f.__:n,r.__c?_=(d=t.__c=r.__c).__=d.__E:(m?t.__c=d=new j(y,M):(t.__c=d=new W(y,M),d.constructor=j,d.render=Qf),S&&S.sub(d),d.props=y,d.state||(d.state={}),d.context=M,d.__n=n,c=d.__d=!0,d.__h=[],d._sb=[]),m&&d.__s==null&&(d.__s=d.state),m&&j.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=Ae({},d.__s)),Ae(d.__s,j.getDerivedStateFromProps(y,d.__s))),p=d.props,v=d.state,d.__v=t,c)m&&j.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),m&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(m&&j.getDerivedStateFromProps==null&&y!==p&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(y,M),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(y,d.__s,M)===!1||t.__v==r.__v){for(t.__v!=r.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some(function(L){L&&(L.__=t)}),A=0;A<d._sb.length;A++)d.__h.push(d._sb[A]);d._sb=[],d.__h.length&&a.push(d);break t}d.componentWillUpdate!=null&&d.componentWillUpdate(y,d.__s,M),m&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(p,v,h)})}if(d.context=M,d.props=y,d.__P=e,d.__e=!1,b=Y.__r,g=0,m){for(d.state=d.__s,d.__d=!1,b&&b(t),f=d.render(d.props,d.state,d.context),x=0;x<d._sb.length;x++)d.__h.push(d._sb[x]);d._sb=[]}else do d.__d=!1,b&&b(t),f=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++g<25);d.state=d.__s,d.getChildContext!=null&&(n=Ae(Ae({},n),d.getChildContext())),m&&!c&&d.getSnapshotBeforeUpdate!=null&&(h=d.getSnapshotBeforeUpdate(p,v)),T=f,f!=null&&f.type===Mr&&f.key==null&&(T=Au(f.props.children)),s=wu(e,Tn(T)?T:[T],t,r,n,o,i,a,s,l,u),d.base=t.__e,t.__u&=-161,d.__h.length&&a.push(d),_&&(d.__E=d.__=null)}catch(L){if(t.__v=null,l||i!=null)if(L.then){for(t.__u|=l?160:128;s&&s.nodeType==8&&s.nextSibling;)s=s.nextSibling;i[i.indexOf(s)]=null,t.__e=s}else for(P=i.length;P--;)Oa(i[P]);else t.__e=r.__e,t.__k=r.__k;Y.__e(L,t,r)}else i==null&&t.__v==r.__v?(t.__k=r.__k,t.__e=r.__e):s=t.__e=Jf(r.__e,t,r,n,o,i,a,l,u);return(f=Y.diffed)&&f(t),128&t.__u?void 0:s}function Mu(e,t,r){for(var n=0;n<r.length;n++)Sa(r[n],r[++n],r[++n]);Y.__c&&Y.__c(t,e),e.some(function(o){try{e=o.__h,o.__h=[],e.some(function(i){i.call(o)})}catch(i){Y.__e(i,o.__v)}})}function Au(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Tn(e)?e.map(Au):Ae({},e)}function Jf(e,t,r,n,o,i,a,s,l){var u,f,d,c,p,v,h,_=r.props,y=t.props,m=t.type;if(m=="svg"?o="http://www.w3.org/2000/svg":m=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),i!=null){for(u=0;u<i.length;u++)if((p=i[u])&&"setAttribute"in p==!!m&&(m?p.localName==m:p.nodeType==3)){e=p,i[u]=null;break}}if(e==null){if(m==null)return document.createTextNode(y);e=document.createElementNS(o,m,y.is&&y),s&&(Y.__m&&Y.__m(t,i),s=!1),i=null}if(m==null)_===y||s&&e.data==y||(e.data=y);else{if(i=i&&Ho.call(e.childNodes),_=r.props||yn,!s&&i!=null)for(_={},u=0;u<e.attributes.length;u++)_[(p=e.attributes[u]).name]=p.value;for(u in _)if(p=_[u],u!="children"){if(u=="dangerouslySetInnerHTML")d=p;else if(!(u in y)){if(u=="value"&&"defaultValue"in y||u=="checked"&&"defaultChecked"in y)continue;Xn(e,u,null,p,o)}}for(u in y)p=y[u],u=="children"?c=p:u=="dangerouslySetInnerHTML"?f=p:u=="value"?v=p:u=="checked"?h=p:s&&typeof p!="function"||_[u]===p||Xn(e,u,p,_[u],o);if(f)s||d&&(f.__html==d.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(d&&(e.innerHTML=""),wu(t.type=="template"?e.content:e,Tn(c)?c:[c],t,r,n,m=="foreignObject"?"http://www.w3.org/1999/xhtml":o,i,a,i?i[0]:r.__k&&Ar(r,0),s,l),i!=null)for(u=i.length;u--;)Oa(i[u]);s||(u="value",m=="progress"&&v==null?e.removeAttribute("value"):v!=null&&(v!==e[u]||m=="progress"&&!v||m=="option"&&v!=_[u])&&Xn(e,u,v,_[u],o),u="checked",h!=null&&h!=e[u]&&Xn(e,u,h,_[u],o))}return e}function Sa(e,t,r){try{if(typeof e=="function"){var n=typeof e.__u=="function";n&&e.__u(),n&&t==null||(e.__u=e(t))}else e.current=t}catch(o){Y.__e(o,r)}}function Tu(e,t,r){var n,o;if(Y.unmount&&Y.unmount(e),(n=e.ref)&&(n.current&&n.current!=e.__e||Sa(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){Y.__e(i,t)}n.base=n.__P=null}if(n=e.__k)for(o=0;o<n.length;o++)n[o]&&Tu(n[o],t,r||typeof e.type!="function");r||Oa(e.__e),e.__c=e.__=e.__e=void 0}function Qf(e,t,r){return this.constructor(e,r)}function tc(e,t,r){var n,o,i,a;t==document&&(t=document.documentElement),Y.__&&Y.__(e,t),o=(n=!1)?null:t.__k,i=[],a=[],wa(t,e=t.__k=Sr(Mr,null,[e]),o||yn,yn,t.namespaceURI,o?null:t.firstChild?Ho.call(t.childNodes):null,i,o?o.__e:t.firstChild,n,a),Mu(i,e,a)}Ho=bu.slice,Y={__e:function(e,t,r,n){for(var o,i,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((i=o.constructor)&&i.getDerivedStateFromError!=null&&(o.setState(i.getDerivedStateFromError(e)),a=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,n||{}),a=o.__d),a)return o.__E=o}catch(s){e=s}throw e}},_u=0,W.prototype.setState=function(e,t){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Ae({},this.state),typeof e=="function"&&(e=e(Ae({},r),this.props)),e&&Ae(r,e),e!=null&&this.__v&&(t&&this._sb.push(t),es(this))},W.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),es(this))},W.prototype.render=Mr,qe=[],mu=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,xu=function(e,t){return e.__v.__b-t.__v.__b},ho.__r=0,Eu=/(PointerCapture)$|Capture$/i,ba=0,Pi=ns(!1),Di=ns(!0);var ec="An invariant failed, however the error is obfuscated because this is a production build.",yo=[];Object.freeze(yo);var Ma={};Object.freeze(Ma);function Ct(){return++C.mobxGuid}function Q(e){throw er(!1,e),"X"}function er(e,t){if(!e)throw new Error("[mobx] "+(t||ec))}function Pu(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var Fn=function(){};function rc(e){var t=[];return e.forEach(function(r){t.indexOf(r)===-1&&t.push(r)}),t}function Aa(e){return e!==null&&typeof e=="object"}function kr(e){if(e===null||typeof e!="object")return!1;var t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}function nc(e){if(Yr(e)||Rt(e))return e;if(Array.isArray(e))return new Map(e);if(kr(e)){var t=new Map;for(var r in e)t.set(r,e[r]);return t}else return Q("Cannot convert to map from '"+e+"'")}function Hr(e,t,r){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:r})}function oc(e,t,r){Object.defineProperty(e,t,{enumerable:!1,writable:!1,configurable:!0,value:r})}function ic(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!r||r.configurable!==!1&&r.writable!==!1}function Ue(e,t){var r="isMobX"+e;return t.prototype[r]=!0,function(n){return Aa(n)&&n[r]===!0}}function Yr(e){return e instanceof Map}function Pn(e){return e instanceof Set}function Du(e){var t=new Set;for(var r in e)t.add(r);return Object.getOwnPropertySymbols(e).forEach(function(n){Object.getOwnPropertyDescriptor(e,n).enumerable&&t.add(n)}),Array.from(t)}function ke(e){return e&&e.toString?e.toString():new String(e).toString()}function Nu(e){return e===null?null:typeof e=="object"?""+e:e}var ac=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,$=Symbol("mobx administration"),Gr=function(){function e(t){t===void 0&&(t="Atom@"+Ct()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=new Set,this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=rt.NOT_TRACKING}return e.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(t){return t()})},e.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(t){return t()})},e.prototype.reportObserved=function(){return Hu(this)},e.prototype.reportChanged=function(){ee(),Tc(this),re()},e.prototype.toString=function(){return this.name},e}(),Ta=Ue("Atom",Gr);function Pa(e,t,r){t===void 0&&(t=Fn),r===void 0&&(r=Fn);var n=new Gr(e);return t!==Fn&&kc(n,t),r!==Fn&&Vu(n,r),n}function sc(e,t){return od(e,t)}function lc(e,t){return Object.is(e,t)}var Tr={structural:sc,default:lc};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ni=function(e,t){return Ni=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])},Ni(e,t)};function uc(e,t){Ni(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var go=function(){return go=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},go.apply(this,arguments)};function ve(e){var t=typeof Symbol=="function"&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function mr(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i}function Da(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(mr(arguments[t]));return e}var _o=Symbol("mobx did run lazy initializers"),qr=Symbol("mobx pending decorators"),dc={},fc={};function cc(e,t){var r=t?dc:fc;return r[e]||(r[e]={configurable:!0,enumerable:t,get:function(){return ir(this),this[e]},set:function(n){ir(this),this[e]=n}})}function ir(e){var t,r;if(e[_o]!==!0){var n=e[qr];if(n){Hr(e,_o,!0);var o=Da(Object.getOwnPropertySymbols(n),Object.keys(n));try{for(var i=ve(o),a=i.next();!a.done;a=i.next()){var s=a.value,l=n[s];l.propertyCreator(e,l.prop,l.descriptor,l.decoratorTarget,l.decoratorArguments)}}catch(u){t={error:u}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}}}}function Cu(e,t){return function(){var n,o=function(a,s,l,u){if(u===!0)return t(a,s,l,a,n),null;if(!Object.prototype.hasOwnProperty.call(a,qr)){var f=a[qr];Hr(a,qr,go({},f))}return a[qr][s]={prop:s,propertyCreator:t,descriptor:l,decoratorTarget:a,decoratorArguments:n},cc(s,e)};return pc(arguments)?(n=yo,o.apply(null,arguments)):(n=Array.prototype.slice.call(arguments),o)}}function pc(e){return(e.length===2||e.length===3)&&(typeof e[1]=="string"||typeof e[1]=="symbol")||e.length===4&&e[3]===!0}function Dn(e,t,r){return Cr(e)?e:Array.isArray(e)?O.array(e,{name:r}):kr(e)?O.object(e,void 0,{name:r}):Yr(e)?O.map(e,{name:r}):Pn(e)?O.set(e,{name:r}):e}function hc(e,t,r){return e==null||se(e)||xe(e)||Rt(e)||Gt(e)?e:Array.isArray(e)?O.array(e,{name:r,deep:!1}):kr(e)?O.object(e,void 0,{name:r,deep:!1}):Yr(e)?O.map(e,{name:r,deep:!1}):Pn(e)?O.set(e,{name:r,deep:!1}):Q(!1)}function Go(e){return e}function vc(e,t,r){return od(e,t)?t:e}function Uo(e){er(e);var t=Cu(!0,function(n,o,i,a,s){var l=i?i.initializer?i.initializer.call(n):i.value:void 0;La(n).addObservableProp(o,l,e)}),r=t;return r.enhancer=e,r}var Ru={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Ru);function gr(e){return e==null?Ru:typeof e=="string"?{name:e,deep:!0,proxy:!0}:e}var Na=Uo(Dn),yc=Uo(hc),ju=Uo(Go),gc=Uo(vc);function kn(e){return e.defaultDecorator?e.defaultDecorator.enhancer:e.deep===!1?Go:Dn}function _c(e,t,r){if(typeof arguments[1]=="string"||typeof arguments[1]=="symbol")return Na.apply(null,arguments);if(Cr(e))return e;var n=kr(e)?O.object(e,t,r):Array.isArray(e)?O.array(e,t):Yr(e)?O.map(e,t):Pn(e)?O.set(e,t):e;if(n!==e)return n;Q(!1)}var os={box:function(e,t){arguments.length>2&&Wr("box");var r=gr(t);return new nr(e,kn(r),r.name,!0,r.equals)},array:function(e,t){arguments.length>2&&Wr("array");var r=gr(t);return rp(e,kn(r),r.name)},map:function(e,t){arguments.length>2&&Wr("map");var r=gr(t);return new ja(e,kn(r),r.name)},set:function(e,t){arguments.length>2&&Wr("set");var r=gr(t);return new rd(e,kn(r),r.name)},object:function(e,t,r){typeof arguments[1]=="string"&&Wr("object");var n=gr(r);if(n.proxy===!1)return Bi({},e,t,n);var o=Zu(n),i=Bi({},void 0,void 0,n),a=Qc(i);return qu(a,e,t,o),a},ref:ju,shallow:yc,deep:Na,struct:gc},O=_c;Object.keys(os).forEach(function(e){return O[e]=os[e]});function Wr(e){Q("Expected one or two arguments to observable."+e+". Did you accidentally try to use observable."+e+" as decorator?")}var mo=Cu(!1,function(e,t,r,n,o){var i=r.get,a=r.set,s=o[0]||{};La(e).addComputedProp(e,t,go({get:i,set:a,context:e},s))}),mc=mo({equals:Tr.structural}),at=function(t,r,n){if(typeof r=="string"||t!==null&&typeof t=="object"&&arguments.length===1)return mo.apply(null,arguments);var o=typeof r=="object"?r:{};return o.get=t,o.set=typeof r=="function"?r:o.set,o.name=o.name||t.name||"",new Dr(o)};at.struct=mc;var rt;(function(e){e[e.NOT_TRACKING=-1]="NOT_TRACKING",e[e.UP_TO_DATE=0]="UP_TO_DATE",e[e.POSSIBLY_STALE=1]="POSSIBLY_STALE",e[e.STALE=2]="STALE"})(rt||(rt={}));var ge;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(ge||(ge={}));var xo=function(){function e(t){this.cause=t}return e}();function Jr(e){return e instanceof xo}function Ci(e){switch(e.dependenciesState){case rt.UP_TO_DATE:return!1;case rt.NOT_TRACKING:case rt.STALE:return!0;case rt.POSSIBLY_STALE:{for(var t=Ca(!0),r=Ur(),n=e.observing,o=n.length,i=0;i<o;i++){var a=n[i];if(Nr(a)){if(C.disableErrorBoundaries)a.get();else try{a.get()}catch{return Ye(r),rn(t),!0}if(e.dependenciesState===rt.STALE)return Ye(r),rn(t),!0}}return Bu(e),Ye(r),rn(t),!1}}}function Pr(e){var t=e.observers.size>0;C.computationDepth>0&&t&&Q(!1),!C.allowStateChanges&&(t||C.enforceActions==="strict")&&Q(!1)}function Lu(e,t,r){var n=Ca(!0);Bu(e),e.newObserving=new Array(e.observing.length+100),e.unboundDepsCount=0,e.runId=++C.runId;var o=C.trackingDerivation;C.trackingDerivation=e;var i;if(C.disableErrorBoundaries===!0)i=t.call(r);else try{i=t.call(r)}catch(a){i=new xo(a)}return C.trackingDerivation=o,xc(e),rn(n),i}function xc(e){for(var t=e.observing,r=e.observing=e.newObserving,n=rt.UP_TO_DATE,o=0,i=e.unboundDepsCount,a=0;a<i;a++){var s=r[a];s.diffValue===0&&(s.diffValue=1,o!==a&&(r[o]=s),o++),s.dependenciesState>n&&(n=s.dependenciesState)}for(r.length=o,e.newObserving=null,i=t.length;i--;){var s=t[i];s.diffValue===0&&Fu(s,e),s.diffValue=0}for(;o--;){var s=r[o];s.diffValue===1&&(s.diffValue=0,Ac(s,e))}n!==rt.UP_TO_DATE&&(e.dependenciesState=n,e.onBecomeStale())}function Ri(e){var t=e.observing;e.observing=[];for(var r=t.length;r--;)Fu(t[r],e);e.dependenciesState=rt.NOT_TRACKING}function Iu(e){var t=Ur();try{return e()}finally{Ye(t)}}function Ur(){var e=C.trackingDerivation;return C.trackingDerivation=null,e}function Ye(e){C.trackingDerivation=e}function Ca(e){var t=C.allowStateReads;return C.allowStateReads=e,t}function rn(e){C.allowStateReads=e}function Bu(e){if(e.dependenciesState!==rt.UP_TO_DATE){e.dependenciesState=rt.UP_TO_DATE;for(var t=e.observing,r=t.length;r--;)t[r].lowestObserverState=rt.UP_TO_DATE}}var Eo=0,Ec=1,is=Object.getOwnPropertyDescriptor(function(){},"name");is&&is.configurable;function rr(e,t,r){var n=function(){return $u(e,t,r||this,arguments)};return n.isMobxAction=!0,n}function $u(e,t,r,n){var o=bc();try{return t.apply(r,n)}catch(i){throw o.error=i,i}finally{Oc(o)}}function bc(e,t,r){var n=Ht(),o=0,i=Ur();ee();var a=zo(!0),s=Ca(!0),l={prevDerivation:i,prevAllowStateChanges:a,prevAllowStateReads:s,notifySpy:n,startTime:o,actionId:Ec++,parentActionId:Eo};return Eo=l.actionId,l}function Oc(e){Eo!==e.actionId&&Q("invalid action stack. did you forget to finish an action?"),Eo=e.parentActionId,e.error!==void 0&&(C.suppressReactionErrors=!0),Wo(e.prevAllowStateChanges),rn(e.prevAllowStateReads),re(),Ye(e.prevDerivation),C.suppressReactionErrors=!1}function zo(e){var t=C.allowStateChanges;return C.allowStateChanges=e,t}function Wo(e){C.allowStateChanges=e}var nr=function(e){uc(t,e);function t(r,n,o,i,a){o===void 0&&(o="ObservableValue@"+Ct()),a===void 0&&(a=Tr.default);var s=e.call(this,o)||this;return s.enhancer=n,s.name=o,s.equals=a,s.hasUnreportedChange=!1,s.value=n(r,void 0,o),s}return t.prototype.dehanceValue=function(r){return this.dehancer!==void 0?this.dehancer(r):r},t.prototype.set=function(r){this.value,r=this.prepareNewValue(r),r!==C.UNCHANGED&&this.setNewValue(r)},t.prototype.prepareNewValue=function(r){if(Pr(this),_e(this)){var n=me(this,{object:this,type:"update",newValue:r});if(!n)return C.UNCHANGED;r=n.newValue}return r=this.enhancer(r,this.value,this.name),this.equals(this.value,r)?C.UNCHANGED:r},t.prototype.setNewValue=function(r){var n=this.value;this.value=r,this.reportChanged(),ne(this)&&oe(this,{type:"update",object:this,newValue:r,oldValue:n})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(r){return Nn(this,r)},t.prototype.observe=function(r,n){return n&&r({object:this,type:"update",newValue:this.value,oldValue:void 0}),Cn(this,r)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return Nu(this.get())},t.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},t}(Gr),wc=Ue("ObservableValue",nr),Dr=function(){function e(t){this.dependenciesState=rt.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=new Set,this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=rt.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+Ct(),this.value=new xo(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=ge.NONE,er(t.get,"missing option for computed: get"),this.derivation=t.get,this.name=t.name||"ComputedValue@"+Ct(),t.set&&(this.setter=rr(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?Tr.structural:Tr.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return e.prototype.onBecomeStale=function(){Dc(this)},e.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(t){return t()})},e.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(t){return t()})},e.prototype.get=function(){this.isComputing&&Q("Cycle detected in computation "+this.name+": "+this.derivation),C.inBatch===0&&this.observers.size===0&&!this.keepAlive?Ci(this)&&(this.warnAboutUntrackedRead(),ee(),this.value=this.computeValue(!1),re()):(Hu(this),Ci(this)&&this.trackAndCompute()&&Pc(this));var t=this.value;if(Jr(t))throw t.cause;return t},e.prototype.peek=function(){var t=this.computeValue(!1);if(Jr(t))throw t.cause;return t},e.prototype.set=function(t){if(this.setter){er(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else er(!1,!1)},e.prototype.trackAndCompute=function(){var t=this.value,r=this.dependenciesState===rt.NOT_TRACKING,n=this.computeValue(!0),o=r||Jr(t)||Jr(n)||!this.equals(t,n);return o&&(this.value=n),o},e.prototype.computeValue=function(t){this.isComputing=!0,C.computationDepth++;var r;if(t)r=Lu(this,this.derivation,this.scope);else if(C.disableErrorBoundaries===!0)r=this.derivation.call(this.scope);else try{r=this.derivation.call(this.scope)}catch(n){r=new xo(n)}return C.computationDepth--,this.isComputing=!1,r},e.prototype.suspend=function(){this.keepAlive||(Ri(this),this.value=void 0)},e.prototype.observe=function(t,r){var n=this,o=!0,i=void 0;return $c(function(){var a=n.get();if(!o||r){var s=Ur();t({type:"update",object:n,newValue:a,oldValue:i}),Ye(s)}o=!1,i=a})},e.prototype.warnAboutUntrackedRead=function(){},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},e.prototype.valueOf=function(){return Nu(this.get())},e.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},e}(),Nr=Ue("ComputedValue",Dr),lo=function(){function e(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}return e}(),Sc={};function ji(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:Sc}var uo=!0,Xu=!1,C=function(){var e=ji();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(uo=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new lo().version&&(uo=!1),uo?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new lo):(setTimeout(function(){Xu||Q("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new lo)}();function Mc(){(C.pendingReactions.length||C.inBatch||C.isRunningReactions)&&Q("isolateGlobalState should be called before MobX is running any reactions"),Xu=!0,uo&&(--ji().__mobxInstanceCount===0&&(ji().__mobxGlobals=void 0),C=new lo)}function Li(){return C}function Ac(e,t){e.observers.add(t),e.lowestObserverState>t.dependenciesState&&(e.lowestObserverState=t.dependenciesState)}function Fu(e,t){e.observers.delete(t),e.observers.size===0&&ku(e)}function ku(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,C.pendingUnobservations.push(e))}function ee(){C.inBatch++}function re(){if(--C.inBatch===0){Uu();for(var e=C.pendingUnobservations,t=0;t<e.length;t++){var r=e[t];r.isPendingUnobservation=!1,r.observers.size===0&&(r.isBeingObserved&&(r.isBeingObserved=!1,r.onBecomeUnobserved()),r instanceof Dr&&r.suspend())}C.pendingUnobservations=[]}}function Hu(e){var t=C.trackingDerivation;return t!==null?(t.runId!==e.lastAccessedBy&&(e.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=e,e.isBeingObserved||(e.isBeingObserved=!0,e.onBecomeObserved())),!0):(e.observers.size===0&&C.inBatch>0&&ku(e),!1)}function Tc(e){e.lowestObserverState!==rt.STALE&&(e.lowestObserverState=rt.STALE,e.observers.forEach(function(t){t.dependenciesState===rt.UP_TO_DATE&&(t.isTracing!==ge.NONE&&Yu(t,e),t.onBecomeStale()),t.dependenciesState=rt.STALE}))}function Pc(e){e.lowestObserverState!==rt.STALE&&(e.lowestObserverState=rt.STALE,e.observers.forEach(function(t){t.dependenciesState===rt.POSSIBLY_STALE?t.dependenciesState=rt.STALE:t.dependenciesState===rt.UP_TO_DATE&&(e.lowestObserverState=rt.UP_TO_DATE)}))}function Dc(e){e.lowestObserverState===rt.UP_TO_DATE&&(e.lowestObserverState=rt.POSSIBLY_STALE,e.observers.forEach(function(t){t.dependenciesState===rt.UP_TO_DATE&&(t.dependenciesState=rt.POSSIBLY_STALE,t.isTracing!==ge.NONE&&Yu(t,e),t.onBecomeStale())}))}function Yu(e,t){if(console.log("[mobx.trace] '"+e.name+"' is invalidated due to a change in: '"+t.name+"'"),e.isTracing===ge.BREAK){var r=[];Gu(Yc(e),r,1),new Function(`debugger;
/*
Tracing '`+e.name+`'

You are entering this break point because derivation '`+e.name+"' is being traced and '"+t.name+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(e instanceof Dr?e.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+r.join(`
`)+`
*/
    `)()}}function Gu(e,t,r){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+new Array(r).join("	")+e.name),e.dependencies&&e.dependencies.forEach(function(n){return Gu(n,t,r+1)})}var gn=function(){function e(t,r,n,o){t===void 0&&(t="Reaction@"+Ct()),o===void 0&&(o=!1),this.name=t,this.onInvalidate=r,this.errorHandler=n,this.requiresObservable=o,this.observing=[],this.newObserving=[],this.dependenciesState=rt.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+Ct(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=ge.NONE}return e.prototype.onBecomeStale=function(){this.schedule()},e.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,C.pendingReactions.push(this),Uu())},e.prototype.isScheduled=function(){return this._isScheduled},e.prototype.runReaction=function(){if(!this.isDisposed){if(ee(),this._isScheduled=!1,Ci(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&Ht()}catch(t){this.reportExceptionInDerivation(t)}}re()}},e.prototype.track=function(t){if(!this.isDisposed){ee(),this._isRunning=!0;var r=Lu(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&Ri(this),Jr(r)&&this.reportExceptionInDerivation(r.cause),re()}},e.prototype.reportExceptionInDerivation=function(t){var r=this;if(this.errorHandler){this.errorHandler(t,this);return}if(C.disableErrorBoundaries)throw t;var n="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";C.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(n,t),C.globalReactionErrorHandlers.forEach(function(o){return o(t,r)})},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(ee(),Ri(this),re()))},e.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t[$]=this,t},e.prototype.toString=function(){return"Reaction["+this.name+"]"},e.prototype.trace=function(t){t===void 0&&(t=!1),Zc(this,t)},e}(),as=100,Ii=function(e){return e()};function Uu(){C.inBatch>0||C.isRunningReactions||Ii(Nc)}function Nc(){C.isRunningReactions=!0;for(var e=C.pendingReactions,t=0;e.length>0;){++t===as&&(console.error("Reaction doesn't converge to a stable state after "+as+" iterations."+(" Probably there is a cycle in the reactive function: "+e[0])),e.splice(0));for(var r=e.splice(0),n=0,o=r.length;n<o;n++)r[n].runReaction()}C.isRunningReactions=!1}var bo=Ue("Reaction",gn);function Cc(e){var t=Ii;Ii=function(r){return e(function(){return t(r)})}}function Ht(){return!1}function Rc(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}function jc(){Q(!1)}function ss(e){return function(t,r,n){if(n){if(n.value)return{value:rr(e,n.value),enumerable:!1,configurable:!0,writable:!0};var o=n.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return rr(e,o.call(this))}}}return Lc(e).apply(this,arguments)}}function Lc(e){return function(t,r,n){Object.defineProperty(t,r,{configurable:!0,enumerable:!1,get:function(){},set:function(o){Hr(this,r,E(e,o))}})}}function Ic(e,t,r,n){return n===!0?(ui(e,t,r.value),null):r?{configurable:!0,enumerable:!1,get:function(){return ui(this,t,r.value||r.initializer.call(this)),this[t]},set:jc}:{enumerable:!1,configurable:!0,set:function(o){ui(this,t,o)},get:function(){}}}var E=function(t,r,n,o){if(arguments.length===1&&typeof t=="function")return rr(t.name||"<unnamed action>",t);if(arguments.length===2&&typeof r=="function")return rr(t,r);if(arguments.length===1&&typeof t=="string")return ss(t);if(o===!0)Hr(t,r,rr(t.name||r,n.value,this));else return ss(r).apply(null,arguments)};E.bound=Ic;function Bc(e,t){var r=typeof e=="string"?e:e.name||"<unnamed action>",n=typeof e=="function"?e:t;return $u(r,n,this,void 0)}function ui(e,t,r){Hr(e,t,rr(t,r.bind(e)))}function $c(e,t){t===void 0&&(t=Ma);var r=t&&t.name||e.name||"Autorun@"+Ct(),n=!t.scheduler&&!t.delay,o;if(n)o=new gn(r,function(){this.track(s)},t.onError,t.requiresObservable);else{var i=zu(t),a=!1;o=new gn(r,function(){a||(a=!0,i(function(){a=!1,o.isDisposed||o.track(s)}))},t.onError,t.requiresObservable)}function s(){e(o)}return o.schedule(),o.getDisposer()}var Xc=function(e){return e()};function zu(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:Xc}function Wu(e,t,r){r===void 0&&(r=Ma);var n=r.name||"Reaction@"+Ct(),o=E(n,r.onError?Fc(r.onError,t):t),i=!r.scheduler&&!r.delay,a=zu(r),s=!0,l=!1,u,f=r.compareStructural?Tr.structural:r.equals||Tr.default,d=new gn(n,function(){s||i?c():l||(l=!0,a(c))},r.onError,r.requiresObservable);function c(){if(l=!1,!d.isDisposed){var p=!1;d.track(function(){var v=e(d);p=s||!f(u,v),u=v}),s&&r.fireImmediately&&o(u,d),!s&&p===!0&&o(u,d),s&&(s=!1)}}return d.schedule(),d.getDisposer()}function Fc(e,t){return function(){try{return t.apply(this,arguments)}catch(r){e.call(this,r)}}}function kc(e,t,r){return Ku("onBecomeObserved",e,t)}function Vu(e,t,r){return Ku("onBecomeUnobserved",e,t)}function Ku(e,t,r,n){var o=Ge(t),i=r,a=e+"Listeners";o[a]?o[a].add(i):o[a]=new Set([i]);var s=o[e];return typeof s!="function"?Q(!1):function(){var l=o[a];l&&(l.delete(i),l.size===0&&delete o[a])}}function Hc(e){var t=e.enforceActions,r=e.computedRequiresReaction,n=e.computedConfigurable,o=e.disableErrorBoundaries,i=e.reactionScheduler,a=e.reactionRequiresObservable,s=e.observableRequiresReaction;if(Mc(),t!==void 0){var l=void 0;switch(t){case!0:case"observed":l=!0;break;case!1:case"never":l=!1;break;case"strict":case"always":l="strict";break;default:Q("Invalid value for 'enforceActions': '"+t+"', expected 'never', 'always' or 'observed'")}C.enforceActions=l,C.allowStateChanges=!(l===!0||l==="strict")}r!==void 0&&(C.computedRequiresReaction=!!r),a!==void 0&&(C.reactionRequiresObservable=!!a),s!==void 0&&(C.observableRequiresReaction=!!s,C.allowStateReads=!C.observableRequiresReaction),n!==void 0&&(C.computedConfigurable=!!n),o!==void 0&&(o===!0&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors when `disableErrorBoundaries` is enabled."),C.disableErrorBoundaries=!!o),i&&Cc(i)}function Bi(e,t,r,n){n=gr(n);var o=Zu(n);return ir(e),La(e,n.name,o.enhancer),t&&qu(e,t,r,o),e}function Zu(e){return e.defaultDecorator||(e.deep===!1?ju:Na)}function qu(e,t,r,n){var o,i,a,s,l,u;ee();try{var a=ac(t);try{for(var f=ve(a),d=f.next();!d.done;d=f.next()){var u=d.value,c=Object.getOwnPropertyDescriptor(t,u),p=r&&u in r?r[u]:c.get?mo:n,v=p(e,u,c,!0);v&&Object.defineProperty(e,u,v)}}catch(_){o={error:_}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}finally{re()}}function Yc(e,t){return Ju(Ge(e,t))}function Ju(e){var t={name:e.name};return e.observing&&e.observing.length>0&&(t.dependencies=rc(e.observing).map(Ju)),t}function Qu(e,t){if(e==null)return!1;if(t!==void 0){if(se(e)===!1||!e[$].values.has(t))return!1;var r=Ge(e,t);return Nr(r)}return Nr(e)}function Gc(e){return arguments.length>1?Q(!1):Qu(e)}function ls(e,t){return typeof t!="string"?Q(!1):Qu(e,t)}function Uc(e,t){return e==null?!1:se(e)||!!e[$]||Ta(e)||bo(e)||Nr(e)}function Cr(e){return arguments.length!==1&&Q(!1),Uc(e)}function Rr(e){return se(e)?e[$].getKeys():Rt(e)||Gt(e)?Array.from(e.keys()):xe(e)?e.map(function(t,r){return r}):Q(!1)}function zc(e){return se(e)?Rr(e).map(function(t){return e[t]}):Rt(e)?Rr(e).map(function(t){return e.get(t)}):Gt(e)?Array.from(e.values()):xe(e)?e.slice():Q(!1)}function Wc(e){return se(e)?Rr(e).map(function(t){return[t,e[t]]}):Rt(e)?Rr(e).map(function(t){return[t,e.get(t)]}):Gt(e)?Array.from(e.entries()):xe(e)?e.map(function(t,r){return[r,t]}):Q(!1)}function Ra(e,t,r){if(arguments.length===2&&!Gt(e)){ee();var n=t;try{for(var o in n)Ra(e,o,n[o])}finally{re()}return}if(se(e)){var i=e[$],a=i.values.get(t);a?i.write(t,r):i.addObservableProp(t,r,i.defaultEnhancer)}else if(Rt(e))e.set(t,r);else if(Gt(e))e.add(t);else if(xe(e))typeof t!="number"&&(t=parseInt(t,10)),er(t>=0,"Not a valid index: '"+t+"'"),ee(),t>=e.length&&(e.length=t+1),e[t]=r,re();else return Q(!1)}function td(e,t,r,n){return Vc(e,t,r)}function Vc(e,t,r){return Vo(e).observe(t,r)}var Kc={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function fr(e,t,r,n){return n.detectCycles&&e.set(t,r),r}function Le(e,t,r){if(!t.recurseEverything&&!Cr(e)||typeof e!="object")return e;if(e===null)return null;if(e instanceof Date)return e;if(wc(e))return Le(e.get(),t,r);Cr(e)&&Rr(e);var n=t.detectCycles===!0;if(n&&e!==null&&r.has(e))return r.get(e);if(xe(e)||Array.isArray(e)){var o=fr(r,e,[],t),i=e.map(function(p){return Le(p,t,r)});o.length=i.length;for(var a=0,s=i.length;a<s;a++)o[a]=i[a];return o}if(Gt(e)||Object.getPrototypeOf(e)===Set.prototype)if(t.exportMapsAsObjects===!1){var l=fr(r,e,new Set,t);return e.forEach(function(p){l.add(Le(p,t,r))}),l}else{var u=fr(r,e,[],t);return e.forEach(function(p){u.push(Le(p,t,r))}),u}if(Rt(e)||Object.getPrototypeOf(e)===Map.prototype)if(t.exportMapsAsObjects===!1){var f=fr(r,e,new Map,t);return e.forEach(function(p,v){f.set(v,Le(p,t,r))}),f}else{var d=fr(r,e,{},t);return e.forEach(function(p,v){d[v]=Le(p,t,r)}),d}var c=fr(r,e,{},t);return Du(e).forEach(function(p){c[p]=Le(e[p],t,r)}),c}function ce(e,t){typeof t=="boolean"&&(t={detectCycles:t}),t||(t=Kc),t.detectCycles=t.detectCycles===void 0?t.recurseEverything===!0:t.detectCycles===!0;var r;return t.detectCycles&&(r=new Map),Le(e,t,r)}function Zc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=!1;typeof e[e.length-1]=="boolean"&&(r=e.pop());var n=qc(e);if(!n)return Q(!1);n.isTracing===ge.NONE&&console.log("[mobx.trace] '"+n.name+"' tracing enabled"),n.isTracing=r?ge.BREAK:ge.LOG}function qc(e){switch(e.length){case 0:return C.trackingDerivation;case 1:return Ge(e[0]);case 2:return Ge(e[0],e[1])}}function qt(e,t){t===void 0&&(t=void 0),ee();try{return e.apply(t)}finally{re()}}function Hn(e){return e[$]}function Yn(e){return typeof e=="string"||typeof e=="number"||typeof e=="symbol"}var Jc={has:function(e,t){if(t===$||t==="constructor"||t===_o)return!0;var r=Hn(e);return Yn(t)?r.has(t):t in e},get:function(e,t){if(t===$||t==="constructor"||t===_o)return e[t];var r=Hn(e),n=r.values.get(t);if(n instanceof Gr){var o=n.get();return o===void 0&&r.has(t),o}return Yn(t)&&r.has(t),e[t]},set:function(e,t,r){return Yn(t)?(Ra(e,t,r),!0):!1},deleteProperty:function(e,t){if(!Yn(t))return!1;var r=Hn(e);return r.remove(t),!0},ownKeys:function(e){var t=Hn(e);return t.keysAtom.reportObserved(),Reflect.ownKeys(e)},preventExtensions:function(e){return Q("Dynamic observable objects cannot be frozen"),!1}};function Qc(e){var t=new Proxy(e,Jc);return e[$].proxy=t,t}function _e(e){return e.interceptors!==void 0&&e.interceptors.length>0}function Nn(e,t){var r=e.interceptors||(e.interceptors=[]);return r.push(t),Pu(function(){var n=r.indexOf(t);n!==-1&&r.splice(n,1)})}function me(e,t){var r=Ur();try{for(var n=Da(e.interceptors||[]),o=0,i=n.length;o<i&&(t=n[o](t),er(!t||t.type,"Intercept handlers should return nothing or a change object"),!!t);o++);return t}finally{Ye(r)}}function ne(e){return e.changeListeners!==void 0&&e.changeListeners.length>0}function Cn(e,t){var r=e.changeListeners||(e.changeListeners=[]);return r.push(t),Pu(function(){var n=r.indexOf(t);n!==-1&&r.splice(n,1)})}function oe(e,t){var r=Ur(),n=e.changeListeners;if(n){n=n.slice();for(var o=0,i=n.length;o<i;o++)n[o](t);Ye(r)}}var tp=1e4,ep={get:function(e,t){return t===$?e[$]:t==="length"?e[$].getArrayLength():typeof t=="number"?Se.get.call(e,t):typeof t=="string"&&!isNaN(t)?Se.get.call(e,parseInt(t)):Se.hasOwnProperty(t)?Se[t]:e[t]},set:function(e,t,r){return t==="length"&&e[$].setArrayLength(r),typeof t=="number"&&Se.set.call(e,t,r),typeof t=="symbol"||isNaN(t)?e[t]=r:Se.set.call(e,parseInt(t),r),!0},preventExtensions:function(e){return Q("Observable arrays cannot be frozen"),!1}};function rp(e,t,r,n){r===void 0&&(r="ObservableArray@"+Ct()),n===void 0&&(n=!1);var o=new ed(r,t,n);oc(o.values,$,o);var i=new Proxy(o.values,ep);if(o.proxy=i,e&&e.length){var a=zo(!0);o.spliceWithArray(0,0,e),Wo(a)}return i}var ed=function(){function e(t,r,n){this.owned=n,this.values=[],this.proxy=void 0,this.lastKnownLength=0,this.atom=new Gr(t||"ObservableArray@"+Ct()),this.enhancer=function(o,i){return r(o,i,t+"[..]")}}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.dehanceValues=function(t){return this.dehancer!==void 0&&t.length>0?t.map(this.dehancer):t},e.prototype.intercept=function(t){return Nn(this,t)},e.prototype.observe=function(t,r){return r===void 0&&(r=!1),r&&t({object:this.proxy,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),Cn(this,t)},e.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},e.prototype.setArrayLength=function(t){if(typeof t!="number"||t<0)throw new Error("[mobx.array] Out of range: "+t);var r=this.values.length;if(t!==r)if(t>r){for(var n=new Array(t-r),o=0;o<t-r;o++)n[o]=void 0;this.spliceWithArray(r,0,n)}else this.spliceWithArray(t,r-t)},e.prototype.updateArrayLength=function(t,r){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed.");this.lastKnownLength+=r},e.prototype.spliceWithArray=function(t,r,n){var o=this;Pr(this.atom);var i=this.values.length;if(t===void 0?t=0:t>i?t=i:t<0&&(t=Math.max(0,i+t)),arguments.length===1?r=i-t:r==null?r=0:r=Math.max(0,Math.min(r,i-t)),n===void 0&&(n=yo),_e(this)){var a=me(this,{object:this.proxy,type:"splice",index:t,removedCount:r,added:n});if(!a)return yo;r=a.removedCount,n=a.added}n=n.length===0?n:n.map(function(l){return o.enhancer(l,void 0)});var s=this.spliceItemsIntoValues(t,r,n);return(r!==0||n.length!==0)&&this.notifyArraySplice(t,n,s),this.dehanceValues(s)},e.prototype.spliceItemsIntoValues=function(t,r,n){var o;if(n.length<tp)return(o=this.values).splice.apply(o,Da([t,r],n));var i=this.values.slice(t,t+r);return this.values=this.values.slice(0,t).concat(n,this.values.slice(t+r)),i},e.prototype.notifyArrayChildUpdate=function(t,r,n){var o=!this.owned&&Ht(),i=ne(this),a=i||o?{object:this.proxy,type:"update",index:t,newValue:r,oldValue:n}:null;this.atom.reportChanged(),i&&oe(this,a)},e.prototype.notifyArraySplice=function(t,r,n){var o=!this.owned&&Ht(),i=ne(this),a=i||o?{object:this.proxy,type:"splice",index:t,removed:n,added:r,removedCount:n.length,addedCount:r.length}:null;this.atom.reportChanged(),i&&oe(this,a)},e}(),Se={intercept:function(e){return this[$].intercept(e)},observe:function(e,t){t===void 0&&(t=!1);var r=this[$];return r.observe(e,t)},clear:function(){return this.splice(0)},replace:function(e){var t=this[$];return t.spliceWithArray(0,t.values.length,e)},toJS:function(){return this.slice()},toJSON:function(){return this.toJS()},splice:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=this[$];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray(e);case 2:return o.spliceWithArray(e,t)}return o.spliceWithArray(e,t,r)},spliceWithArray:function(e,t,r){var n=this[$];return n.spliceWithArray(e,t,r)},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this[$];return r.spliceWithArray(r.values.length,0,e),r.values.length},pop:function(){return this.splice(Math.max(this[$].values.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this[$];return r.spliceWithArray(0,0,e),r.values.length},reverse:function(){var e=this.slice();return e.reverse.apply(e,arguments)},sort:function(e){var t=this.slice();return t.sort.apply(t,arguments)},remove:function(e){var t=this[$],r=t.dehanceValues(t.values).indexOf(e);return r>-1?(this.splice(r,1),!0):!1},get:function(e){var t=this[$];if(t){if(e<t.values.length)return t.atom.reportObserved(),t.dehanceValue(t.values[e]);console.warn("[mobx.array] Attempt to read an array index ("+e+") that is out of bounds ("+t.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},set:function(e,t){var r=this[$],n=r.values;if(e<n.length){Pr(r.atom);var o=n[e];if(_e(r)){var i=me(r,{type:"update",object:r.proxy,index:e,newValue:t});if(!i)return;t=i.newValue}t=r.enhancer(t,o);var a=t!==o;a&&(n[e]=t,r.notifyArrayChildUpdate(e,t,o))}else if(e===n.length)r.spliceWithArray(e,0,[t]);else throw new Error("[mobx.array] Index out of bounds, "+e+" is larger than "+n.length)}};["concat","flat","includes","indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach(function(e){typeof Array.prototype[e]=="function"&&(Se[e]=function(){var t=this[$];t.atom.reportObserved();var r=t.dehanceValues(t.values);return r[e].apply(r,arguments)})});["every","filter","find","findIndex","flatMap","forEach","map","some"].forEach(function(e){typeof Array.prototype[e]=="function"&&(Se[e]=function(t,r){var n=this,o=this[$];o.atom.reportObserved();var i=o.dehanceValues(o.values);return i[e](function(a,s){return t.call(r,a,s,n)},r)})});["reduce","reduceRight"].forEach(function(e){Se[e]=function(){var t=this,r=this[$];r.atom.reportObserved();var n=arguments[0];return arguments[0]=function(o,i,a){return i=r.dehanceValue(i),n(o,i,a,t)},r.values[e].apply(r.values,arguments)}});var np=Ue("ObservableArrayAdministration",ed);function xe(e){return Aa(e)&&np(e[$])}var us,op={},ja=function(){function e(t,r,n){if(r===void 0&&(r=Dn),n===void 0&&(n="ObservableMap@"+Ct()),this.enhancer=r,this.name=n,this[us]=op,this._keysAtom=Pa(this.name+".keys()"),this[Symbol.toStringTag]="Map",typeof Map!="function")throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return e.prototype._has=function(t){return this._data.has(t)},e.prototype.has=function(t){var r=this;if(!C.trackingDerivation)return this._has(t);var n=this._hasMap.get(t);if(!n){var o=n=new nr(this._has(t),Go,this.name+"."+ke(t)+"?",!1);this._hasMap.set(t,o),Vu(o,function(){return r._hasMap.delete(t)})}return n.get()},e.prototype.set=function(t,r){var n=this._has(t);if(_e(this)){var o=me(this,{type:n?"update":"add",object:this,newValue:r,name:t});if(!o)return this;r=o.newValue}return n?this._updateValue(t,r):this._addValue(t,r),this},e.prototype.delete=function(t){var r=this;if(Pr(this._keysAtom),_e(this)){var n=me(this,{type:"delete",object:this,name:t});if(!n)return!1}if(this._has(t)){var o=Ht(),i=ne(this),n=i||o?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return qt(function(){r._keysAtom.reportChanged(),r._updateHasMapEntry(t,!1);var s=r._data.get(t);s.setNewValue(void 0),r._data.delete(t)}),i&&oe(this,n),!0}return!1},e.prototype._updateHasMapEntry=function(t,r){var n=this._hasMap.get(t);n&&n.setNewValue(r)},e.prototype._updateValue=function(t,r){var n=this._data.get(t);if(r=n.prepareNewValue(r),r!==C.UNCHANGED){var o=Ht(),i=ne(this),a=i||o?{type:"update",object:this,oldValue:n.value,name:t,newValue:r}:null;n.setNewValue(r),i&&oe(this,a)}},e.prototype._addValue=function(t,r){var n=this;Pr(this._keysAtom),qt(function(){var s=new nr(r,n.enhancer,n.name+"."+ke(t),!1);n._data.set(t,s),r=s.value,n._updateHasMapEntry(t,!0),n._keysAtom.reportChanged()});var o=Ht(),i=ne(this),a=i||o?{type:"add",object:this,name:t,newValue:r}:null;i&&oe(this,a)},e.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},e.prototype.values=function(){var t=this,r=this.keys();return Oo({next:function(){var n=r.next(),o=n.done,i=n.value;return{done:o,value:o?void 0:t.get(i)}}})},e.prototype.entries=function(){var t=this,r=this.keys();return Oo({next:function(){var n=r.next(),o=n.done,i=n.value;return{done:o,value:o?void 0:[i,t.get(i)]}}})},e.prototype[us=$,Symbol.iterator]=function(){return this.entries()},e.prototype.forEach=function(t,r){var n,o;try{for(var i=ve(this),a=i.next();!a.done;a=i.next()){var s=mr(a.value,2),l=s[0],u=s[1];t.call(r,u,l,this)}}catch(f){n={error:f}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},e.prototype.merge=function(t){var r=this;return Rt(t)&&(t=t.toJS()),qt(function(){var n=zo(!0);try{kr(t)?Du(t).forEach(function(o){return r.set(o,t[o])}):Array.isArray(t)?t.forEach(function(o){var i=mr(o,2),a=i[0],s=i[1];return r.set(a,s)}):Yr(t)?(t.constructor!==Map&&Q("Cannot initialize from classes that inherit from Map: "+t.constructor.name),t.forEach(function(o,i){return r.set(i,o)})):t!=null&&Q("Cannot initialize map from "+t)}finally{Wo(n)}}),this},e.prototype.clear=function(){var t=this;qt(function(){Iu(function(){var r,n;try{for(var o=ve(t.keys()),i=o.next();!i.done;i=o.next()){var a=i.value;t.delete(a)}}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}})})},e.prototype.replace=function(t){var r=this;return qt(function(){var n,o,i,a,s=nc(t),l=new Map,u=!1;try{for(var f=ve(r._data.keys()),d=f.next();!d.done;d=f.next()){var c=d.value;if(!s.has(c)){var p=r.delete(c);if(p)u=!0;else{var v=r._data.get(c);l.set(c,v)}}}}catch(x){n={error:x}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}try{for(var h=ve(s.entries()),_=h.next();!_.done;_=h.next()){var y=mr(_.value,2),c=y[0],v=y[1],m=r._data.has(c);if(r.set(c,v),r._data.has(c)){var S=r._data.get(c);l.set(c,S),m||(u=!0)}}}catch(x){i={error:x}}finally{try{_&&!_.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}if(!u)if(r._data.size!==l.size)r._keysAtom.reportChanged();else for(var M=r._data.keys(),A=l.keys(),b=M.next(),g=A.next();!b.done;){if(b.value!==g.value){r._keysAtom.reportChanged();break}b=M.next(),g=A.next()}r._data=l}),this},Object.defineProperty(e.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.toPOJO=function(){var t,r,n={};try{for(var o=ve(this),i=o.next();!i.done;i=o.next()){var a=mr(i.value,2),s=a[0],l=a[1];n[typeof s=="symbol"?s:ke(s)]=l}}catch(u){t={error:u}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype.toJS=function(){return new Map(this)},e.prototype.toJSON=function(){return this.toPOJO()},e.prototype.toString=function(){var t=this;return this.name+"[{ "+Array.from(this.keys()).map(function(r){return ke(r)+": "+(""+t.get(r))}).join(", ")+" }]"},e.prototype.observe=function(t,r){return Cn(this,t)},e.prototype.intercept=function(t){return Nn(this,t)},e}(),Rt=Ue("ObservableMap",ja),ds,ip={},rd=function(){function e(t,r,n){if(r===void 0&&(r=Dn),n===void 0&&(n="ObservableSet@"+Ct()),this.name=n,this[ds]=ip,this._data=new Set,this._atom=Pa(this.name),this[Symbol.toStringTag]="Set",typeof Set!="function")throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(o,i){return r(o,i,n)},t&&this.replace(t)}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.clear=function(){var t=this;qt(function(){Iu(function(){var r,n;try{for(var o=ve(t._data.values()),i=o.next();!i.done;i=o.next()){var a=i.value;t.delete(a)}}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}})})},e.prototype.forEach=function(t,r){var n,o;try{for(var i=ve(this),a=i.next();!a.done;a=i.next()){var s=a.value;t.call(r,s,s,this)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},Object.defineProperty(e.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.add=function(t){var r=this;if(Pr(this._atom),_e(this)){var n=me(this,{type:"add",object:this,newValue:t});if(!n)return this}if(!this.has(t)){qt(function(){r._data.add(r.enhancer(t,void 0)),r._atom.reportChanged()});var o=Ht(),i=ne(this),n=i||o?{type:"add",object:this,newValue:t}:null;i&&oe(this,n)}return this},e.prototype.delete=function(t){var r=this;if(_e(this)){var n=me(this,{type:"delete",object:this,oldValue:t});if(!n)return!1}if(this.has(t)){var o=Ht(),i=ne(this),n=i||o?{type:"delete",object:this,oldValue:t}:null;return qt(function(){r._atom.reportChanged(),r._data.delete(t)}),i&&oe(this,n),!0}return!1},e.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},e.prototype.entries=function(){var t=0,r=Array.from(this.keys()),n=Array.from(this.values());return Oo({next:function(){var o=t;return t+=1,o<n.length?{value:[r[o],n[o]],done:!1}:{done:!0}}})},e.prototype.keys=function(){return this.values()},e.prototype.values=function(){this._atom.reportObserved();var t=this,r=0,n=Array.from(this._data.values());return Oo({next:function(){return r<n.length?{value:t.dehanceValue(n[r++]),done:!1}:{done:!0}}})},e.prototype.replace=function(t){var r=this;return Gt(t)&&(t=t.toJS()),qt(function(){var n=zo(!0);try{Array.isArray(t)?(r.clear(),t.forEach(function(o){return r.add(o)})):Pn(t)?(r.clear(),t.forEach(function(o){return r.add(o)})):t!=null&&Q("Cannot initialize set from "+t)}finally{Wo(n)}}),this},e.prototype.observe=function(t,r){return Cn(this,t)},e.prototype.intercept=function(t){return Nn(this,t)},e.prototype.toJS=function(){return new Set(this)},e.prototype.toString=function(){return this.name+"[ "+Array.from(this).join(", ")+" ]"},e.prototype[ds=$,Symbol.iterator]=function(){return this.values()},e}(),Gt=Ue("ObservableSet",rd),nd=function(){function e(t,r,n,o){r===void 0&&(r=new Map),this.target=t,this.values=r,this.name=n,this.defaultEnhancer=o,this.keysAtom=new Gr(n+".keys")}return e.prototype.read=function(t){return this.values.get(t).get()},e.prototype.write=function(t,r){var n=this.target,o=this.values.get(t);if(o instanceof Dr){o.set(r);return}if(_e(this)){var i=me(this,{type:"update",object:this.proxy||n,name:t,newValue:r});if(!i)return;r=i.newValue}if(r=o.prepareNewValue(r),r!==C.UNCHANGED){var a=ne(this),s=Ht(),i=a||s?{type:"update",object:this.proxy||n,oldValue:o.value,name:t,newValue:r}:null;o.setNewValue(r),a&&oe(this,i)}},e.prototype.has=function(t){var r=this.pendingKeys||(this.pendingKeys=new Map),n=r.get(t);if(n)return n.get();var o=!!this.values.get(t);return n=new nr(o,Go,this.name+"."+ke(t)+"?",!1),r.set(t,n),n.get()},e.prototype.addObservableProp=function(t,r,n){n===void 0&&(n=this.defaultEnhancer);var o=this.target;if(_e(this)){var i=me(this,{object:this.proxy||o,name:t,type:"add",newValue:r});if(!i)return;r=i.newValue}var a=new nr(r,n,this.name+"."+ke(t),!1);this.values.set(t,a),r=a.value,Object.defineProperty(o,t,ap(t)),this.notifyPropertyAddition(t,r)},e.prototype.addComputedProp=function(t,r,n){var o=this.target;n.name=n.name||this.name+"."+ke(r),this.values.set(r,new Dr(n)),(t===o||ic(t,r))&&Object.defineProperty(t,r,sp(r))},e.prototype.remove=function(t){if(this.values.has(t)){var r=this.target;if(_e(this)){var n=me(this,{object:this.proxy||r,name:t,type:"remove"});if(!n)return}try{ee();var o=ne(this),i=Ht(),a=this.values.get(t),s=a&&a.get();if(a&&a.set(void 0),this.keysAtom.reportChanged(),this.values.delete(t),this.pendingKeys){var l=this.pendingKeys.get(t);l&&l.set(!1)}delete this.target[t];var n=o||i?{type:"remove",object:this.proxy||r,oldValue:s,name:t}:null;o&&oe(this,n)}finally{re()}}},e.prototype.illegalAccess=function(t,r){console.warn("Property '"+r+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},e.prototype.observe=function(t,r){return Cn(this,t)},e.prototype.intercept=function(t){return Nn(this,t)},e.prototype.notifyPropertyAddition=function(t,r){var n=ne(this),o=Ht(),i=n||o?{type:"add",object:this.proxy||this.target,name:t,newValue:r}:null;if(n&&oe(this,i),this.pendingKeys){var a=this.pendingKeys.get(t);a&&a.set(!0)}this.keysAtom.reportChanged()},e.prototype.getKeys=function(){var t,r;this.keysAtom.reportObserved();var n=[];try{for(var o=ve(this.values),i=o.next();!i.done;i=o.next()){var a=mr(i.value,2),s=a[0],l=a[1];l instanceof nr&&n.push(s)}}catch(u){t={error:u}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e}();function La(e,t,r){if(t===void 0&&(t=""),r===void 0&&(r=Dn),Object.prototype.hasOwnProperty.call(e,$))return e[$];kr(e)||(t=(e.constructor.name||"ObservableObject")+"@"+Ct()),t||(t="ObservableObject@"+Ct());var n=new nd(e,new Map,ke(t),r);return Hr(e,$,n),n}var fs=Object.create(null),cs=Object.create(null);function ap(e){return fs[e]||(fs[e]={configurable:!0,enumerable:!0,get:function(){return this[$].read(e)},set:function(t){this[$].write(e,t)}})}function ps(e){var t=e[$];return t||(ir(e),e[$])}function sp(e){return cs[e]||(cs[e]={configurable:C.computedConfigurable,enumerable:!1,get:function(){return ps(this).read(e)},set:function(t){ps(this).write(e,t)}})}var lp=Ue("ObservableObjectAdministration",nd);function se(e){return Aa(e)?(ir(e),lp(e[$])):!1}function Ge(e,t){if(typeof e=="object"&&e!==null){if(xe(e))return t!==void 0&&Q(!1),e[$].atom;if(Gt(e))return e[$];if(Rt(e)){var r=e;if(t===void 0)return r._keysAtom;var n=r._data.get(t)||r._hasMap.get(t);return n||Q(!1),n}if(ir(e),t&&!e[$]&&e[t],se(e)){if(!t)return Q(!1);var n=e[$].values.get(t);return n||Q(!1),n}if(Ta(e)||Nr(e)||bo(e))return e}else if(typeof e=="function"&&bo(e[$]))return e[$];return Q(!1)}function Vo(e,t){if(e||Q("Expecting some object"),t!==void 0)return Vo(Ge(e,t));if(Ta(e)||Nr(e)||bo(e)||Rt(e)||Gt(e))return e;if(ir(e),e[$])return e[$];Q(!1)}function up(e,t){var r;return t!==void 0?r=Ge(e,t):se(e)||Rt(e)||Gt(e)?r=Vo(e):r=Ge(e),r.name}var hs=Object.prototype.toString;function od(e,t,r){return r===void 0&&(r=-1),$i(e,t,r)}function $i(e,t,r,n,o){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var i=typeof e;if(i!=="function"&&i!=="object"&&typeof t!="object")return!1;var a=hs.call(e);if(a!==hs.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":r>=0&&r++;break}e=vs(e),t=vs(t);var s=a==="[object Array]";if(!s){if(typeof e!="object"||typeof t!="object")return!1;var l=e.constructor,u=t.constructor;if(l!==u&&!(typeof l=="function"&&l instanceof l&&typeof u=="function"&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1}if(r===0)return!1;r<0&&(r=-1),n=n||[],o=o||[];for(var f=n.length;f--;)if(n[f]===e)return o[f]===t;if(n.push(e),o.push(t),s){if(f=e.length,f!==t.length)return!1;for(;f--;)if(!$i(e[f],t[f],r-1,n,o))return!1}else{var d=Object.keys(e),c=void 0;if(f=d.length,Object.keys(t).length!==f)return!1;for(;f--;)if(c=d[f],!(dp(t,c)&&$i(e[c],t[c],r-1,n,o)))return!1}return n.pop(),o.pop(),!0}function vs(e){return xe(e)?e.slice():Yr(e)||Rt(e)||Pn(e)||Gt(e)?Array.from(e.entries()):e}function dp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Oo(e){return e[Symbol.iterator]=fp,e}function fp(){return this}if(typeof Proxy>"u"||typeof Symbol>"u")throw new Error("[mobx] MobX 5+ requires Proxy and Symbol objects. If your environment doesn't support Symbol or Proxy objects, please downgrade to MobX 4. For React Native Android, consider upgrading JSCore.");typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Rc,extras:{getDebugName:up},$mobx:$});function cp(e){return!(e.prototype&&e.prototype.render)&&!W.isPrototypeOf(e)}function id(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.prefix,n=r===void 0?"":r,o=t.suffix,i=o===void 0?"":o,a=e.displayName||e.name||e.constructor&&e.constructor.name||"<component>";return n+a+i}var ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ad=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},sd=function(){function e(t,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),ld=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},ud=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},gs=console;function pp(e){var t=Li().allowStateChanges;return Li().allowStateChanges=e,t}function hp(e){Li().allowStateChanges=e}function vp(e,t,r,n,o){var i=pp(e),a=void 0;try{a=t(r,n,o)}finally{hp(i)}return a}function _s(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=e[t],o=dd[t],i=n?r===!0?function(){o.apply(this,arguments),n.apply(this,arguments)}:function(){n.apply(this,arguments),o.apply(this,arguments)}:o;e[t]=i}function ms(e,t){if(e==null||t==null||(typeof e>"u"?"undefined":ys(e))!=="object"||(typeof t>"u"?"undefined":ys(t))!=="object")return e!==t;var r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(var n=void 0,o=r.length-1;n=r[o];o--)if(t[n]!==e[n])return!0;return!1}var dd={componentWillMount:function(){var t=this,r=id(this),n=!1,o=!1;function i(d){var c=this[d],p=Pa("reactive "+d);Object.defineProperty(this,d,{configurable:!0,enumerable:!0,get:function(){return p.reportObserved(),c},set:function(h){!o&&ms(c,h)?(c=h,n=!0,p.reportChanged(),n=!1):c=h}})}i.call(this,"props"),i.call(this,"state");var a=this.render.bind(this),s=null,l=!1,u=function(){return s=new gn(r+".render()",function(){if(!l&&(l=!0,typeof t.componentWillReact=="function"&&t.componentWillReact(),t.__$mobxIsUnmounted!==!0)){var c=!0;try{o=!0,n||W.prototype.forceUpdate.call(t),c=!1}finally{o=!1,c&&s.dispose()}}}),s.reactComponent=t,f.$mobx=s,t.render=f,f(t.props,t.state,t.context)},f=function(c,p,v){l=!1;var h=void 0,_=void 0;if(s.track(function(){try{_=vp(!1,a,c,p,v)}catch(y){h=y}}),h)throw h;return _};this.render=u},componentWillUnmount:function(){this.render.$mobx&&this.render.$mobx.dispose(),this.__$mobxIsUnmounted=!0},componentDidMount:function(){},componentDidUpdate:function(){},shouldComponentUpdate:function(t,r){return this.state!==r?!0:ms(this.props,t)}};function Ia(e){if(arguments.length>1&&gs.warn('Mobx observer: Using observer to inject stores is not supported. Use `@connect(["store1", "store2"]) ComponentClass instead or preferably, use `@inject("store1", "store2") @observer ComponentClass` or `inject("store1", "store2")(observer(componentClass))``'),e.isMobxInjector===!0&&gs.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),cp(e)){var t,r;return Ia((r=t=function(o){ld(i,o);function i(){return ad(this,i),ud(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return sd(i,[{key:"render",value:function(){return e.call(this,this.props,this.context)}}]),i}(W),t.displayName=id(e),r))}if(!e)throw new Error("Please pass a valid component to 'observer'");var n=e.prototype||e;return yp(n),e.isMobXReactObserver=!0,e}function yp(e){_s(e,"componentWillMount",!0),_s(e,"componentDidMount"),e.shouldComponentUpdate||(e.shouldComponentUpdate=dd.shouldComponentUpdate)}var gp=Ia(function(e){var t=e.children;return t[0]()});gp.displayName="Observer";var _p=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mp(e,t){return t={exports:{}},e(t,t.exports),t.exports}mp(function(e,t){(function(r,n){e.exports=n()})(_p,function(){var r={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o=Object.defineProperty,i=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,s=Object.getOwnPropertyDescriptor,l=Object.getPrototypeOf,u=l&&l(Object);return function f(d,c,p){if(typeof c!="string"){if(u){var v=l(c);v&&v!==u&&f(d,v,p)}var h=i(c);a&&(h=h.concat(a(c)));for(var _=0;_<h.length;++_){var y=h[_];if(!r[y]&&!n[y]&&(!p||!p[y])){var m=s(c,y);try{o(d,y,m)}catch{}}}return d}return d}})});var xs={children:!0,key:!0,ref:!0},Es=console;(function(e){ld(t,e);function t(){return ad(this,t),ud(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return sd(t,[{key:"render",value:function(n){var o=n.children;return o.length>1?Sr("div",null," ",o," "):o[0]}},{key:"getChildContext",value:function(){var n={},o=this.context.mobxStores;if(o)for(var i in o)n[i]=o[i];for(var a in this.props)!xs[a]&&a!=="suppressChangedStoreWarning"&&(n[a]=this.props[a]);return{mobxStores:n}}},{key:"componentWillReceiveProps",value:function(n){if(Object.keys(n).length!==Object.keys(this.props).length&&Es.warn("MobX Provider: The set of provided stores has changed. Please avoid changing stores as the change might not propagate to all children"),!n.suppressChangedStoreWarning)for(var o in n)!xs[o]&&this.props[o]!==n[o]&&Es.warn("MobX Provider: Provided store '"+o+"' has changed. Please avoid replacing stores as the change might not propagate to all children")}}]),t})(W);if(!W)throw new Error("mobx-preact requires Preact to be available");var pe,di,bs,fd=[],wt=Y,Os=wt.__b,ws=wt.__r,Ss=wt.diffed,Ms=wt.__c,As=wt.unmount,Ts=wt.__;function xp(){for(var e;e=fd.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(fo),e.__H.__h.forEach(Xi),e.__H.__h=[]}catch(t){e.__H.__h=[],wt.__e(t,e.__v)}}wt.__b=function(e){pe=null,Os&&Os(e)},wt.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Ts&&Ts(e,t)},wt.__r=function(e){ws&&ws(e);var t=(pe=e.__c).__H;t&&(di===pe?(t.__h=[],pe.__h=[],t.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(t.__h.forEach(fo),t.__h.forEach(Xi),t.__h=[])),di=pe},wt.diffed=function(e){Ss&&Ss(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(fd.push(t)!==1&&bs===wt.requestAnimationFrame||((bs=wt.requestAnimationFrame)||Ep)(xp)),t.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),di=pe=null},wt.__c=function(e,t){t.some(function(r){try{r.__h.forEach(fo),r.__h=r.__h.filter(function(n){return!n.__||Xi(n)})}catch(n){t.some(function(o){o.__h&&(o.__h=[])}),t=[],wt.__e(n,r.__v)}}),Ms&&Ms(e,t)},wt.unmount=function(e){As&&As(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{fo(n)}catch(o){t=o}}),r.__H=void 0,t&&wt.__e(t,r.__v))};var Ps=typeof requestAnimationFrame=="function";function Ep(e){var t,r=function(){clearTimeout(n),Ps&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,100);Ps&&(t=requestAnimationFrame(r))}function fo(e){var t=pe,r=e.__c;typeof r=="function"&&(e.__c=void 0,r()),pe=t}function Xi(e){var t=pe;e.__c=e.__(),pe=t}function bp(e,t){for(var r in t)e[r]=t[r];return e}function Ds(e,t){for(var r in e)if(r!=="__source"&&!(r in t))return!0;for(var n in t)if(n!=="__source"&&e[n]!==t[n])return!0;return!1}function Ns(e,t){this.props=e,this.context=t}(Ns.prototype=new W).isPureReactComponent=!0,Ns.prototype.shouldComponentUpdate=function(e,t){return Ds(this.props,e)||Ds(this.state,t)};var Cs=Y.__b;Y.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Cs&&Cs(e)};var Op=Y.__e;Y.__e=function(e,t,r,n){if(e.then){for(var o,i=t;i=i.__;)if((o=i.__c)&&o.__c)return t.__e==null&&(t.__e=r.__e,t.__k=r.__k),o.__c(e,t)}Op(e,t,r,n)};var Rs=Y.unmount;function cd(e,t,r){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),e.__c.__H=null),(e=bp({},e)).__c!=null&&(e.__c.__P===r&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(n){return cd(n,t,r)})),e}function pd(e,t,r){return e&&r&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(n){return pd(n,t,r)}),e.__c&&e.__c.__P===t&&(e.__e&&r.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=r)),e}function fi(){this.__u=0,this.o=null,this.__b=null}function hd(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Gn(){this.i=null,this.l=null}Y.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),Rs&&Rs(e)},(fi.prototype=new W).__c=function(e,t){var r=t.__c,n=this;n.o==null&&(n.o=[]),n.o.push(r);var o=hd(n.__v),i=!1,a=function(){i||(i=!0,r.__R=null,o?o(s):s())};r.__R=a;var s=function(){if(!--n.__u){if(n.state.__a){var l=n.state.__a;n.__v.__k[0]=pd(l,l.__c.__P,l.__c.__O)}var u;for(n.setState({__a:n.__b=null});u=n.o.pop();)u.forceUpdate()}};n.__u++||32&t.__u||n.setState({__a:n.__b=n.__v.__k[0]}),e.then(a,a)},fi.prototype.componentWillUnmount=function(){this.o=[]},fi.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=cd(this.__b,r,n.__O=n.__P)}this.__b=null}var o=t.__a&&Sr(Mr,null,e.fallback);return o&&(o.__u&=-33),[Sr(Mr,null,t.__a?null:e.children),o]};var js=function(e,t,r){if(++r[1]===r[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(r=e.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.i=r=r[2]}};(Gn.prototype=new W).__a=function(e){var t=this,r=hd(t.__v),n=t.l.get(e);return n[0]++,function(o){var i=function(){t.props.revealOrder?(n.push(o),js(t,e,n)):o()};r?r(i):i()}},Gn.prototype.render=function(e){this.i=null,this.l=new Map;var t=vo(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var r=t.length;r--;)this.l.set(t[r],this.i=[1,0,this.i]);return e.children},Gn.prototype.componentDidUpdate=Gn.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,r){js(e,r,t)})};var wp=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Sp=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Mp=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Ap=/[A-Z0-9]/g,Tp=typeof document<"u",Pp=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function Ls(e,t,r){return t.__k==null&&(t.textContent=""),tc(e,t),typeof r=="function"&&r(),e?e.__c:null}W.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(W.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Is=Y.event;function Dp(){}function Np(){return this.cancelBubble}function Cp(){return this.defaultPrevented}Y.event=function(e){return Is&&(e=Is(e)),e.persist=Dp,e.isPropagationStopped=Np,e.isDefaultPrevented=Cp,e.nativeEvent=e};var Rp={enumerable:!1,configurable:!0,get:function(){return this.class}},Bs=Y.vnode;Y.vnode=function(e){typeof e.type=="string"&&function(t){var r=t.props,n=t.type,o={},i=n.indexOf("-")===-1;for(var a in r){var s=r[a];if(!(a==="value"&&"defaultValue"in r&&s==null||Tp&&a==="children"&&n==="noscript"||a==="class"||a==="className")){var l=a.toLowerCase();a==="defaultValue"&&"value"in r&&r.value==null?a="value":a==="download"&&s===!0?s="":l==="translate"&&s==="no"?s=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?a="ondblclick":l!=="onchange"||n!=="input"&&n!=="textarea"||Pp(r.type)?l==="onfocus"?a="onfocusin":l==="onblur"?a="onfocusout":Mp.test(a)&&(a=l):l=a="oninput":i&&Sp.test(a)?a=a.replace(Ap,"-$&").toLowerCase():s===null&&(s=void 0),l==="oninput"&&o[a=l]&&(a="oninputCapture"),o[a]=s}}n=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=vo(r.children).forEach(function(u){u.props.selected=o.value.indexOf(u.props.value)!=-1})),n=="select"&&o.defaultValue!=null&&(o.value=vo(r.children).forEach(function(u){u.props.selected=o.multiple?o.defaultValue.indexOf(u.props.value)!=-1:o.defaultValue==u.props.value})),r.class&&!r.className?(o.class=r.class,Object.defineProperty(o,"className",Rp)):(r.className&&!r.class||r.class&&r.className)&&(o.class=o.className=r.className),t.props=o}(e),e.$$typeof=wp,Bs&&Bs(e)};var $s=Y.__r;Y.__r=function(e){$s&&$s(e),e.__c};var Xs=Y.diffed;Y.diffed=function(e){Xs&&Xs(e);var t=e.props,r=e.__e;r!=null&&e.type==="textarea"&&"value"in t&&t.value!==r.value&&(r.value=t.value==null?"":t.value)};var jp=0;function w(e,t,r,n,o,i){t||(t={});var a,s,l=t;if("ref"in l)for(s in l={},t)s=="ref"?a=t[s]:l[s]=t[s];var u={type:e,props:l,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--jp,__i:-1,__u:0,__source:o,__self:i};if(typeof e=="function"&&(a=e.defaultProps))for(s in a)l[s]===void 0&&(l[s]=a[s]);return Y.vnode&&Y.vnode(u),u}var vd=typeof global=="object"&&global&&global.Object===Object&&global,Lp=typeof self=="object"&&self&&self.Object===Object&&self,le=vd||Lp||Function("return this")(),Ut=le.Symbol,yd=Object.prototype,Ip=yd.hasOwnProperty,Bp=yd.toString,Vr=Ut?Ut.toStringTag:void 0;function $p(e){var t=Ip.call(e,Vr),r=e[Vr];try{e[Vr]=void 0;var n=!0}catch{}var o=Bp.call(e);return n&&(t?e[Vr]=r:delete e[Vr]),o}var Xp=Object.prototype,Fp=Xp.toString;function kp(e){return Fp.call(e)}var Hp="[object Null]",Yp="[object Undefined]",Fs=Ut?Ut.toStringTag:void 0;function ze(e){return e==null?e===void 0?Yp:Hp:Fs&&Fs in Object(e)?$p(e):kp(e)}function ae(e){return e!=null&&typeof e=="object"}var Gp="[object Symbol]";function Ko(e){return typeof e=="symbol"||ae(e)&&ze(e)==Gp}function Ba(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var xt=Array.isArray,ks=Ut?Ut.prototype:void 0,Hs=ks?ks.toString:void 0;function gd(e){if(typeof e=="string")return e;if(xt(e))return Ba(e,gd)+"";if(Ko(e))return Hs?Hs.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Up=/\s/;function zp(e){for(var t=e.length;t--&&Up.test(e.charAt(t)););return t}var Wp=/^\s+/;function Vp(e){return e&&e.slice(0,zp(e)+1).replace(Wp,"")}function At(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ys=NaN,Kp=/^[-+]0x[0-9a-f]+$/i,Zp=/^0b[01]+$/i,qp=/^0o[0-7]+$/i,Jp=parseInt;function Fi(e){if(typeof e=="number")return e;if(Ko(e))return Ys;if(At(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=At(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Vp(e);var r=Zp.test(e);return r||qp.test(e)?Jp(e.slice(2),r?2:8):Kp.test(e)?Ys:+e}var Qp=1/0,th=17976931348623157e292;function eh(e){if(!e)return e===0?e:0;if(e=Fi(e),e===Qp||e===-1/0){var t=e<0?-1:1;return t*th}return e===e?e:0}function rh(e){var t=eh(e),r=t%1;return t===t?r?t-r:t:0}function Zo(e){return e}var nh="[object AsyncFunction]",oh="[object Function]",ih="[object GeneratorFunction]",ah="[object Proxy]";function $a(e){if(!At(e))return!1;var t=ze(e);return t==oh||t==ih||t==nh||t==ah}var ci=le["__core-js_shared__"],Gs=function(){var e=/[^.]+$/.exec(ci&&ci.keys&&ci.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function sh(e){return!!Gs&&Gs in e}var lh=Function.prototype,uh=lh.toString;function ur(e){if(e!=null){try{return uh.call(e)}catch{}try{return e+""}catch{}}return""}var dh=/[\\^$.*+?()[\]{}|]/g,fh=/^\[object .+?Constructor\]$/,ch=Function.prototype,ph=Object.prototype,hh=ch.toString,vh=ph.hasOwnProperty,yh=RegExp("^"+hh.call(vh).replace(dh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function gh(e){if(!At(e)||sh(e))return!1;var t=$a(e)?yh:fh;return t.test(ur(e))}function _h(e,t){return e==null?void 0:e[t]}function dr(e,t){var r=_h(e,t);return gh(r)?r:void 0}var ki=dr(le,"WeakMap"),Us=Object.create,mh=function(){function e(){}return function(t){if(!At(t))return{};if(Us)return Us(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function xh(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function pi(){}function Eh(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var bh=800,Oh=16,wh=Date.now;function Sh(e){var t=0,r=0;return function(){var n=wh(),o=Oh-(n-r);if(r=n,o>0){if(++t>=bh)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Mh(e){return function(){return e}}var wo=function(){try{var e=dr(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Ah=wo?function(e,t){return wo(e,"toString",{configurable:!0,enumerable:!1,value:Mh(t),writable:!0})}:Zo,_d=Sh(Ah);function md(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}function xd(e,t,r,n){for(var o=e.length,i=r+-1;++i<o;)if(t(e[i],i,e))return i;return-1}function Th(e){return e!==e}function Ph(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}function Dh(e,t,r){return t===t?Ph(e,t,r):xd(e,Th,r)}var Nh=9007199254740991,Ch=/^(?:0|[1-9]\d*)$/;function qo(e,t){var r=typeof e;return t=t??Nh,!!t&&(r=="number"||r!="symbol"&&Ch.test(e))&&e>-1&&e%1==0&&e<t}function Jo(e,t,r){t=="__proto__"&&wo?wo(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Rn(e,t){return e===t||e!==e&&t!==t}var Rh=Object.prototype,jh=Rh.hasOwnProperty;function Qo(e,t,r){var n=e[t];(!(jh.call(e,t)&&Rn(n,r))||r===void 0&&!(t in e))&&Jo(e,t,r)}function Ed(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=void 0;l===void 0&&(l=e[s]),o?Jo(r,s,l):Qo(r,s,l)}return r}var zs=Math.max;function bd(e,t,r){return t=zs(t===void 0?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=zs(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(a),xh(e,this,s)}}function Lh(e,t){return _d(bd(e,t,Zo),e+"")}var Ih=9007199254740991;function Xa(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ih}function De(e){return e!=null&&Xa(e.length)&&!$a(e)}function Bh(e,t,r){if(!At(r))return!1;var n=typeof t;return(n=="number"?De(r)&&qo(t,r.length):n=="string"&&t in r)?Rn(r[t],e):!1}function Od(e){return Lh(function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&typeof i=="function"?(o--,i):void 0,a&&Bh(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,i)}return t})}var $h=Object.prototype;function jn(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||$h;return e===r}function Xh(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var Fh="[object Arguments]";function Ws(e){return ae(e)&&ze(e)==Fh}var wd=Object.prototype,kh=wd.hasOwnProperty,Hh=wd.propertyIsEnumerable,jr=Ws(function(){return arguments}())?Ws:function(e){return ae(e)&&kh.call(e,"callee")&&!Hh.call(e,"callee")};function Yh(){return!1}var Sd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Vs=Sd&&typeof module=="object"&&module&&!module.nodeType&&module,Gh=Vs&&Vs.exports===Sd,Ks=Gh?le.Buffer:void 0,Uh=Ks?Ks.isBuffer:void 0,Lr=Uh||Yh,zh="[object Arguments]",Wh="[object Array]",Vh="[object Boolean]",Kh="[object Date]",Zh="[object Error]",qh="[object Function]",Jh="[object Map]",Qh="[object Number]",tv="[object Object]",ev="[object RegExp]",rv="[object Set]",nv="[object String]",ov="[object WeakMap]",iv="[object ArrayBuffer]",av="[object DataView]",sv="[object Float32Array]",lv="[object Float64Array]",uv="[object Int8Array]",dv="[object Int16Array]",fv="[object Int32Array]",cv="[object Uint8Array]",pv="[object Uint8ClampedArray]",hv="[object Uint16Array]",vv="[object Uint32Array]",ft={};ft[sv]=ft[lv]=ft[uv]=ft[dv]=ft[fv]=ft[cv]=ft[pv]=ft[hv]=ft[vv]=!0;ft[zh]=ft[Wh]=ft[iv]=ft[Vh]=ft[av]=ft[Kh]=ft[Zh]=ft[qh]=ft[Jh]=ft[Qh]=ft[tv]=ft[ev]=ft[rv]=ft[nv]=ft[ov]=!1;function yv(e){return ae(e)&&Xa(e.length)&&!!ft[ze(e)]}function Fa(e){return function(t){return e(t)}}var Md=typeof exports=="object"&&exports&&!exports.nodeType&&exports,nn=Md&&typeof module=="object"&&module&&!module.nodeType&&module,gv=nn&&nn.exports===Md,hi=gv&&vd.process,Ir=function(){try{var e=nn&&nn.require&&nn.require("util").types;return e||hi&&hi.binding&&hi.binding("util")}catch{}}(),Zs=Ir&&Ir.isTypedArray,ti=Zs?Fa(Zs):yv,_v=Object.prototype,mv=_v.hasOwnProperty;function Ad(e,t){var r=xt(e),n=!r&&jr(e),o=!r&&!n&&Lr(e),i=!r&&!n&&!o&&ti(e),a=r||n||o||i,s=a?Xh(e.length,String):[],l=s.length;for(var u in e)(t||mv.call(e,u))&&!(a&&(u=="length"||o&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||qo(u,l)))&&s.push(u);return s}function Td(e,t){return function(r){return e(t(r))}}var xv=Td(Object.keys,Object),Ev=Object.prototype,bv=Ev.hasOwnProperty;function Pd(e){if(!jn(e))return xv(e);var t=[];for(var r in Object(e))bv.call(e,r)&&r!="constructor"&&t.push(r);return t}function zr(e){return De(e)?Ad(e):Pd(e)}var Ov=Object.prototype,wv=Ov.hasOwnProperty,it=Od(function(e,t){if(jn(t)||De(t)){Ed(t,zr(t),e);return}for(var r in t)wv.call(t,r)&&Qo(e,r,t[r])});function Sv(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Mv=Object.prototype,Av=Mv.hasOwnProperty;function Tv(e){if(!At(e))return Sv(e);var t=jn(e),r=[];for(var n in e)n=="constructor"&&(t||!Av.call(e,n))||r.push(n);return r}function Dd(e){return De(e)?Ad(e,!0):Tv(e)}var Pv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dv=/^\w*$/;function ka(e,t){if(xt(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Ko(e)?!0:Dv.test(e)||!Pv.test(e)||t!=null&&e in Object(t)}var _n=dr(Object,"create");function Nv(){this.__data__=_n?_n(null):{},this.size=0}function Cv(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Rv="__lodash_hash_undefined__",jv=Object.prototype,Lv=jv.hasOwnProperty;function Iv(e){var t=this.__data__;if(_n){var r=t[e];return r===Rv?void 0:r}return Lv.call(t,e)?t[e]:void 0}var Bv=Object.prototype,$v=Bv.hasOwnProperty;function Xv(e){var t=this.__data__;return _n?t[e]!==void 0:$v.call(t,e)}var Fv="__lodash_hash_undefined__";function kv(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=_n&&t===void 0?Fv:t,this}function ar(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ar.prototype.clear=Nv;ar.prototype.delete=Cv;ar.prototype.get=Iv;ar.prototype.has=Xv;ar.prototype.set=kv;function Hv(){this.__data__=[],this.size=0}function ei(e,t){for(var r=e.length;r--;)if(Rn(e[r][0],t))return r;return-1}var Yv=Array.prototype,Gv=Yv.splice;function Uv(e){var t=this.__data__,r=ei(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Gv.call(t,r,1),--this.size,!0}function zv(e){var t=this.__data__,r=ei(t,e);return r<0?void 0:t[r][1]}function Wv(e){return ei(this.__data__,e)>-1}function Vv(e,t){var r=this.__data__,n=ei(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function Ne(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ne.prototype.clear=Hv;Ne.prototype.delete=Uv;Ne.prototype.get=zv;Ne.prototype.has=Wv;Ne.prototype.set=Vv;var mn=dr(le,"Map");function Kv(){this.size=0,this.__data__={hash:new ar,map:new(mn||Ne),string:new ar}}function Zv(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ri(e,t){var r=e.__data__;return Zv(t)?r[typeof t=="string"?"string":"hash"]:r.map}function qv(e){var t=ri(this,e).delete(e);return this.size-=t?1:0,t}function Jv(e){return ri(this,e).get(e)}function Qv(e){return ri(this,e).has(e)}function ty(e,t){var r=ri(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function Ce(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ce.prototype.clear=Kv;Ce.prototype.delete=qv;Ce.prototype.get=Jv;Ce.prototype.has=Qv;Ce.prototype.set=ty;var ey="Expected a function";function Ha(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(ey);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Ha.Cache||Ce),r}Ha.Cache=Ce;var ry=500;function ny(e){var t=Ha(e,function(n){return r.size===ry&&r.clear(),n}),r=t.cache;return t}var oy=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,iy=/\\(\\)?/g,ay=ny(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(oy,function(r,n,o,i){t.push(o?i.replace(iy,"$1"):n||r)}),t});function sy(e){return e==null?"":gd(e)}function ni(e,t){return xt(e)?e:ka(e,t)?[e]:ay(sy(e))}function Ln(e){if(typeof e=="string"||Ko(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function Ya(e,t){t=ni(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Ln(t[r++])];return r&&r==n?e:void 0}function In(e,t,r){var n=e==null?void 0:Ya(e,t);return n===void 0?r:n}function Nd(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var qs=Ut?Ut.isConcatSpreadable:void 0;function ly(e){return xt(e)||jr(e)||!!(qs&&e&&e[qs])}function uy(e,t,r,n,o){var i=-1,a=e.length;for(r||(r=ly),o||(o=[]);++i<a;){var s=e[i];r(s)?Nd(o,s):o[o.length]=s}return o}function dy(e){var t=e==null?0:e.length;return t?uy(e):[]}function fy(e){return _d(bd(e,void 0,dy),e+"")}var Cd=Td(Object.getPrototypeOf,Object),cy="[object Object]",py=Function.prototype,hy=Object.prototype,Rd=py.toString,vy=hy.hasOwnProperty,yy=Rd.call(Object);function gy(e){if(!ae(e)||ze(e)!=cy)return!1;var t=Cd(e);if(t===null)return!0;var r=vy.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Rd.call(r)==yy}function _y(e,t,r,n){var o=-1,i=e==null?0:e.length;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}function my(){this.__data__=new Ne,this.size=0}function xy(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function Ey(e){return this.__data__.get(e)}function by(e){return this.__data__.has(e)}var Oy=200;function wy(e,t){var r=this.__data__;if(r instanceof Ne){var n=r.__data__;if(!mn||n.length<Oy-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ce(n)}return r.set(e,t),this.size=r.size,this}function ie(e){var t=this.__data__=new Ne(e);this.size=t.size}ie.prototype.clear=my;ie.prototype.delete=xy;ie.prototype.get=Ey;ie.prototype.has=by;ie.prototype.set=wy;var jd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Js=jd&&typeof module=="object"&&module&&!module.nodeType&&module,Sy=Js&&Js.exports===jd,Qs=Sy?le.Buffer:void 0,tl=Qs?Qs.allocUnsafe:void 0;function Ld(e,t){if(t)return e.slice();var r=e.length,n=tl?tl(r):new e.constructor(r);return e.copy(n),n}function My(e,t){for(var r=-1,n=e==null?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}function Ay(){return[]}var Ty=Object.prototype,Py=Ty.propertyIsEnumerable,el=Object.getOwnPropertySymbols,Dy=el?function(e){return e==null?[]:(e=Object(e),My(el(e),function(t){return Py.call(e,t)}))}:Ay;function Ny(e,t,r){var n=t(e);return xt(e)?n:Nd(n,r(e))}function Hi(e){return Ny(e,zr,Dy)}var Yi=dr(le,"DataView"),Gi=dr(le,"Promise"),Ui=dr(le,"Set"),rl="[object Map]",Cy="[object Object]",nl="[object Promise]",ol="[object Set]",il="[object WeakMap]",al="[object DataView]",Ry=ur(Yi),jy=ur(mn),Ly=ur(Gi),Iy=ur(Ui),By=ur(ki),It=ze;(Yi&&It(new Yi(new ArrayBuffer(1)))!=al||mn&&It(new mn)!=rl||Gi&&It(Gi.resolve())!=nl||Ui&&It(new Ui)!=ol||ki&&It(new ki)!=il)&&(It=function(e){var t=ze(e),r=t==Cy?e.constructor:void 0,n=r?ur(r):"";if(n)switch(n){case Ry:return al;case jy:return rl;case Ly:return nl;case Iy:return ol;case By:return il}return t});var $y=Object.prototype,Xy=$y.hasOwnProperty;function Fy(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Xy.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var So=le.Uint8Array;function Ga(e){var t=new e.constructor(e.byteLength);return new So(t).set(new So(e)),t}function ky(e,t){var r=Ga(e.buffer);return new e.constructor(r,e.byteOffset,e.byteLength)}var Hy=/\w*$/;function Yy(e){var t=new e.constructor(e.source,Hy.exec(e));return t.lastIndex=e.lastIndex,t}var sl=Ut?Ut.prototype:void 0,ll=sl?sl.valueOf:void 0;function Gy(e){return ll?Object(ll.call(e)):{}}function Id(e,t){var r=t?Ga(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Uy="[object Boolean]",zy="[object Date]",Wy="[object Map]",Vy="[object Number]",Ky="[object RegExp]",Zy="[object Set]",qy="[object String]",Jy="[object Symbol]",Qy="[object ArrayBuffer]",tg="[object DataView]",eg="[object Float32Array]",rg="[object Float64Array]",ng="[object Int8Array]",og="[object Int16Array]",ig="[object Int32Array]",ag="[object Uint8Array]",sg="[object Uint8ClampedArray]",lg="[object Uint16Array]",ug="[object Uint32Array]";function dg(e,t,r){var n=e.constructor;switch(t){case Qy:return Ga(e);case Uy:case zy:return new n(+e);case tg:return ky(e);case eg:case rg:case ng:case og:case ig:case ag:case sg:case lg:case ug:return Id(e,r);case Wy:return new n;case Vy:case qy:return new n(e);case Ky:return Yy(e);case Zy:return new n;case Jy:return Gy(e)}}function Bd(e){return typeof e.constructor=="function"&&!jn(e)?mh(Cd(e)):{}}var fg="[object Map]";function cg(e){return ae(e)&&It(e)==fg}var ul=Ir&&Ir.isMap,pg=ul?Fa(ul):cg,hg="[object Set]";function vg(e){return ae(e)&&It(e)==hg}var dl=Ir&&Ir.isSet,yg=dl?Fa(dl):vg,gg=1,$d="[object Arguments]",_g="[object Array]",mg="[object Boolean]",xg="[object Date]",Eg="[object Error]",Xd="[object Function]",bg="[object GeneratorFunction]",Og="[object Map]",wg="[object Number]",Fd="[object Object]",Sg="[object RegExp]",Mg="[object Set]",Ag="[object String]",Tg="[object Symbol]",Pg="[object WeakMap]",Dg="[object ArrayBuffer]",Ng="[object DataView]",Cg="[object Float32Array]",Rg="[object Float64Array]",jg="[object Int8Array]",Lg="[object Int16Array]",Ig="[object Int32Array]",Bg="[object Uint8Array]",$g="[object Uint8ClampedArray]",Xg="[object Uint16Array]",Fg="[object Uint32Array]",st={};st[$d]=st[_g]=st[Dg]=st[Ng]=st[mg]=st[xg]=st[Cg]=st[Rg]=st[jg]=st[Lg]=st[Ig]=st[Og]=st[wg]=st[Fd]=st[Sg]=st[Mg]=st[Ag]=st[Tg]=st[Bg]=st[$g]=st[Xg]=st[Fg]=!0;st[Eg]=st[Xd]=st[Pg]=!1;function co(e,t,r,n,o,i){var a,s=t&gg;if(a!==void 0)return a;if(!At(e))return e;var l=xt(e);if(l)a=Fy(e);else{var u=It(e),f=u==Xd||u==bg;if(Lr(e))return Ld(e,s);if(u==Fd||u==$d||f&&!o)a=f?{}:Bd(e);else{if(!st[u])return o?e:{};a=dg(e,u,s)}}i||(i=new ie);var d=i.get(e);if(d)return d;i.set(e,a),yg(e)?e.forEach(function(v){a.add(co(v,t,r,v,e,i))}):pg(e)&&e.forEach(function(v,h){a.set(h,co(v,t,r,h,e,i))});var c=Hi,p=l?void 0:c(e);return md(p||e,function(v,h){p&&(h=v,v=e[h]),Qo(a,h,co(v,t,r,h,e,i))}),a}var kg=1,Hg=4;function k(e){return co(e,kg|Hg)}var Yg="__lodash_hash_undefined__";function Gg(e){return this.__data__.set(e,Yg),this}function Ug(e){return this.__data__.has(e)}function Mo(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Ce;++t<r;)this.add(e[t])}Mo.prototype.add=Mo.prototype.push=Gg;Mo.prototype.has=Ug;function zg(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function Wg(e,t){return e.has(t)}var Vg=1,Kg=2;function kd(e,t,r,n,o,i){var a=r&Vg,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var u=i.get(e),f=i.get(t);if(u&&f)return u==t&&f==e;var d=-1,c=!0,p=r&Kg?new Mo:void 0;for(i.set(e,t),i.set(t,e);++d<s;){var v=e[d],h=t[d];if(n)var _=a?n(h,v,d,t,e,i):n(v,h,d,e,t,i);if(_!==void 0){if(_)continue;c=!1;break}if(p){if(!zg(t,function(y,m){if(!Wg(p,m)&&(v===y||o(v,y,r,n,i)))return p.push(m)})){c=!1;break}}else if(!(v===h||o(v,h,r,n,i))){c=!1;break}}return i.delete(e),i.delete(t),c}function Hd(e){var t=-1,r=Array(e.size);return e.forEach(function(n,o){r[++t]=[o,n]}),r}function Zg(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var qg=1,Jg=2,Qg="[object Boolean]",t_="[object Date]",e_="[object Error]",r_="[object Map]",n_="[object Number]",o_="[object RegExp]",i_="[object Set]",a_="[object String]",s_="[object Symbol]",l_="[object ArrayBuffer]",u_="[object DataView]",fl=Ut?Ut.prototype:void 0,vi=fl?fl.valueOf:void 0;function d_(e,t,r,n,o,i,a){switch(r){case u_:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case l_:return!(e.byteLength!=t.byteLength||!i(new So(e),new So(t)));case Qg:case t_:case n_:return Rn(+e,+t);case e_:return e.name==t.name&&e.message==t.message;case o_:case a_:return e==t+"";case r_:var s=Hd;case i_:var l=n&qg;if(s||(s=Zg),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;n|=Jg,a.set(e,t);var f=kd(s(e),s(t),n,o,i,a);return a.delete(e),f;case s_:if(vi)return vi.call(e)==vi.call(t)}return!1}var f_=1,c_=Object.prototype,p_=c_.hasOwnProperty;function h_(e,t,r,n,o,i){var a=r&f_,s=Hi(e),l=s.length,u=Hi(t),f=u.length;if(l!=f&&!a)return!1;for(var d=l;d--;){var c=s[d];if(!(a?c in t:p_.call(t,c)))return!1}var p=i.get(e),v=i.get(t);if(p&&v)return p==t&&v==e;var h=!0;i.set(e,t),i.set(t,e);for(var _=a;++d<l;){c=s[d];var y=e[c],m=t[c];if(n)var S=a?n(m,y,c,t,e,i):n(y,m,c,e,t,i);if(!(S===void 0?y===m||o(y,m,r,n,i):S)){h=!1;break}_||(_=c=="constructor")}if(h&&!_){var M=e.constructor,A=t.constructor;M!=A&&"constructor"in e&&"constructor"in t&&!(typeof M=="function"&&M instanceof M&&typeof A=="function"&&A instanceof A)&&(h=!1)}return i.delete(e),i.delete(t),h}var v_=1,cl="[object Arguments]",pl="[object Array]",Un="[object Object]",y_=Object.prototype,hl=y_.hasOwnProperty;function g_(e,t,r,n,o,i){var a=xt(e),s=xt(t),l=a?pl:It(e),u=s?pl:It(t);l=l==cl?Un:l,u=u==cl?Un:u;var f=l==Un,d=u==Un,c=l==u;if(c&&Lr(e)){if(!Lr(t))return!1;a=!0,f=!1}if(c&&!f)return i||(i=new ie),a||ti(e)?kd(e,t,r,n,o,i):d_(e,t,l,r,n,o,i);if(!(r&v_)){var p=f&&hl.call(e,"__wrapped__"),v=d&&hl.call(t,"__wrapped__");if(p||v){var h=p?e.value():e,_=v?t.value():t;return i||(i=new ie),o(h,_,r,n,i)}}return c?(i||(i=new ie),h_(e,t,r,n,o,i)):!1}function oi(e,t,r,n,o){return e===t?!0:e==null||t==null||!ae(e)&&!ae(t)?e!==e&&t!==t:g_(e,t,r,n,oi,o)}var __=1,m_=2;function x_(e,t,r,n){var o=r.length,i=o;if(e==null)return!i;for(e=Object(e);o--;){var a=r[o];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++o<i;){a=r[o];var s=a[0],l=e[s],u=a[1];if(a[2]){if(l===void 0&&!(s in e))return!1}else{var f=new ie,d;if(!(d===void 0?oi(u,l,__|m_,n,f):d))return!1}}return!0}function Yd(e){return e===e&&!At(e)}function E_(e){for(var t=zr(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,Yd(o)]}return t}function Gd(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}function b_(e){var t=E_(e);return t.length==1&&t[0][2]?Gd(t[0][0],t[0][1]):function(r){return r===e||x_(r,e,t)}}function O_(e,t){return e!=null&&t in Object(e)}function Ud(e,t,r){t=ni(t,e);for(var n=-1,o=t.length,i=!1;++n<o;){var a=Ln(t[n]);if(!(i=e!=null&&r(e,a)))break;e=e[a]}return i||++n!=o?i:(o=e==null?0:e.length,!!o&&Xa(o)&&qo(a,o)&&(xt(e)||jr(e)))}function zd(e,t){return e!=null&&Ud(e,t,O_)}var w_=1,S_=2;function M_(e,t){return ka(e)&&Yd(t)?Gd(Ln(e),t):function(r){var n=In(r,e);return n===void 0&&n===t?zd(r,e):oi(t,n,w_|S_)}}function A_(e){return function(t){return t==null?void 0:t[e]}}function T_(e){return function(t){return Ya(t,e)}}function P_(e){return ka(e)?A_(Ln(e)):T_(e)}function Bn(e){return typeof e=="function"?e:e==null?Zo:typeof e=="object"?xt(e)?M_(e[0],e[1]):b_(e):P_(e)}function D_(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),s=a.length;s--;){var l=a[++o];if(r(i[l],l,i)===!1)break}return t}}var Wd=D_();function Vd(e,t){return e&&Wd(e,t,zr)}function N_(e,t){return function(r,n){if(r==null)return r;if(!De(r))return e(r,n);for(var o=r.length,i=-1,a=Object(r);++i<o&&n(a[i],i,a)!==!1;);return r}}var Ua=N_(Vd),yi=function(){return le.Date.now()},C_="Expected a function",R_=Math.max,j_=Math.min;function za(e,t,r){var n,o,i,a,s,l,u=0,f=!1,d=!1,c=!0;if(typeof e!="function")throw new TypeError(C_);t=Fi(t)||0,At(r)&&(f=!!r.leading,d="maxWait"in r,i=d?R_(Fi(r.maxWait)||0,t):i,c="trailing"in r?!!r.trailing:c);function p(b){var g=n,x=o;return n=o=void 0,u=b,a=e.apply(x,g),a}function v(b){return u=b,s=setTimeout(y,t),f?p(b):a}function h(b){var g=b-l,x=b-u,T=t-g;return d?j_(T,i-x):T}function _(b){var g=b-l,x=b-u;return l===void 0||g>=t||g<0||d&&x>=i}function y(){var b=yi();if(_(b))return m(b);s=setTimeout(y,h(b))}function m(b){return s=void 0,c&&n?p(b):(n=o=void 0,a)}function S(){s!==void 0&&clearTimeout(s),u=0,n=l=o=s=void 0}function M(){return s===void 0?a:m(yi())}function A(){var b=yi(),g=_(b);if(n=arguments,o=this,l=b,g){if(s===void 0)return v(l);if(d)return clearTimeout(s),s=setTimeout(y,t),p(l)}return s===void 0&&(s=setTimeout(y,t)),a}return A.cancel=S,A.flush=M,A}function zi(e,t,r){(r!==void 0&&!Rn(e[t],r)||r===void 0&&!(t in e))&&Jo(e,t,r)}function L_(e){return ae(e)&&De(e)}function Wi(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function I_(e){return Ed(e,Dd(e))}function B_(e,t,r,n,o,i,a){var s=Wi(e,r),l=Wi(t,r),u=a.get(l);if(u){zi(e,r,u);return}var f=i?i(s,l,r+"",e,t,a):void 0,d=f===void 0;if(d){var c=xt(l),p=!c&&Lr(l),v=!c&&!p&&ti(l);f=l,c||p||v?xt(s)?f=s:L_(s)?f=Eh(s):p?(d=!1,f=Ld(l,!0)):v?(d=!1,f=Id(l,!0)):f=[]:gy(l)||jr(l)?(f=s,jr(s)?f=I_(s):(!At(s)||$a(s))&&(f=Bd(l))):d=!1}d&&(a.set(l,f),o(f,l,n,i,a),a.delete(l)),zi(e,r,f)}function Kd(e,t,r,n,o){e!==t&&Wd(t,function(i,a){if(o||(o=new ie),At(i))B_(e,t,a,r,Kd,n,o);else{var s=n?n(Wi(e,a),i,a+"",e,t,o):void 0;s===void 0&&(s=i),zi(e,a,s)}},Dd)}function $_(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function X_(e){return typeof e=="function"?e:Zo}function ht(e,t){var r=xt(e)?md:Ua;return r(e,X_(t))}function F_(e,t){return Ba(t,function(r){return[r,e[r]]})}function k_(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=[n,n]}),r}var H_="[object Map]",Y_="[object Set]";function G_(e){return function(t){var r=It(t);return r==H_?Hd(t):r==Y_?k_(t):F_(t,e(t))}}var We=G_(zr);function U_(e){return function(t,r,n){var o=Object(t);if(!De(t)){var i=Bn(r);t=zr(t),r=function(s){return i(o[s],s,o)}}var a=e(t,r,n);return a>-1?o[i?t[a]:a]:void 0}}var z_=Math.max;function W_(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var o=r==null?0:rh(r);return o<0&&(o=z_(n+o,0)),xd(e,Bn(t),o)}var sr=U_(W_);function V_(e,t){var r=-1,n=De(e)?Array(e.length):[];return Ua(e,function(o,i,a){n[++r]=t(o,i,a)}),n}function Pe(e,t){var r=xt(e)?Ba:V_;return r(e,Bn(t))}var K_=Object.prototype,Z_=K_.hasOwnProperty;function q_(e,t){return e!=null&&Z_.call(e,t)}function vl(e,t){return e!=null&&Ud(e,t,q_)}function J_(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var o=0;return Dh(e,t,o)}var Q_="[object Boolean]";function Vi(e){return e===!0||e===!1||ae(e)&&ze(e)==Q_}var tm="[object Map]",em="[object Set]",rm=Object.prototype,nm=rm.hasOwnProperty;function Zd(e){if(e==null)return!0;if(De(e)&&(xt(e)||typeof e=="string"||typeof e.splice=="function"||Lr(e)||ti(e)||jr(e)))return!e.length;var t=It(e);if(t==tm||t==em)return!e.size;if(jn(e))return!Pd(e).length;for(var r in e)if(nm.call(e,r))return!1;return!0}function yl(e,t){return oi(e,t)}function Qt(e){return e==null}function Br(e){return e===void 0}function om(e,t){var r={};return t=Bn(t),Vd(e,function(n,o,i){Jo(r,t(n,o,i),n)}),r}var Wa=Od(function(e,t,r){Kd(e,t,r)});function qd(e,t,r,n){if(!At(e))return e;t=ni(t,e);for(var o=-1,i=t.length,a=i-1,s=e;s!=null&&++o<i;){var l=Ln(t[o]),u=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(o!=a){var f=s[l];u=void 0,u===void 0&&(u=At(f)?f:qo(t[o+1])?[]:{})}Qo(s,l,u),s=s[l]}return e}function im(e,t,r){for(var n=-1,o=t.length,i={};++n<o;){var a=t[n],s=Ya(e,a);r(s,a)&&qd(i,ni(a,e),s)}return i}function am(e,t){return im(e,t,function(r,n){return zd(e,n)})}var xr=fy(function(e,t){return e==null?{}:am(e,t)});function sm(e,t,r,n,o){return o(e,function(i,a,s){r=n?(n=!1,i):t(r,i,a,s)}),r}function lm(e,t,r){var n=xt(e)?_y:sm,o=arguments.length<3;return n(e,Bn(t),r,o,Ua)}function um(e,t,r){return e==null?e:qd(e,t,r)}var dm="Expected a function";function fm(e,t,r){var n=!0,o=!0;if(typeof e!="function")throw new TypeError(dm);return At(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),za(e,t,{leading:n,maxWait:t,trailing:o})}var cm=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},xn;(function(e){function t(r){var n=cm(r,[]),o=r.container;if(!o)throw new Error("Ensure the container of LogicFlow is specified and valid.");return it({},e.defaults,n)}e.get=t})(xn||(xn={}));(function(e){e.defaults={background:!1,grid:!1,textEdit:!0,snapline:!0,outline:!1,disabledTools:[]}})(xn||(xn={}));var gl={node:!1,edge:!1},pm={node:!0,edge:!0},hm=function(e){return!e||typeof e=="boolean"?k(e===!0?pm:gl):Wa(k(gl),e)},vm=function(){return In(window,"navigator.userAgent","").match(/MSIE|Trident/)!==null};function Mt(e){try{return JSON.parse(JSON.stringify(e))}catch{return e}}var _l=200,ym=9999,gm=10,J;(function(e){e[e.DEFAULT=1]="DEFAULT",e[e.TEXT_EDIT=2]="TEXT_EDIT",e[e.SHOW_MENU=3]="SHOW_MENU",e[e.ALLOW_CONNECT=4]="ALLOW_CONNECT",e[e.NOT_ALLOW_CONNECT=5]="NOT_ALLOW_CONNECT"})(J||(J={}));var ct;(function(e){e.NODE="node",e.EDGE="edge",e.GRAPH="graph"})(ct||(ct={}));var G;(function(e){e.NODE="node",e.CIRCLE_NODE="circle-node",e.POLYGON_NODE="polygon-node",e.RECT_NODE="rect-node",e.TEXT_NODE="text-node",e.ELLIPSE_NODE="ellipse-node",e.DIAMOND_NODE="diamond-node",e.HTML_NODE="html-node",e.CUSTOM_HTML_NODE="custom-html-node",e.EDGE="edge",e.LINE_EDGE="line-edge",e.POLYLINE_EDGE="polyline-edge",e.BEZIER_EDGE="bezier-edge",e.GRAPH="graph"})(G||(G={}));var R;(function(e){e.ELEMENT_CLICK="element:click",e.NODE_ADD="node:add",e.NODE_DELETE="node:delete",e.NODE_CLICK="node:click",e.NODE_DBCLICK="node:dbclick",e.NODE_GROUP_COPY="node:group-copy-add",e.NODE_DND_ADD="node:dnd-add",e.NODE_DND_DRAG="node:dnd-drag",e.NODE_MOUSEDOWN="node:mousedown",e.NODE_DRAGSTART="node:dragstart",e.NODE_DRAG="node:drag",e.NODE_DROP="node:drop",e.NODE_MOUSEUP="node:mouseup",e.NODE_MOUSEMOVE="node:mousemove",e.NODE_MOUSEENTER="node:mouseenter",e.NODE_MOUSELEAVE="node:mouseleave",e.NODE_CONTEXTMENU="node:contextmenu",e.NODE_ROTATE="node:rotate",e.NODE_RESIZE="node:resize",e.NODE_FOCUS="node:focus",e.NODE_BLUR="node:blur",e.NODE_PROPERTIES_CHANGE="node:properties-change",e.NODE_PROPERTIES_DELETE="node:properties-delete",e.EDGE_ADD="edge:add",e.EDGE_DELETE="edge:delete",e.EDGE_CLICK="edge:click",e.EDGE_DBCLICK="edge:dbclick",e.EDGE_FOCUS="edge:focus",e.EDGE_BLUR="edge:blur",e.EDGE_MOUSEENTER="edge:mouseenter",e.EDGE_MOUSELEAVE="edge:mouseleave",e.EDGE_CONTEXTMENU="edge:contextmenu",e.EDGE_ADJUST="edge:adjust",e.EDGE_EXCHANGE_NODE="edge:exchange-node",e.ANCHOR_CLICK="anchor:click",e.ANCHOR_MOUSEDOWN="anchor:mousedown",e.ANCHOR_DRAGSTART="anchor:dragstart",e.ANCHOR_DRAG="anchor:drag",e.ANCHOR_DROP="anchor:drop",e.ANCHOR_DRAGEND="anchor:dragend",e.ADJUST_POINT_MOUSEDOWN="adjustPoint:mousedown",e.ADJUST_POINT_MOUSEUP="adjustPoint:mouseup",e.ADJUST_POINT_MOUSEMOVE="adjustPoint:mousemove",e.ADJUST_POINT_DRAGSTART="adjustPoint:dragstart",e.ADJUST_POINT_DRAG="adjustPoint:drag",e.ADJUST_POINT_DROP="adjustPoint:drop",e.ADJUST_POINT_DRAGEND="adjustPoint:dragend",e.BLANK_MOUSEDOWN="blank:mousedown",e.BLANK_DRAGSTART="blank:dragstart",e.BLANK_DRAG="blank:drag",e.BLANK_DROP="blank:drop",e.BLANK_MOUSEMOVE="blank:mousemove",e.BLANK_MOUSEUP="blank:mouseup",e.BLANK_CLICK="blank:click",e.BLANK_CONTEXTMENU="blank:contextmenu",e.SELECTION_MOUSEDOWN="selection:mousedown",e.SELECTION_DRAGSTART="selection:dragstart",e.SELECTION_DRAG="selection:drag",e.SELECTION_DROP="selection:drop",e.SELECTION_MOUSEMOVE="selection:mousemove",e.SELECTION_MOUSEUP="selection:mouseup",e.SELECTION_CONTEXTMENU="selection:contextmenu",e.CONNECTION_NOT_ALLOWED="connection:not-allowed",e.TEXT_MOUSEDOWN="text:mousedown",e.TEXT_DRAGSTART="text:dragstart",e.TEXT_DRAG="text:drag",e.TEXT_DROP="text:drop",e.TEXT_CLICK="text:click",e.TEXT_DBCLICK="text:dbclick",e.TEXT_BLUR="text:blur",e.TEXT_MOUSEMOVE="text:mousemove",e.TEXT_MOUSEUP="text:mouseup",e.TEXT_FOCUS="text:focus",e.TEXT_ADD="text:add",e.TEXT_UPDATE="text:update",e.TEXT_CLEAR="text:clear",e.LABEL_MOUSEDOWN="label:mousedown",e.LABEL_DRAGSTART="label:dragstart",e.LABEL_DRAG="label:drag",e.LABEL_DROP="label:drop",e.LABEL_CLICK="label:click",e.LABEL_DBCLICK="label:dbclick",e.LABEL_BLUR="label:blur",e.LABEL_MOUSEMOVE="label:mousemove",e.LABEL_MOUSEUP="label:mouseup",e.LABEL_FOCUS="label:focus",e.LABEL_ADD="label:add",e.LABEL_UPDATE="label:update",e.LABEL_CLEAR="label:clear",e.LABEL_DELETE="label:delete",e.LABEL_SHOULD_ADD="label:should-add",e.LABEL_BATCH_ADD="label:batch-add",e.LABEL_SHOULD_UPDATE="label:should-update",e.LABEL_SHOULD_DELETE="label:should-delete",e.LABEL_BATCH_DELETE="label:batch-delete",e.LABEL_NOT_ALLOWED_ADD="label:not-allowed-add",e.HISTORY_CHANGE="history:change",e.GRAPH_TRANSFORM="graph:transform",e.GRAPH_RENDERED="graph:rendered",e.GRAPH_UPDATED="graph:updated"})(R||(R={}));var Jt;(function(e){e[e.DEFAULT=0]="DEFAULT",e[e.INCREASE=1]="INCREASE"})(Jt||(Jt={}));var ut;(function(e){e.HORIZONTAL="horizontal",e.VERTICAL="vertical"})(ut||(ut={}));var Yt;(function(e){e.TEXT="text",e.LABEL="label"})(Yt||(Yt={}));var _m=0,Ee=function(){function e(t){var r=t.onDragStart,n=r===void 0?pi:r,o=t.onDragging,i=o===void 0?pi:o,a=t.onDragEnd,s=a===void 0?pi:a,l=t.eventType,u=l===void 0?"":l,f=t.eventCenter,d=t.step,c=d===void 0?1:d,p=t.isStopPropagation,v=p===void 0?!0:p,h=t.model,_=t.data,y=this;this.isDragging=!1,this.isStartDragging=!1,this.startX=0,this.startY=0,this.sumDeltaX=0,this.sumDeltaY=0,this.handleMouseDown=function(m){var S,M,A=window==null?void 0:window.document;if(m.button===_m){y.isStopPropagation&&m.stopPropagation(),y.isStartDragging=!0,y.startX=m.clientX,y.startY=m.clientY,A.addEventListener("mousemove",y.handleMouseMove,!1),A.addEventListener("mouseup",y.handleMouseUp,!1);var b=(S=y.model)===null||S===void 0?void 0:S.getData();(M=y.eventCenter)===null||M===void 0||M.emit(R["".concat(y.eventType,"_MOUSEDOWN")],{e:m,data:y.data||b}),y.startTime=new Date().getTime()}},this.handleMouseMove=function(m){var S,M;if(y.isStopPropagation&&m.stopPropagation(),!!y.isStartDragging&&(y.sumDeltaX+=m.clientX-y.startX,y.sumDeltaY+=m.clientY-y.startY,y.startX=m.clientX,y.startY=m.clientY,y.step<=1||Math.abs(y.sumDeltaX)>y.step||Math.abs(y.sumDeltaY)>y.step)){var A=y.sumDeltaX%y.step,b=y.sumDeltaY%y.step,g=y.sumDeltaX-A,x=y.sumDeltaY-b;y.sumDeltaX=A,y.sumDeltaY=b;var T=(S=y.model)===null||S===void 0?void 0:S.getData();y.isDragging||((M=y.eventCenter)===null||M===void 0||M.emit(R["".concat(y.eventType,"_DRAGSTART")],{e:m,data:y.data||T}),y.onDragStart({event:m})),y.isDragging=!0,Promise.resolve().then(function(){var P,j;y.onDragging({deltaX:g,deltaY:x,event:m}),(P=y.eventCenter)===null||P===void 0||P.emit(R["".concat(y.eventType,"_MOUSEMOVE")],{deltaX:g,deltaY:x,e:m,data:y.data||T}),(j=y.eventCenter)===null||j===void 0||j.emit(R["".concat(y.eventType,"_DRAG")],{e:m,data:y.data||T})})}},this.handleMouseUp=function(m){var S=window.document;y.isStartDragging=!1,y.isStopPropagation&&m.stopPropagation(),Promise.resolve().then(function(){var M,A,b;S.removeEventListener("mousemove",y.handleMouseMove,!1),S.removeEventListener("mouseup",y.handleMouseUp,!1);var g=(M=y.model)===null||M===void 0?void 0:M.getData();(A=y.eventCenter)===null||A===void 0||A.emit(R["".concat(y.eventType,"_MOUSEUP")],{e:m,data:y.data||g}),y.isDragging&&(y.isDragging=!1,y.onDragEnd({event:m}),(b=y.eventCenter)===null||b===void 0||b.emit(R["".concat(y.eventType,"_DROP")],{e:m,data:y.data||g}))})},this.cancelDrag=function(){var m=window==null?void 0:window.document;m.removeEventListener("mousemove",y.handleMouseMove,!1),m.removeEventListener("mouseup",y.handleMouseUp,!1),y.onDragEnd({event:void 0}),y.isDragging=!1},this.destroy=function(){y.isStartDragging&&y.cancelDrag()},this.onDragStart=n,this.onDragging=i,this.onDragEnd=s,this.step=c,this.isStopPropagation=v,this.eventType=u,this.eventCenter=f,this.model=h,this.data=_}return e.prototype.setStep=function(t){this.step=t},e.prototype.setModel=function(t){this.model=t},e}(),mm=function(e){var t=e.x,r=e.y,n=e.width,o=e.height;return{x:t-n/2,y:r-o/2,x1:t+n/2,y1:r+o/2}},xm=function(e){var t=e.startPoint,r=e.endPoint,n=(t.x+r.x)/2,o=(t.y+r.y)/2,i=Math.abs(t.x-r.x)+10,a=Math.abs(t.y-r.y)+10;return{x:n-i/2,y:o-a/2,x1:n+i/2,y1:o+a/2}},Em=function(e){var t=e.points,r=lr(t),n=On(r,8),o=n.x,i=n.y,a=n.width,s=n.height;return{x:o-a/2,y:i-s/2,x1:o+a/2,y1:i+s/2}},bm=function(e){var t=e.path,r=Va(t),n=On(r,8),o=n.x,i=n.y,a=n.width,s=n.height;return{x:o-a/2,y:i-s/2,x1:o+a/2,y1:i+s/2}},Om=function(e){if(e.modelType===G.LINE_EDGE)return xm(e);if(e.modelType===G.POLYLINE_EDGE)return Em(e);if(e.modelType===G.BEZIER_EDGE)return bm(e)},wm=function(e,t,r,n){var o=(t.y-e.y)*(n.x-r.x)-(e.x-t.x)*(r.y-n.y);if(o===0)return!1;var i=((t.x-e.x)*(n.x-r.x)*(r.y-e.y)+(t.y-e.y)*(n.x-r.x)*e.x-(n.y-r.y)*(t.x-e.x)*r.x)/o,a=-((t.y-e.y)*(n.y-r.y)*(r.x-e.x)+(t.x-e.x)*(n.y-r.y)*e.y-(n.x-r.x)*(t.y-e.y)*r.y)/o;return(i-e.x)*(i-t.x)<=0&&(a-e.y)*(a-t.y)<=0&&(i-r.x)*(i-n.x)<=0&&(a-r.y)*(a-n.y)<=0?{x:i,y:a}:!1},En=function(e,t,r){var n=e.x,o=e.y,i=t.x,a=t.y,s=r.x,l=r.y,u=(l-a)/(s-i),f=a-u*i;return(n>=i&&n<=s||n<=i&&n>=s)&&(o>=a&&o<=l||o<=a&&o>=l)&&Math.abs(o-u*n-f)<Number.EPSILON},bn=function(e){var t=e.start,r=e.end,n=e.offset,o=e.verticalLength,i=e.type,a={leftX:0,leftY:0,rightX:0,rightY:0},s=Math.atan((r.y-t.y)/(r.x-t.x)),l=Math.atan(n/o),u=Math.sqrt(o*o+n*n);return i==="start"?r.x>=t.x?(a.leftX=t.x+u*Math.sin(s+l),a.leftY=t.y-u*Math.cos(s+l),a.rightX=t.x-u*Math.sin(s-l),a.rightY=t.y+u*Math.cos(s-l)):(a.leftX=t.x-u*Math.sin(s+l),a.leftY=t.y+u*Math.cos(s+l),a.rightX=t.x+u*Math.sin(s-l),a.rightY=t.y-u*Math.cos(s-l)):i==="end"&&(r.x>=t.x?(a.leftX=r.x+u*Math.sin(s-l),a.leftY=r.y-u*Math.cos(s-l),a.rightX=r.x-u*Math.sin(s+l),a.rightY=r.y+u*Math.cos(s+l)):(a.leftX=r.x-u*Math.sin(s-l),a.leftY=r.y+u*Math.cos(s-l),a.rightX=r.x+u*Math.sin(s+l),a.rightY=r.y-u*Math.cos(s+l))),a},Er=function(){return Er=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Er.apply(this,arguments)},kt=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},He=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},Sm=function(e,t){return Math.abs(e.centerX-t.centerX)*2<e.width+t.width&&Math.abs(e.centerY-t.centerY)*2<e.height+t.height},Ki=function(e){var t=[],r={};return e.forEach(function(n){var o="".concat(n.x,"-").concat(n.y);n.id=o,r[o]=n}),Object.keys(r).forEach(function(n){t.push(r[n])}),t},Ao=function(e,t){return e.width===0&&e.height===0?e:{x:e.x,y:e.y,centerX:e.centerX,centerY:e.centerY,minX:e.minX-t,minY:e.minY-t,maxX:e.maxX+t,maxY:e.maxY+t,height:e.height+2*t,width:e.width+2*t}},Mm=function(e,t){var r=Math.abs(e.x-t.centerX),n=Math.abs(e.y-t.centerY);return r/t.width>n/t.height?ut.HORIZONTAL:ut.VERTICAL},To=function(e,t,r){var n=Mm(r,t);return n===ut.HORIZONTAL?{x:r.x>e.centerX?e.maxX:e.minX,y:r.y}:{x:r.x,y:r.y>e.centerY?e.maxY:e.minY}},ml=function(e,t){var r=Math.min(e.minX,t.minX),n=Math.min(e.minY,t.minY),o=Math.max(e.maxX,t.maxX),i=Math.max(e.maxY,t.maxY);return{x:(r+o)/2,y:(n+i)/2,centerX:(r+o)/2,centerY:(n+i)/2,minX:r,minY:n,maxX:o,maxY:i,height:i-n,width:o-r}},On=function(e,t){e===void 0&&(e=[]);var r=[],n=[];e.forEach(function(f){r.push(f.x),n.push(f.y)});var o=Math.min.apply(Math,He([],kt(r),!1)),i=Math.max.apply(Math,He([],kt(r),!1)),a=Math.min.apply(Math,He([],kt(n),!1)),s=Math.max.apply(Math,He([],kt(n),!1)),l=i-o,u=s-a;return t&&(l+=t,u+=t),{centerX:(o+i)/2,centerY:(a+s)/2,maxX:i,maxY:s,minX:o,minY:a,x:(o+i)/2,y:(a+s)/2,height:u,width:l}},Po=function(e){var t=e.minX,r=e.minY,n=e.maxX,o=e.maxY;return[{x:t,y:r},{x:n,y:r},{x:n,y:o},{x:t,y:o}]},zn=function(e,t){var r=e.x,n=e.y;return r<t.minX||r>t.maxX||n<t.minY||n>t.maxY},Am=function(e,t){return t<e.minX||t>e.maxX?[]:[{x:t,y:e.minY},{x:t,y:e.maxY}]},Tm=function(e,t){return t<e.minY||t>e.maxY?[]:[{x:e.minX,y:t},{x:e.maxX,y:t}]},Pm=function(e,t){return He(He([],kt(Am(e,t.x)),!1),kt(Tm(e,t.y)),!1)},Zi=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},Dm=function(e,t){var r=-2,n=0;return t.forEach(function(o){o&&(e.x===o.x&&(n+=r),e.y===o.y&&(n+=r))}),n},xl=function(e,t,r,n,o){return Zi(e,t)+Zi(e,r)+Dm(e,[t,r,n,o])},Jd=function(e,t,r,n,o){o||(o=0),e.unshift(t[n]),r[n]&&r[n]!==n&&o<=100&&Jd(e,t,r,r[n],o+1)},Nm=function(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)},Qr=function(e,t,r,n){var o=t.x-e.x,i=t.y-e.y,a=n.x-r.x,s=n.y-r.y,l=(-i*(e.x-r.x)+o*(e.y-r.y))/(-a*i+o*s),u=(a*(e.y-r.y)-s*(e.x-r.x))/(-a*i+o*s);return l>=0&&l<=1&&u>=0&&u<=1},El=function(e,t,r){if(r.width===0&&r.height===0)return!1;var n=kt(Po(r),4),o=n[0],i=n[1],a=n[2],s=n[3];return Qr(e,t,o,i)||Qr(e,t,o,s)||Qr(e,t,i,a)||Qr(e,t,a,s)},Cm=function(e,t,r,n){var o=[];return e.forEach(function(i){i!==t&&(i.x===t.x||i.y===t.y)&&!El(i,t,r)&&!El(i,t,n)&&o.push(i)}),Ki(o)},Rm=function(e,t,r,n,o,i,a){var s=[],l=[t],u={},f={},d={};t.id&&(f[t.id]=0,d[t.id]=xl(t,r,t));var c={};e.forEach(function(h){h.id&&(c[h.id]=h)});for(var p=function(){var h,_=1/0;if(l.forEach(function(m){m.id&&d[m.id]<_&&(_=d[m.id],h=m)}),h===r&&r.id){var y=[];return Jd(y,c,u,r.id),{value:y}}if(!h)return{value:[t,r]};Nm(l,h),s.push(h),Cm(e,h,n,o).forEach(function(m){if(s.indexOf(m)===-1&&(l.indexOf(m)===-1&&l.push(m),h!=null&&h.id&&(m!=null&&m.id))){var S=d[h.id]+Zi(h,m);if(f[m.id]&&S>=f[m.id])return;u[m.id]=h.id,f[m.id]=S,d[m.id]=f[m.id]+xl(m,r,t,i,a)}})};l.length;){var v=p();if(typeof v=="object")return v.value}return[t,r]},bl=function(e){return Bt(e)},Qd=function(e){for(var t=1;t<e.length-1;){var r=e[t-1],n=e[t],o=e[t+1];r.x===n.x&&n.x===o.x||r.y===n.y&&n.y===o.y?e.splice(t,1):t++}return e},Ol=function(e,t,r,n,o){var i=bl(r),a=bl(n),s=Ao(i,o),l=Ao(a,o),u=To(s,i,e),f=To(l,a,t);if(Sm(s,l)){var d=Lm(e,t,u,f);return He(He([e,u],kt(d),!1),[f,t],!1)}var c=On([u,f]),p=ml(s,c),v=ml(l,c),h=[];h=h.concat(Po(p)),h=h.concat(Po(v));var _={x:(e.x+t.x)/2,y:(e.y+t.y)/2};[c,p,v].forEach(function(m){h=h.concat(Pm(m,_).filter(function(S){return zn(S,s)&&zn(S,l)}))}),[{x:u.x,y:f.y},{x:f.x,y:u.y}].forEach(function(m){zn(m,s)&&zn(m,l)&&h.push(m)}),h.unshift(u),h.push(f),h=Ki(h);var y=Rm(h,u,f,i,a,e,t);return y.unshift(e),y.push(t),y.length>2&&(y=Qd(y)),Ki(y)},jm=function(e){if(e.length===1){var t=kt(e,1),r=t[0];return[r,r]}else{for(var n=e[0],o=e[1],i=te(n.x,n.y,o.x,o.y),a=1;a<e.length-1;a++){var s=e[a],l=e[a+1],u=te(s.x,s.y,l.x,l.y);u>i&&(i=u,n=s,o=l)}return[n,o]}},wl=function(e,t,r){var n=Te(e,r),o=Te(t,r);return n&&o},Sl=function(e,t,r){var n=Te(e,r),o=Te(t,r),i=n&&o,a=n||o;return!i&&a},Ml=function(e,t,r){for(var n=void 0,o=Bt(r),i=Po(o),a=0;a<i.length;a++){var s=Qr(e,t,i[a],i[(a+1)%i.length]);s&&(n=[i[a],i[(a+1)%i.length]])}if(n)return wm(e,t,n[0],n[1])},Do=function(e,t){var r=void 0;return e.x===t.x?r=ut.VERTICAL:e.y===t.y&&(r=ut.HORIZONTAL),r},lr=function(e){var t=e.split(" "),r=[];return t&&t.forEach(function(n){var o=kt(n.split(","),2),i=o[0],a=o[1];r.push({x:Number(i),y:Number(a)})}),r},Lm=function(e,t,r,n){var o=[],i=Do(e,r),a=Do(t,n);if(i===a)e.y===r.y?(o.push({x:r.x,y:(r.y+n.y)/2}),o.push({x:n.x,y:(r.y+n.y)/2})):(o.push({x:(r.x+n.x)/2,y:r.y}),o.push({x:(r.x+n.x)/2,y:n.y}));else{var s={x:r.x,y:n.y},l=En(s,e,r),u=En(s,t,n);if(l||u)s={x:n.x,y:r.y};else{var f=Al(s,e,r),d=Al(s,t,n);f&&d&&(s={x:n.x,y:r.y})}o.push(s)}return o},Al=function(e,t,r){return e.x===t.x&&e.x===r.x||e.y===t.y&&e.y===r.y},tf=function(e){if(!e)return 0;for(var t=0,r=0;r<e.length;r++){var n=e.charCodeAt(r);e.match(/[A-Z]/)?t+=1.5:n>=1&&n<=126||n>=65376&&n<=65439?t+=1:t+=2}return t},Im=function(e){var t=e.start,r=e.end,n;if(t.x===r.x&&t.y===r.y)n="";else{var o={start:t,end:r,offset:10,verticalLength:5},i=bn(Er(Er({},o),{type:"start"})),a=bn(Er(Er({},o),{type:"end"}));n="M".concat(i.leftX," ").concat(i.leftY,`
    L`).concat(i.rightX," ").concat(i.rightY,`
    L`).concat(a.rightX," ").concat(a.rightY,`
    L`).concat(a.leftX," ").concat(a.leftY," z")}return{d:n,fill:"transparent",stroke:"transparent",strokeWidth:1,strokeDasharray:"4, 4"}},Tl=function(e){var t=e.start,r=e.end,n=e.sourceNode,o=e.targetNode,i=e.offset,a=Bt(n),s=Bt(o),l=Ao(a,i),u=Ao(s,i),f=To(l,a,t),d=To(u,s,r);return{sNext:f,ePre:d}},Va=function(e){var t=e.replace(/M/g,"").replace(/C/g,",").split(","),r=Wn(t[0]),n=Wn(t[1]),o=Wn(t[2]),i=Wn(t[3]);return[r,n,o,i]},Wn=function(e){var t=kt(e.replace(/(^\s*)/g,"").split(" "),2),r=t[0],n=t[1];return{x:+r,y:+n}},Pl=function(e,t){var r=kt(e,4),n=r[0],o=r[1],i=r[2],a=r[3],s=Mx(n,o,i,a,t);return[s,e[3]]},ef=function(e,t){for(var r=e.x,n=e.y,o=lr(t),i=Number.MAX_SAFE_INTEGER,a,s=[],l=0;l<o.length;l++)s.push({start:o[l],end:o[(l+1)%o.length]});if(s.forEach(function(c){var p=c.start,v=c.end;if(p.x===v.x){var h={x:p.x,y:n},_=En(h,p,v);if(_){var y=Math.abs(p.x-r);y<i&&(i=y,a=h)}}else if(p.y===v.y){var h={x:r,y:p.y},_=En(h,p,v);if(_){var y=Math.abs(p.y-n);y<i&&(i=y,a=h)}}}),!a){var u=s[0],f=u.start,d=u.end;a={x:f.x+(d.x-f.x)/2,y:f.y+(d.y-f.y)/2}}return a},Bm=function(e){return xr(e,["id","type","sourceNodeId","sourceAnchorId","targetNodeId","targetAnchorId","pointsList","startPoint","endPoint","properties"])},Dl=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))};function $m(e,t){return typeof t!="function"?function(r,n,o){return Object.assign({type:e.edgeType},o)}:function(r,n,o){var i=t(r,n,o);return i?typeof i=="string"?Object.assign({},o,{type:i}):Object.assign({type:i},o):{type:e.edgeType}}}var Xm=function(e){var t=e.rows,r=e.rowsLength,n=e.fontSize,o=0;return ht(t,function(i){var a=tf(i);o=a>o?a:o}),{width:Math.ceil(o/2)*n+n/4,height:r*(n+2)+n/4}},cr=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Vn=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))};function $r(e,t,r){return r&&t*Math.round(e/t)||e}function Fm(e,t,r){if(!e)return[];var n=Math.min.apply(Math,Vn([],cr(e.map(function(h){return h[0]})),!1)),o=Math.max.apply(Math,Vn([],cr(e.map(function(h){return h[0]})),!1)),i=Math.min.apply(Math,Vn([],cr(e.map(function(h){return h[1]})),!1)),a=Math.max.apply(Math,Vn([],cr(e.map(function(h){return h[1]})),!1)),s=-n,l=-i,u=e.map(function(h){var _=cr(h,2),y=_[0],m=_[1];return[y+s,m+l]}),f=o-n,d=a-i,c=t?t/f:1,p=r?r/d:1,v=Math.min(c,p);return u.map(function(h){var _=cr(h,2),y=_[0],m=_[1];return[y*v,m*v]})}var gi=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},_i=function(e,t,r){var n=gi(e,2),o=n[0],i=n[1],a=gi(t,2),s=a[0],l=a[1],u=gi(r,2),f=u[0],d=u[1];return o>s&&o<f&&i>l&&i<d},rf=function(e,t){var r=t.multipleSelectKey,n=!1;switch(r){case"meta":n=e.metaKey;break;case"alt":n=e.altKey;break;case"shift":n=e.shiftKey;break;case"ctrl":n=e.ctrlKey;break;default:n=!1;break}return n},Ka=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function Nl(e,t){return e instanceof St&&t instanceof St}var nf=function(e){Ka(t,e);function t(r,n,o){var i=e.call(this,3)||this;return i[0]=r,i[1]=n,i[2]=o,i.x=r,i.y=n,i.z=o,Object.setPrototypeOf(i,t.prototype),i}return t.prototype.add=function(r){if(Nl(this,r))return new St(this.x+r.x,this.y+r.y);var n=this.z+r.z;return new qi((this.x+r.x)/n,(this.y+r.y)/n)},t.prototype.subtract=function(r){if(Nl(this,r))return new St(this.x-r.x,this.y-r.y);var n=this.z-r.z;return n===0?new St(this.x-r.x,this.y-r.y):new qi((this.x-r.x)/n,(this.y-r.y)/n)},t}(Array),St=function(e){Ka(t,e);function t(r,n,o){var i=e.call(this,r,n,o??0)||this;return Object.setPrototypeOf(i,t.prototype),i}return t.prototype.toString=function(){return"Vector"},t.prototype.dot=function(r){var n=this;return r.reduce(function(o,i,a){return o+i*n[a]})},t.prototype.cross=function(r){return new t(this.y*r.z-this.z*r.y,this.z*r.x-this.x*r.z,this.x*r.y-this.y*r.x)},t.prototype.getLength=function(){return Math.hypot(this.x,this.y)},t.prototype.normalize=function(){var r=this.getLength();return new t(this.x/r,this.y/r)},t.prototype.crossZ=function(r){return this.x*r.y-this.y*r.x},t.prototype.angle=function(r){var n=this.crossZ(r),o=Math.acos(this.normalize().dot(r.normalize()));return n>=0?o:-o},t}(nf),qi=function(e){Ka(t,e);function t(r,n){var o=e.call(this,r,n,1)||this;return Object.setPrototypeOf(o,t.prototype),o}return t.prototype.toString=function(){return"Point"},t}(nf),ii=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pr=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},mi=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},$n=function(e){ii(t,e);function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=e.call(this,r.length)||this;return o.fill(new Array(3)),r.forEach(function(i,a){o[a]=i}),o.columns=r[0].length,o.rows=r.length,Object.setPrototypeOf(o,t.prototype),o}return t.prototype.getRow=function(r){return this[r]},t.prototype.getColumn=function(r){return mi([],pr(this.map(function(n){return n[r]})),!1)},t.prototype.transpose=function(){for(var r=[],n=0;n<this.columns;n++)r.push(this.getColumn(n));return new(t.bind.apply(t,mi([void 0],pr(r),!1)))},t.prototype.cross=function(r){var n=new Array(this.rows).fill("").map(function(){return[]});if(this.columns===r.rows)for(var o=0;o<this.rows;o++)for(var i=this.getRow(o),a=function(l){var u=r.getColumn(l);n[o][l]=i.reduce(function(f,d,c){return f+d*u[c]},0)},s=0;s<r.columns;s++)a(s);return new(t.bind.apply(t,mi([void 0],pr(n),!1)))},t.prototype.to2D=function(){return this.map(function(r){return[r[0],r[1]]})},t.prototype.toPoints=function(){return this.map(function(r){return new qi(r[0],r[1])})},t.prototype.toString=function(){var r=pr(this[0],2),n=r[0],o=r[1],i=pr(this[1],2),a=i[0],s=i[1],l=pr(this[2],2),u=l[0],f=l[1];return"matrix(".concat(n," ").concat(o," ").concat(a," ").concat(s," ").concat(u," ").concat(f,")")},t.prototype.translate=function(r,n){return this.cross(new No(r,n))},t.prototype.rotate=function(r){return this.cross(new km(r))},t.prototype.scale=function(r,n){return this.cross(new Hm(r,n))},t}(Array),km=function(e){ii(t,e);function t(r){var n=e.call(this,new St(+Math.cos(r).toFixed(2),+Math.sin(r).toFixed(2),0),new St(-Math.sin(r).toFixed(2),+Math.cos(r).toFixed(2),0),new St(0,0,1))||this;return Object.setPrototypeOf(n,t.prototype),n}return t.prototype.inverse=function(){return this.transpose()},t}($n),Hm=function(e){ii(t,e);function t(r,n){var o=e.call(this,new St(r,0,0),new St(0,n,0),new St(0,0,1))||this;return o.sx=r,o.sy=n,Object.setPrototypeOf(o,t.prototype),o}return t.prototype.inverse=function(){return new t(1/this.sx,1/this.sy)},t}($n),No=function(e){ii(t,e);function t(r,n){var o=e.call(this,new St(1,0,0),new St(0,1,0),new St(r,n,1))||this;return o.tx=r,o.ty=n,Object.setPrototypeOf(o,t.prototype),o}return t.prototype.inverse=function(){return new t(-this.tx,-this.ty)},t}($n);Hc({});var Co=function(){return Co=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Co.apply(this,arguments)},Ym=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Ji=function(e){var t=e.anchors;return t},Ro=function(e,t){for(var r=t.nodes,n,o=r.length-1;o>=0;o--){var i=r[o],a=zm(e,i);if(a){var s=i.getTargetAnchor(e);if(s){var l={node:i,anchorIndex:s.index,anchor:s.anchor};(!n||Gm(i,n.node,t))&&(n=l)}}}return n},Gm=function(e,t,r){return e.zIndex>t.zIndex?!0:r.nodesMap[e.id].index>r.nodesMap[t.id].index},Um=function(e,t){for(var r=Ji(t),n,o=Number.MAX_SAFE_INTEGER,i=0;i<r.length;i++){var a=te(e.x,e.y,r[i].x,r[i].y);a<o&&(o=a,n={index:i,anchor:Co(Co({},r[i]),{x:r[i].x,y:r[i].y,id:r[i].id})})}return n},te=function(e,t,r,n){return Math.hypot(e-r,t-n)},Te=function(e,t,r){r===void 0&&(r=0);var n=!1,o=Bt(t),i=Ym(new $n([e.x,e.y,1]).translate(-t.x,-t.y).rotate(-t.rotate).translate(t.x,t.y)[0],2),a=i[0],s=i[1],l={x:a,y:s};return l.x>=o.minX-r&&l.x<=o.maxX+r&&l.y>=o.minY-r&&l.y<=o.maxY+r&&(n=!0),n},zm=function(e,t){return Te(e,t,5)},Bt=function(e){var t=e.x,r=e.y,n=e.width,o=e.height;return{minX:t-n/2,minY:r-o/2,maxX:t+n/2,maxY:r+o/2,x:t,y:r,width:n,height:o,centerX:t,centerY:r}},Wm=function(e){var t=e,r=t.x,n=t.y,o=t.width,i=t.height,a=t.radius;return[{x:r-o/2+a,y:n-i/2+a,r:a},{x:r+o/2-a,y:n-i/2+a,r:a},{x:r-o/2+a,y:n+i/2-a,r:a},{x:r+o/2-a,y:n+i/2-a,r:a}]},Cl=function(e,t,r){var n=Wm(r),o,i=Number.MAX_SAFE_INTEGER;return n.forEach(function(a){var s=te(e.x,e.y,a.x,a.y);s<i&&(i=s,o=a)}),Qi(e,t,o)},Qi=function(e,t,r){var n,o=r.x,i=r.y,a=r.r;if(t===ut.HORIZONTAL){var s=o-Math.sqrt(a*a-(e.y-i)*(e.y-i)),l=o+Math.sqrt(a*a-(e.y-i)*(e.y-i)),u=Math.abs(s-e.x)<Math.abs(l-e.x)?s:l;n={x:u,y:e.y}}else if(t===ut.VERTICAL){var f=i-Math.sqrt(a*a-(e.x-o)*(e.x-o)),d=i+Math.sqrt(a*a-(e.x-o)*(e.x-o)),c=Math.abs(f-e.y)<Math.abs(d-e.y)?f:d;n={x:e.x,y:c}}return n},Rl=function(e,t){var r=t,n=!1,o=r.x,i=r.y,a=r.width,s=r.height,l=r.radius,u={minX:o-a/2+l,maxX:o+a/2-l,minY:i-s/2+l,maxY:i+s/2-l};return e.y===i+s/2||e.y===i-s/2?n=e.x>u.minX&&e.x<u.maxX:(e.x===o+a/2||e.x===o-a/2)&&(n=e.y>u.minY&&e.y<u.maxY),n},jl=function(e,t,r){var n,o=r,i=o.x,a=o.y,s=o.rx,l=o.ry;if(t===ut.HORIZONTAL){var u=i-Math.sqrt(s*s-(e.y-a)*(e.y-a)*s*s/(l*l)),f=i+Math.sqrt(s*s-(e.y-a)*(e.y-a)*s*s/(l*l)),d=Math.abs(u-e.x)<Math.abs(f-e.x)?u:f;n={x:d,y:e.y}}else if(t===ut.VERTICAL){var c=a-Math.sqrt(l*l-(e.x-i)*(e.x-i)*l*l/(s*s)),p=a+Math.sqrt(l*l-(e.x-i)*(e.x-i)*l*l/(s*s)),v=Math.abs(c-e.y)<Math.abs(p-e.y)?c:p;n={x:e.x,y:v}}return n},Kn=function(e,t,r){for(var n=r.pointsPosition,o=Number.MAX_SAFE_INTEGER,i,a=[],s=0;s<n.length;s++)a.push({start:n[s],end:n[(s+1)%n.length]});return a.forEach(function(l){var u=l.start,f=l.end,d=u,c=f;u.x>f.x&&(d=f,c=u);var p={x:e.x,y:e.y};if(d.x===c.x&&t===ut.HORIZONTAL&&(p={x:d.x,y:e.y}),d.y===c.y&&t===ut.VERTICAL&&(p={x:e.x,y:d.y}),d.x!==c.x&&d.y!==c.y){var v=(c.y-d.y)/(c.x-d.x),h=(d.x*c.y-c.x*d.y)/(d.x-c.x);t===ut.HORIZONTAL?p={x:(e.y-h)/v,y:e.y}:t===ut.VERTICAL&&(p={x:e.x,y:v*e.x+h})}var _=En(p,u,f);if(_){var y=te(p.x,p.y,e.x,e.y);y<o&&(o=y,i=p)}}),i},Vm=function(e){var t=xr(e,["id","type","x","y","text","label","properties","virtual","rotate","resizable","rotatable"]);return t},Ll=function(e,t,r,n){var o=e.x,i=e.y;return t.x>e.x?o=e.x+r/2:t.x<e.x&&(o=e.x-r/2),t.y>e.y?i=e.y+n/2:t.y<e.y&&(i=e.y-n/2),{x:o,y:i}},of=function(e){var t=e.rows,r=e.style,n=e.rowsLength,o=e.className,i=document.createElement("div");i.className=o,i.style.fontSize="".concat(r.fontSize),i.style.width="".concat(r.width),i.style.lineHeight="".concat(r.lineHeight),i.style.padding="".concat(r.padding),r.fontFamily&&(i.style.fontFamily="".concat(r.fontFamily)),n>1?t.forEach(function(s){var l=document.createElement("div");l.textContent=s,i.appendChild(l)}):i.textContent=t[0],document.body.appendChild(i);var a=i.clientHeight;return document.body.removeChild(i),a},Il=function(e){var t=e.rows,r=e.rowsLength,n=e.fontSize,o=0;return t&&t.forEach(function(i){var a=tf(i);o=a>o?a:o}),{width:Math.ceil(o/2)*n+n/4,height:r*(n+2)+n/4}},jo=function(e){return typeof e!="object"?{isAllPass:!!e,msg:e?"":""}:e};let Zn;const Km=new Uint8Array(16);function Zm(){if(!Zn&&(Zn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Zn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Zn(Km)}const Ot=[];for(let e=0;e<256;++e)Ot.push((e+256).toString(16).slice(1));function qm(e,t=0){return Ot[e[t+0]]+Ot[e[t+1]]+Ot[e[t+2]]+Ot[e[t+3]]+"-"+Ot[e[t+4]]+Ot[e[t+5]]+"-"+Ot[e[t+6]]+Ot[e[t+7]]+"-"+Ot[e[t+8]]+Ot[e[t+9]]+"-"+Ot[e[t+10]]+Ot[e[t+11]]+Ot[e[t+12]]+Ot[e[t+13]]+Ot[e[t+14]]+Ot[e[t+15]]}const Jm=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Bl={randomUUID:Jm};function Qm(e,t,r){if(Bl.randomUUID&&!e)return Bl.randomUUID();e=e||{};const n=e.random||(e.rng||Zm)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,qm(n)}var or=function(){return Qm()},on=new Map,af=function(e){var t=or();function r(){e();var o=on.get(t);if(o){var i=window.requestAnimationFrame(r);on.set(t,i)}}var n=window.requestAnimationFrame(r);return on.set(t,n),t},Lo=function(e){var t=on.get(e);t&&(window.cancelAnimationFrame(t),on.delete(e))},wn=function(){return wn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},wn.apply(this,arguments)},tx=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};function sf(e){var t=e.x,r=t===void 0?0:t,n=e.y,o=n===void 0?0:n,i=e.value,a=e.fontSize,s=a===void 0?12:a,l=e.fill,u=l===void 0?"currentColor":l,f=e.overflowMode,d=f===void 0?"default":f,c=e.textWidth,p=c===void 0?void 0:c,v=e.model,h={x:r,y:o,fill:u,fontSize:s,textAnchor:"middle",dominantBaseline:"central"};if(ht(We(e),function(A){var b=tx(A,2),g=b[0],x=b[1];typeof x!="object"&&(h[g]=x)}),i){var _=String(i).split(/[\r\n]/g),y=_.length;if(d!=="default"){var m=v.BaseType,S=v.modelType;if(m===ct.NODE&&S!==G.TEXT_NODE||m===ct.EDGE&&p)return ex(e)}if(y>1){var M=_.map(function(A,b){var g=s+2,x=(b-(y-1)/2)*g;return w("tspan",{className:"lf-text-tspan",x:r,y:o+x,children:A})});return w("text",wn({},h,{children:M}))}return w("text",wn({},h,{children:i}))}return null}function ex(e){var t=e.x,r=e.y,n=e.value,o=e.model,i=e.textWidth,a=e.fontSize,s=a===void 0?12:a,l=e.lineHeight,u=e.fontFamily,f=u===void 0?"":u,d=e.wrapPadding,c=d===void 0?"0, 0":d,p=e.overflowMode,v=o.width,h=o.height,_=o.textHeight,y=i||v,m=String(n).split(/[\r\n]/g),S=m.length,M=of({rows:m,style:{fontSize:"".concat(s,"px"),width:"".concat(y,"px"),fontFamily:f,lineHeight:l,padding:c},rowsLength:S,className:"lf-get-text-height"}),A=h>M?h:M;_&&(A=_);var b=p==="ellipsis";return b&&(A=s+2),w("g",{children:w("foreignObject",{width:y,height:A,x:t-y/2,y:r-A/2,style:{overflow:"visible",textAlign:"left"},children:w("div",{className:"lf-node-text-auto-wrap",style:{minHeight:A,width:y,padding:c},children:w("div",{className:b?"lf-node-text-ellipsis-content":"lf-node-text-auto-wrap-content",title:b?m.join(""):"",style:wn({},e),children:m.map(function(g){return w("div",{className:"lf-node-text--auto-wrap-inner",children:g})})})})})})}var ta=function(){return ta=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ta.apply(this,arguments)},rx=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};function Xr(e){var t={x1:10,y1:10,x2:20,y2:20,stroke:"black"};return ht(We(e),function(r){var n=rx(r,2),o=n[0],i=n[1];(o==="style"||typeof i!="object")&&(t[o]=i)}),w("line",ta({},t))}var ea=function(){return ea=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ea.apply(this,arguments)},nx=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};function ye(e){var t=e.x,r=e.y,n=e.width,o=e.height,i=e.className,a=e.strokeWidth,s=e.radius,l=s===void 0?0:s,u=t-n/2,f=r-o/2,d={};return d["stroke-width"]=a,ht(We(e),function(c){var p=nx(c,2),v=p[0],h=p[1];typeof h!="object"&&(d[v]=h)}),i?d.className="lf-basic-shape ".concat(i):d.className="lf-basic-shape",l&&(d.rx=l,d.ry=l),d.x=u,d.y=f,w("rect",ea({},d))}var ra=function(){return ra=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ra.apply(this,arguments)},ox=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};function Sn(e){var t={d:""};return ht(We(e),function(r){var n=ox(r,2),o=n[0],i=n[1];(o==="style"||typeof i!="object")&&(t[o]=i)}),w("path",ra({},t))}var na=function(){return na=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},na.apply(this,arguments)},ix=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};function Fr(e){var t=e.x,r=t===void 0?0:t,n=e.y,o=n===void 0?0:n,i=e.r,a=i===void 0?4:i,s=e.className,l={cx:r,cy:o,r:a,fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1};return ht(We(e),function(u){var f=ix(u,2),d=f[0],c=f[1];typeof c!="object"&&(l[d]=c)}),s?l.className="lf-basic-shape ".concat(s):l.className="lf-basic-shape",w("circle",na({},l))}var oa=function(){return oa=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},oa.apply(this,arguments)},ax=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};function sx(e){var t=e.x,r=t===void 0?0:t,n=e.y,o=n===void 0?0:n,i=e.rx,a=i===void 0?4:i,s=e.ry,l=s===void 0?4:s,u=e.className,f={cx:r,cy:o,rx:a,ry:l,fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1};return ht(We(e),function(d){var c=ax(d,2),p=c[0],v=c[1];typeof v!="object"&&(f[p]=v)}),u?f.className="lf-basic-shape ".concat(u):f.className="lf-basic-shape",w("ellipse",oa({},f))}var ia=function(){return ia=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ia.apply(this,arguments)},lx=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};function lf(e){var t=e.points,r=t===void 0?[]:t,n=e.className,o={fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1,points:""};return ht(We(e),function(i){var a=lx(i,2),s=a[0],l=a[1];typeof l!="object"&&(o[s]=l)}),n?o.classNmae="lf-basic-shape ".concat(n):o.className="lf-basic-shape",o.points=r.map(function(i){return i.join(",")}).join(" "),w("polygon",ia({},o))}var aa=function(){return aa=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},aa.apply(this,arguments)},ux=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};function dx(e){var t=e.className,r={points:"",fill:"none"};return ht(We(e),function(n){var o=ux(n,2),i=o[0],a=o[1];(i==="style"||typeof a!="object")&&(r[i]=a)}),t&&(r.className="".concat(t)),w("polyline",aa({},r))}var uf=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Mn=function(){return Mn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Mn.apply(this,arguments)},fx=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},cx=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},ot;(function(e){e[e.LEFT_TOP=0]="LEFT_TOP",e[e.RIGHT_TOP=1]="RIGHT_TOP",e[e.RIGHT_BOTTOM=2]="RIGHT_BOTTOM",e[e.LEFT_BOTTOM=3]="LEFT_BOTTOM"})(ot||(ot={}));var px=function(e){uf(t,e);function t(r){var n=e.call(this)||this;n.updateEdgePointByAnchors=function(){var s=n.nodeModel,l=s.id,u=s.anchors,f=n.graphModel.getNodeEdges(l);ht(f,function(d){if(d.sourceNodeId===l){var c=sr(u,function(p){return p.id===d.sourceAnchorId});c&&d.updateStartPoint({x:c.x,y:c.y})}else if(d.targetNodeId===l){var c=sr(u,function(v){return v.id===d.targetAnchorId});c&&d.updateEndPoint({x:c.x,y:c.y})}})},n.triggerResizeEvent=function(s,l,u,f,d,c){n.graphModel.eventCenter.emit(R.NODE_RESIZE,{preData:s,data:l,deltaX:u,deltaY:f,index:d,model:c})},n.recalcResizeInfo=function(s,l,u,f,d){u===void 0&&(u=1),f===void 0&&(f=!1),d===void 0&&(d=!1);var c=k(l),p=c.deltaX,v=c.deltaY,h=c.width,_=c.height,y=c.PCTResizeInfo;if(y){var m=4,S=0,M=0;switch(s){case ot.LEFT_TOP:M=(p*-1-v)/m;break;case ot.RIGHT_TOP:M=(p-v)/m;break;case ot.RIGHT_BOTTOM:M=(p+v)/m;break;case ot.LEFT_BOTTOM:M=(p*-1+v)/m;break}M!==0&&(S=Math.round(M/y.ResizeBasis.basisHeight*1e5)/1e3),y.ResizePCT.widthPCT=Math.max(Math.min(y.ResizePCT.widthPCT+S,y.ScaleLimit.maxScaleLimit),y.ScaleLimit.minScaleLimit),y.ResizePCT.heightPCT=Math.max(Math.min(y.ResizePCT.heightPCT+S,y.ScaleLimit.maxScaleLimit),y.ScaleLimit.minScaleLimit);var A=Math.round(y.ResizePCT.widthPCT*y.ResizeBasis.basisWidth/100),b=Math.round(y.ResizePCT.heightPCT*y.ResizeBasis.basisHeight/100);switch(s){case ot.LEFT_TOP:p=h-A,v=_-b;break;case ot.RIGHT_TOP:p=A-h,v=_-b;break;case ot.RIGHT_BOTTOM:p=A-h,v=b-_;break;case ot.LEFT_BOTTOM:p=h-A,v=b-_;break}return c}switch(s){case ot.LEFT_TOP:c.width=f?h:h-p*u,c.height=d?_:_-v*u;break;case ot.RIGHT_TOP:c.width=f?h:h+p*u,c.height=d?_:_-v*u;break;case ot.RIGHT_BOTTOM:c.width=f?h:h+p*u,c.height=d?_:_+v*u;break;case ot.LEFT_BOTTOM:c.width=f?h:h-p*u,c.height=d?_:_+v*u;break}return c},n.resizeNode=function(s){var l=s.deltaX,u=s.deltaY,f=n.index,d=n.props,c=d.model,p=d.graphModel,v=d.x,h=d.y;bx({x:v,y:h,deltaX:l,deltaY:u,index:f,nodeModel:c,graphModel:p,cancelCallback:function(){n.dragHandler.cancelDrag()}})},n.onDragStart=function(){n.graphModel.selectNodeById(n.nodeModel.id)},n.onDragging=function(s){var l=s.deltaX,u=s.deltaY,f=n.graphModel.transformModel,d=cx(f.fixDeltaXY(l,u),2),c=d[0],p=d[1];n.resizeNode({deltaX:c,deltaY:p})},n.onDragEnd=function(){var s=n.nodeModel.x,l=n.nodeModel.y;n.nodeModel.moveTo(s,l),n.updateEdgePointByAnchors()};var o=r.index,i=r.model,a=r.graphModel;return n.index=o,n.nodeModel=i,n.graphModel=a,n.dragHandler=new Ee({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:a.gridSize}),n}return t.prototype.componentWillUnmount=function(){this.dragHandler.destroy()},t.prototype.render=function(){var r=this.props,n=r.x,o=r.y,i=r.direction,a=r.model,s=a.getResizeControlStyle(),l=s.width,u=s.height,f=fx(s,["width","height"]);return w("g",{className:"lf-resize-control lf-resize-control-".concat(i),children:[w(ye,Mn({className:"lf-resize-control-content",x:n,y:o,width:l??7,height:u??7},f)),w(ye,{className:"lf-resize-control-content",x:n,y:o,width:25,height:25,fill:"transparent",stroke:"transparent",onMouseDown:this.dragHandler.handleMouseDown})]})},t}(W),hx=function(e){uf(t,e);function t(){return e.call(this)||this}return t.prototype.getResizeControl=function(){var r=this.props,n=r.model,o=r.graphModel,i=Bt(n),a=i.minX,s=i.minY,l=i.maxX,u=i.maxY,f=[{index:ot.LEFT_TOP,direction:"nw",x:a,y:s},{index:ot.RIGHT_TOP,direction:"ne",x:l,y:s},{index:ot.RIGHT_BOTTOM,direction:"se",x:l,y:u},{index:ot.LEFT_BOTTOM,direction:"sw",x:a,y:u}];return Pe(f,function(d){return w(px,Mn({},d,{model:n,graphModel:o}))})},t.prototype.getResizeOutline=function(){var r=this.props.model,n=r.x,o=r.y,i=r.width,a=r.height,s=r.getResizeOutlineStyle();return w(ye,Mn({},s,{x:n,y:o,width:i,height:a}))},t.prototype.render=function(){return w("g",{className:"lf-resize-control-group",children:[this.getResizeOutline(),this.getResizeControl()]})},t}(W);function vx(e,t){var r=e.x,n=e.y,o=t.x,i=t.y,a={x:r+(o-r)/2,y:n+(i-n)/2};return a}function tn(e,t,r){var n=yx(r),o=e.x-t.x,i=e.y-t.y,a=o*Math.cos(n)-i*Math.sin(n)+t.x,s=o*Math.sin(n)+i*Math.cos(n)+t.y;return{x:a,y:s}}function yx(e){return e*Math.PI/180}function gx(e){return e/Math.PI*180}function _x(e,t,r,n,o,i,a,s,l){s===void 0&&(s=!1),l===void 0&&(l=!1);var u=t.deltaX,f=t.deltaY,d=t.width,c=t.height,p=gx(r),v={x:n,y:o},h={x:i,y:a},_=tn(v,h,p),y={x:_.x+u,y:_.y+f},m=Ox(_,y,h,p,s,l,d,c),S=m.width,M=m.height,A=m.center;return t.width=S*e,t.height=M*e,t.deltaX=(A.x-h.x)*2,t.deltaY=(A.y-h.y)*2,t}var mx=function(e,t,r,n,o,i,a,s,l,u){r===void 0&&(r=1),n===void 0&&(n=!1),o===void 0&&(o=!1),i===void 0&&(i=0);var f=k(t),d=f.deltaX,c=f.deltaY,p=f.width,v=f.height,h=f.PCTResizeInfo;if(h){var _=4,y=0,m=0;switch(e){case ot.LEFT_TOP:m=(d*-1-c)/_;break;case ot.RIGHT_TOP:m=(d-c)/_;break;case ot.RIGHT_BOTTOM:m=(d+c)/_;break;case ot.LEFT_BOTTOM:m=(d*-1+c)/_;break}m!==0&&(y=Math.round(m/h.ResizeBasis.basisHeight*1e5)/1e3),h.ResizePCT.widthPCT=Math.max(Math.min(h.ResizePCT.widthPCT+y,h.ScaleLimit.maxScaleLimit),h.ScaleLimit.minScaleLimit),h.ResizePCT.heightPCT=Math.max(Math.min(h.ResizePCT.heightPCT+y,h.ScaleLimit.maxScaleLimit),h.ScaleLimit.minScaleLimit);var S=Math.round(h.ResizePCT.widthPCT*h.ResizeBasis.basisWidth/100),M=Math.round(h.ResizePCT.heightPCT*h.ResizeBasis.basisHeight/100);switch(e){case ot.LEFT_TOP:d=p-S,c=v-M;break;case ot.RIGHT_TOP:d=S-p,c=v-M;break;case ot.RIGHT_BOTTOM:d=S-p,c=M-v;break;case ot.LEFT_BOTTOM:d=p-S,c=M-v;break}return f}if(i%(2*Math.PI)!==0&&a!==void 0&&s!==void 0)return _x(r,f,i,a,s,l,u,n,o);switch(e){case ot.LEFT_TOP:f.width=n?p:p-d*r,f.height=o?v:v-c*r;break;case ot.RIGHT_TOP:f.width=n?p:p+d*r,f.height=o?v:v-c*r;break;case ot.RIGHT_BOTTOM:f.width=n?p:p+d*r,f.height=o?v:v+c*r;break;case ot.LEFT_BOTTOM:f.width=n?p:p-d*r,f.height=o?v:v+c*r;break}return f},xx=function(e,t){var r=e.id,n=e.anchors,o=t.getNodeEdges(r);ht(o,function(i){if(i.sourceNodeId===r){var a=sr(n,function(s){return s.id===i.sourceAnchorId});a&&i.updateStartPoint({x:a.x,y:a.y})}else if(i.targetNodeId===r){var a=sr(n,function(l){return l.id===i.targetAnchorId});a&&i.updateEndPoint({x:a.x,y:a.y})}})},Ex=function(e,t,r,n,o,i,a){a.eventCenter.emit(R.NODE_RESIZE,{preData:e,data:t,deltaX:r,deltaY:n,index:o,model:i})},bx=function(e){var t=e.x,r=e.y,n=e.deltaX,o=e.deltaY,i=e.index,a=e.nodeModel,s=e.graphModel,l=e.cancelCallback,u=a.r,f=a.rx,d=a.ry,c=a.width,p=a.height,v=a.PCTResizeInfo,h=a.minWidth,_=a.minHeight,y=a.maxWidth,m=a.maxHeight,S=a.rotate,M=a.x,A=a.y,b=h===y,g=_===m,x={width:u||f||c,height:u||d||p,deltaX:n,deltaY:o,PCTResizeInfo:v},T=u||f&&d?1/2:1,P=t,j=r,L=mx(i,x,T,b,g,S,P,j,M,A);if(L.width<h||L.width>y||L.height<_||L.height>m){l==null||l();return}(S%(2*Math.PI)==0||v||P===void 0||j===void 0)&&(L.deltaX=b?0:L.deltaX,L.deltaY=g?0:L.deltaY);var U=a.getData(),D=a.resize(L);U.x===D.x&&U.y===D.y||(xx(a,s),Ex(U,D,n,o,i,a,s))};function Ox(e,t,r,n,o,i,a,s){o===void 0&&(o=!1),i===void 0&&(i=!1);var l={x:r.x-(e.x-r.x),y:r.y-(e.y-r.y)},u=vx(l,t),f=tn(t,u,-n),d=tn(l,u,-n);if(o){var c=Math.abs(f.x-d.x),p=c-a;u.x>f.x?u.x=u.x+p/2:u.x=u.x-p/2}if(i){var v=Math.abs(f.y-d.y),h=v-s;u.y>f.y?u.y=u.y+h/2:u.y=u.y-h/2}if(o||i){var _=tn(d,u,n),y=_.x-l.x,m=_.y-l.y;u.x=u.x-y,u.y=u.y-m,d=tn(l,u,-n),f={x:u.x-(d.x-u.x),y:u.y-(d.y-u.y)}}var S=Math.abs(f.x-d.x),M=Math.abs(f.y-d.y);return o&&(S=a),i&&(M=s),{width:S,height:M,center:u}}var wx=100,Sx={x:1,y:0};function Mx(e,t,r,n,o){for(var i=function(p){if(p<0||p>1)throw new RangeError('The value range of parameter "t" is [0,1]');return{x:e.x*Math.pow(1-p,3)+3*t.x*p*Math.pow(1-p,2)+3*r.x*Math.pow(p,2)*(1-p)+n.x*Math.pow(p,3),y:e.y*Math.pow(1-p,3)+3*t.y*p*Math.pow(1-p,2)+3*r.y*Math.pow(p,2)*(1-p)+n.y*Math.pow(p,3)}},a=0,s=2,l=n.x,u=n.y,f=n;a<o&&s<50;){f=i(1-s/wx);var d=f.x,c=f.y;a=te(l,u,d,c),s++}return f}function Ax(e,t){return e.x*t.y-e.y*t.x}function Tx(e,t){var r=[e.x,e.y,e.z],n=[t.x,t.y,t.z];return n.reduce(function(o,i,a){return o+i*r[a]})}function Px(e,t){var r=Ax(e,t),n=Math.acos(Tx($l(e),$l(t)));return r>=0?n:-n}function $l(e){var t=Math.hypot(e.x,e.y);return{x:e.x/t,y:e.y/t,z:0}}function Dx(e){return Px(Sx,e)}function Nx(e){return e*(180/Math.PI)}var Cx={baseNode:{fill:"#fff",stroke:"#000",strokeWidth:2},baseEdge:{stroke:"#000",strokeWidth:2},rect:{},circle:{},diamond:{},ellipse:{},polygon:{},text:{color:"#000",stroke:"none",fontSize:12,background:{fill:"transparent"}},anchor:{stroke:"#000",fill:"#fff",r:4,hover:{r:10,fill:"#949494",fillOpacity:.5,stroke:"#949494"}},anchorLine:{stroke:"#000",strokeWidth:2,strokeDasharray:"3,2"},nodeText:{color:"#000",overflowMode:"default",fontSize:12,lineHeight:1.2},edgeText:{textWidth:100,overflowMode:"default",fontSize:12,background:{fill:"#fff"}},line:{},polyline:{},bezier:{fill:"none",adjustLine:{stroke:"#949494"},adjustAnchor:{r:4,fill:"#949494",fillOpacity:1,stroke:"#949494"}},arrow:{offset:10,verticalLength:5},snapline:{stroke:"#949494",strokeWidth:1},edgeAdjust:{r:4,fill:"#fff",stroke:"#949494",strokeWidth:2},outline:{fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},edgeAnimation:{stroke:"red",strokeDasharray:"10,10",strokeDashoffset:"100%",animationName:"lf_animate_dash",animationDuration:"20s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"normal"},rotateControl:{stroke:"#000",fill:"#fff",strokeWidth:1.5},resizeControl:{width:7,height:7,fill:"#fff",stroke:"#000"},resizeOutline:{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},df=function(e){var t=k(Cx);return e&&(t=Wa(t,e)),t},Rx=df,jx=1e3,Lx=999,Za=function(){return++jx},Ix=function(){return--Lx},yt=function(){return yt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},yt.apply(this,arguments)},I=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},ai=function(){function e(t,r){var n;this.BaseType=ct.EDGE,this.id="",this.type="",this.sourceNodeId="",this.targetNodeId="",this.textMode=Yt.TEXT,this.text={value:"",x:0,y:0,draggable:!1,editable:!0},this.points="",this.pointsList=[],this.virtual=!1,this.isSelected=!1,this.isHovered=!1,this.isHitable=!0,this.isHittable=!0,this.draggable=!0,this.visible=!0,this.isAnimation=!1,this.isShowAdjustPoint=!1,this.zIndex=0,this.state=J.DEFAULT,this.modelType=G.EDGE,this.customTextPosition=!1,this.style={},this.arrowConfig={markerEnd:"url(#marker-end-".concat(this.id,")"),markerStart:"url(#marker-start-".concat(this.id,")")},this.graphModel=r,this.properties=(n=t.properties)!==null&&n!==void 0?n:{},this.initEdgeData(t),this.setAttributes()}return e.prototype.initEdgeData=function(t){if(t.properties||(t.properties={}),!t.id){var r=this.graphModel.idGenerator,n=r&&r(t.type),o=this.createId();t.id=o||n||or()}this.arrowConfig.markerEnd="url(#marker-end-".concat(t.id,")"),this.arrowConfig.markerStart="url(#marker-start-".concat(t.id,")");var i=this.graphModel.editConfigModel.adjustEdgeStartAndEnd;this.isShowAdjustPoint=i,it(this,Bm(t));var a=this.graphModel.overlapMode;a===Jt.INCREASE&&(this.zIndex=t.zIndex||Za()),this.setAnchors(),this.initPoints(),this.formatText(t)},e.prototype.setAttributes=function(){},e.prototype.createId=function(){return null},e.prototype.getEdgeStyle=function(){return yt(yt({},this.graphModel.theme.baseEdge),this.style)},e.prototype.getAdjustPointStyle=function(){return yt({},this.graphModel.theme.edgeAdjust)},e.prototype.getTextStyle=function(){var t=this.graphModel.theme.edgeText;return k(t)},e.prototype.getEdgeAnimationStyle=function(){var t=this.graphModel.theme.edgeAnimation;return k(t)},e.prototype.getArrowStyle=function(){var t=this.getEdgeStyle(),r=this.getEdgeAnimationStyle(),n=this.graphModel.theme.arrow,o=this.isAnimation?r.stroke:t.stroke;return yt(yt(yt({},t),{fill:o,stroke:o}),n)},e.prototype.getOutlineStyle=function(){var t=this.graphModel,r=t.theme.outline;return k(r)},e.prototype.getTextPosition=function(){return{x:0,y:0}},Object.defineProperty(e.prototype,"sourceNode",{get:function(){var t,r;return(r=(t=this.graphModel)===null||t===void 0?void 0:t.nodesMap[this.sourceNodeId])===null||r===void 0?void 0:r.model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetNode",{get:function(){var t,r;return(r=(t=this.graphModel)===null||t===void 0?void 0:t.nodesMap[this.targetNodeId])===null||r===void 0?void 0:r.model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textPosition",{get:function(){return this.getTextPosition()},enumerable:!1,configurable:!0}),e.prototype.getBeginAnchor=function(t,r,n){var o,i,a=Ji(t);if(n){if(o=sr(a,function(s){return s.id===n}),o)return o;console.warn("".concat(n,""))}return a.forEach(function(s){var l=Dl(s,r);(i===void 0||l<i)&&(i=l,o=s)}),o},e.prototype.getEndAnchor=function(t,r){var n=this,o,i,a=Ji(t);if(r){if(o=sr(a,function(s){return s.id===r}),o)return o;console.warn("".concat(r,""))}return a.forEach(function(s){if(n.startPoint){var l=Dl(s,n.startPoint);(i===void 0||l<i)&&(i=l,o=s)}}),o},e.prototype.getProperties=function(){return ce(this.properties)},e.prototype.getData=function(){var t=this.properties;Cr(t)&&(t=ce(t));var r={id:this.id,type:this.type,properties:t,sourceNodeId:this.sourceNodeId,targetNodeId:this.targetNodeId,sourceAnchorId:this.sourceAnchorId,targetAnchorId:this.targetAnchorId,startPoint:it({},this.startPoint),endPoint:it({},this.endPoint)};this.graphModel.overlapMode===Jt.INCREASE&&(r.zIndex=this.zIndex);var n=this.text,o=n.x,i=n.y,a=n.value;return a&&(r.text={x:o,y:i,value:a}),r},e.prototype.getHistoryData=function(){return this.getData()},e.prototype.setProperty=function(t,r){Ra(this.properties,t,Mt(r)),this.setAttributes()},e.prototype.deleteProperty=function(t){delete this.properties[t],this.setAttributes()},e.prototype.setProperties=function(t){this.properties=yt(yt({},ce(this.properties)),Mt(t)),this.setAttributes()},e.prototype.changeEdgeId=function(t){var r=this.arrowConfig,n=r.markerEnd,o=r.markerStart;o&&o==="url(#marker-start-".concat(this.id,")")&&(this.arrowConfig.markerStart="url(#marker-start-".concat(t,")")),n&&n==="url(#marker-end-".concat(this.id,")")&&(this.arrowConfig.markerEnd="url(#marker-end-".concat(t,")")),this.id=t},e.prototype.setStyle=function(t,r){var n;this.style=yt(yt({},this.style),(n={},n[t]=Mt(r),n))},e.prototype.setStyles=function(t){this.style=yt(yt({},this.style),Mt(t))},e.prototype.updateStyles=function(t){this.style=yt({},Mt(t))},e.prototype.setTextMode=function(t){this.textMode=t},e.prototype.formatText=function(t){var r,n,o,i=this.graphModel.editConfigModel,a=i.edgeTextDraggable,s=i.edgeTextEdit,l=this.textPosition,u=l.x,f=l.y,d=t.text,c={value:"",x:u,y:f,draggable:a,editable:s};d&&(typeof d=="string"?c=yt(yt({},c),{value:d}):(c=yt(yt({},c),{x:(r=d.x)!==null&&r!==void 0?r:u,y:(n=d.y)!==null&&n!==void 0?n:f,value:(o=d.value)!==null&&o!==void 0?o:""}),Br(d.draggable)||(c.draggable=d.draggable),Br(d.editable)||(c.editable=d.editable))),this.text=c},e.prototype.resetTextPosition=function(){var t=this.textPosition,r=t.x,n=t.y;this.text.x=r,this.text.y=n},e.prototype.moveText=function(t,r){var n=this.text,o=n.x,i=n.y,a=n.value,s=n.draggable,l=n.editable;this.text={value:a,editable:l,draggable:s,x:o+t,y:i+r}},e.prototype.setText=function(t){t&&it(this.text,t)},e.prototype.updateText=function(t){this.text=yt(yt({},ce(this.text)),{value:t})},e.prototype.setAnchors=function(){if(!this.sourceAnchorId||!this.startPoint){var t=this.getBeginAnchor(this.sourceNode,this.targetNode,this.sourceAnchorId);if(!t)throw new Error("beginAnchoranchorsanchors");this.startPoint||(this.startPoint={x:t.x,y:t.y}),this.sourceAnchorId||(this.sourceAnchorId=t.id)}if(!this.targetAnchorId||!this.endPoint){var t=this.getEndAnchor(this.targetNode,this.targetAnchorId);if(!t)throw new Error("endAnchoranchorsanchors");this.endPoint||(this.endPoint={x:t.x,y:t.y}),this.targetAnchorId||(this.targetAnchorId=t.id)}},e.prototype.setSelected=function(t){t===void 0&&(t=!0),this.isSelected=t},e.prototype.setHovered=function(t){t===void 0&&(t=!0),this.isHovered=t},e.prototype.setHitable=function(t){t===void 0&&(t=!0),this.isHitable=t},e.prototype.setHittable=function(t){t===void 0&&(t=!0),this.isHittable=t},e.prototype.openEdgeAnimation=function(){this.isAnimation=!0},e.prototype.closeEdgeAnimation=function(){this.isAnimation=!1},e.prototype.setElementState=function(t,r){this.state=t,this.additionStateData=r},e.prototype.updateStartPoint=function(t){this.startPoint=t},e.prototype.moveStartPoint=function(t,r){this.startPoint&&(this.startPoint.x+=t,this.startPoint.y+=r)},e.prototype.updateEndPoint=function(t){this.endPoint=t},e.prototype.moveEndPoint=function(t,r){this.endPoint&&(this.endPoint.x+=t,this.endPoint.y+=r)},e.prototype.setZIndex=function(t){t===void 0&&(t=0),this.zIndex=t},e.prototype.initPoints=function(){},e.prototype.updateAttributes=function(t){it(this,t)},e.prototype.getAdjustStart=function(){return this.startPoint},e.prototype.getAdjustEnd=function(){return this.endPoint},e.prototype.updateAfterAdjustStartAndEnd=function(t){var r=t.startPoint,n=t.endPoint;this.updateStartPoint({x:r.x,y:r.y}),this.updateEndPoint({x:n.x,y:n.y})},e.BaseType=ct.EDGE,I([O],e.prototype,"type",void 0),I([O],e.prototype,"sourceNodeId",void 0),I([O],e.prototype,"targetNodeId",void 0),I([O],e.prototype,"startPoint",void 0),I([O],e.prototype,"endPoint",void 0),I([O],e.prototype,"textMode",void 0),I([O],e.prototype,"text",void 0),I([O],e.prototype,"properties",void 0),I([O],e.prototype,"points",void 0),I([O],e.prototype,"pointsList",void 0),I([O],e.prototype,"isSelected",void 0),I([O],e.prototype,"isHovered",void 0),I([O],e.prototype,"isHitable",void 0),I([O],e.prototype,"isHittable",void 0),I([O],e.prototype,"draggable",void 0),I([O],e.prototype,"visible",void 0),I([O],e.prototype,"isAnimation",void 0),I([O],e.prototype,"isShowAdjustPoint",void 0),I([O],e.prototype,"zIndex",void 0),I([O],e.prototype,"state",void 0),I([O],e.prototype,"style",void 0),I([O],e.prototype,"arrowConfig",void 0),I([at],e.prototype,"sourceNode",null),I([at],e.prototype,"targetNode",null),I([at],e.prototype,"textPosition",null),I([E],e.prototype,"setProperty",null),I([E],e.prototype,"deleteProperty",null),I([E],e.prototype,"setProperties",null),I([E],e.prototype,"changeEdgeId",null),I([E],e.prototype,"setStyle",null),I([E],e.prototype,"setStyles",null),I([E],e.prototype,"updateStyles",null),I([E],e.prototype,"setTextMode",null),I([E],e.prototype,"formatText",null),I([E],e.prototype,"resetTextPosition",null),I([E],e.prototype,"moveText",null),I([E],e.prototype,"setText",null),I([E],e.prototype,"updateText",null),I([E],e.prototype,"setAnchors",null),I([E],e.prototype,"setSelected",null),I([E],e.prototype,"setHovered",null),I([E],e.prototype,"setHitable",null),I([E],e.prototype,"setHittable",null),I([E],e.prototype,"openEdgeAnimation",null),I([E],e.prototype,"closeEdgeAnimation",null),I([E],e.prototype,"setElementState",null),I([E],e.prototype,"updateStartPoint",null),I([E],e.prototype,"moveStartPoint",null),I([E],e.prototype,"updateEndPoint",null),I([E],e.prototype,"moveEndPoint",null),I([E],e.prototype,"setZIndex",null),I([E],e.prototype,"initPoints",null),I([E],e.prototype,"updateAttributes",null),I([E],e.prototype,"getAdjustStart",null),I([E],e.prototype,"getAdjustEnd",null),I([E],e.prototype,"updateAfterAdjustStartAndEnd",null),e}(),Bx=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Je=function(){return Je=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Je.apply(this,arguments)},Xt=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},xi=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Xl=function(e){Bx(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.modelType=G.BEZIER_EDGE,o.path="",o.initEdgeData(r),o.setAttributes(),o}return t.prototype.initEdgeData=function(r){this.offset=In(r,"properties.offset",100),e.prototype.initEdgeData.call(this,r)},t.prototype.getEdgeStyle=function(){var r=this.graphModel.theme.bezier,n=e.prototype.getEdgeStyle.call(this),o=this.properties.style,i=o===void 0?{}:o;return Je(Je(Je({},n),k(r)),k(i))},t.prototype.getTextPosition=function(){if(this.pointsList&&this.pointsList.length>0){var r=0,n=0;return this.pointsList.forEach(function(o){var i=o.x,a=o.y;r+=i,n+=a}),{x:r/this.pointsList.length,y:n/this.pointsList.length}}return{x:(this.startPoint.x+this.endPoint.x)/2,y:(this.startPoint.y+this.endPoint.y)/2}},t.prototype.getData=function(){var r=e.prototype.getData.call(this),n=this.pointsList.map(function(o){var i=o.x,a=o.y;return{x:i,y:a}});return Je(Je({},r),{pointsList:n})},t.prototype.getControls=function(){var r=this.startPoint,n=this.endPoint,o=Tl({start:r,end:n,sourceNode:this.sourceNode,targetNode:this.targetNode,offset:this.offset});return o},t.prototype.getPath=function(r){var n=xi(r,4),o=n[0],i=n[1],a=n[2],s=n[3];return"M ".concat(o.x," ").concat(o.y,`
    C `).concat(i.x," ").concat(i.y,`,
    `).concat(a.x," ").concat(a.y,`,
    `).concat(s.x," ").concat(s.y)},t.prototype.initPoints=function(){this.pointsList.length>0?this.path=this.getPath(this.pointsList):this.updatePoints()},t.prototype.updatePoints=function(){var r=this.getControls(),n=r.sNext,o=r.ePre;this.updatePath(n,o)},t.prototype.updatePath=function(r,n){r=k(r),n=k(n);var o={x:this.startPoint.x,y:this.startPoint.y},i={x:this.endPoint.x,y:this.endPoint.y};if(!r||!n){var a=this.getControls();r=a.sNext,n=a.ePre}this.pointsList=[o,r,n,i],this.path=this.getPath(this.pointsList)},t.prototype.updateStartPoint=function(r){this.startPoint=Object.assign({},r),this.updatePoints()},t.prototype.updateEndPoint=function(r){this.endPoint=Object.assign({},r),this.updatePoints()},t.prototype.moveStartPoint=function(r,n){this.startPoint.x+=r,this.startPoint.y+=n;var o=xi(this.pointsList,3),i=o[1],a=o[2];i.x+=r,i.y+=n,this.updatePath(i,a)},t.prototype.moveEndPoint=function(r,n){this.endPoint.x+=r,this.endPoint.y+=n;var o=xi(this.pointsList,3),i=o[1],a=o[2];a.x+=r,a.y+=n,this.updatePath(i,a)},t.prototype.updateAdjustAnchor=function(r,n){var o;n==="sNext"?this.pointsList[1]=r:n==="ePre"&&(this.pointsList[2]=r),this.path=this.getPath(this.pointsList),!((o=this.text)===null||o===void 0)&&o.value&&this.setText(it({},this.text,this.textPosition))},t.prototype.getAdjustStart=function(){return this.pointsList[0]||this.startPoint},t.prototype.getAdjustEnd=function(){var r=this.pointsList;return r[r.length-1]||this.endPoint},t.prototype.updateAfterAdjustStartAndEnd=function(r){var n=r.startPoint,o=r.endPoint,i=r.sourceNode,a=r.targetNode,s=Tl({start:n,end:o,sourceNode:i,targetNode:a,offset:this.offset}),l=s.sNext,u=s.ePre;this.pointsList=[n,l,u,o],this.initPoints()},Xt([O],t.prototype,"offset",void 0),Xt([O],t.prototype,"path",void 0),Xt([E],t.prototype,"initPoints",null),Xt([E],t.prototype,"updatePoints",null),Xt([E],t.prototype,"updateStartPoint",null),Xt([E],t.prototype,"updateEndPoint",null),Xt([E],t.prototype,"moveStartPoint",null),Xt([E],t.prototype,"moveEndPoint",null),Xt([E],t.prototype,"updateAdjustAnchor",null),Xt([E],t.prototype,"getAdjustStart",null),Xt([E],t.prototype,"getAdjustEnd",null),Xt([E],t.prototype,"updateAfterAdjustStartAndEnd",null),t}(ai),$x=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),an=function(){return an=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},an.apply(this,arguments)},Fl=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Xx=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},kl=function(e){$x(t,e);function t(){var r=e.apply(this,Xx([],Fl(arguments),!1))||this;return r.modelType=G.LINE_EDGE,r}return t.prototype.getEdgeStyle=function(){var r=this.graphModel.theme.line,n=e.prototype.getEdgeStyle.call(this),o=this.properties.style,i=o===void 0?{}:o;return an(an(an({},n),k(r)),k(i))},t.prototype.initEdgeData=function(r){e.prototype.initEdgeData.call(this,r),this.points=this.getPath([this.startPoint,this.endPoint])},t.prototype.getPath=function(r){var n=Fl(r,2),o=n[0],i=n[1];return"".concat(o.x,",").concat(o.y," ").concat(i.x,",").concat(i.y)},t.prototype.getTextPosition=function(){return{x:(this.startPoint.x+this.endPoint.x)/2,y:(this.startPoint.y+this.endPoint.y)/2}},t}(ai),Fx=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),sn=function(){return sn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},sn.apply(this,arguments)},bt=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Hl=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},kx=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},Yl=function(e){Fx(t,e);function t(){var r=e.apply(this,kx([],Hl(arguments),!1))||this;return r.modelType=G.POLYLINE_EDGE,r.draggingPointList=[],r}return t.prototype.initEdgeData=function(r){this.offset=In(r,"properties.offset",30),r.pointsList&&(this.pointsList=r.pointsList),e.prototype.initEdgeData.call(this,r)},t.prototype.getEdgeStyle=function(){var r=this.graphModel.theme.polyline,n=e.prototype.getEdgeStyle.call(this),o=this.properties.style,i=o===void 0?{}:o;return sn(sn(sn({},n),k(r)),k(i))},t.prototype.getTextPosition=function(){var r,n=(r=this.text)===null||r===void 0?void 0:r.value;if(this.dbClickPosition&&!n){var o=this.dbClickPosition,i=o.x,a=o.y;return{x:i,y:a}}var s=lr(this.points),l=Hl(jm(s),2),u=l[0],f=l[1];return{x:(u.x+f.x)/2,y:(u.y+f.y)/2}},t.prototype.getAfterAnchor=function(r,n,o){var i,a;return o.forEach(function(s){var l;r===ut.HORIZONTAL?l=Math.abs(n.y-s.y):r===ut.VERTICAL&&(l=Math.abs(n.x-s.x)),(!a||a>l)&&(a=l,i=s)}),i},t.prototype.getCrossPoint=function(r,n,o){var i;return r===ut.HORIZONTAL?i={x:o.x,y:n.y}:r===ut.VERTICAL&&(i={x:n.x,y:o.y}),i},t.prototype.removeCrossPoints=function(r,n,o){var i=o.map(function(y){return y});if(r===1){var a=i[r],s=i[n],l=i[r-1],u=wl(l,a,this.sourceNode);if(u){var f=Sl(a,s,this.sourceNode);if(f){var d=Ml(a,s,this.sourceNode);d&&(i[r]=d,i.splice(r-1,1),r--,n--)}}else{var c=this.sourceNode.anchors;c.forEach(function(y){if(y.x===l.x&&y.x===a.x||y.y===l.y&&y.y===a.y){var m=te(y.x,y.y,a.x,a.y),S=te(l.x,l.y,a.x,a.y);m<S&&(i[r-1]=y)}})}}if(n===o.length-2){var p=i[r],v=i[n],h=i[n+1],_=wl(v,h,this.targetNode);if(_){var f=Sl(p,v,this.targetNode);if(f){var d=Ml(p,v,this.targetNode);d&&(i[n]=d,i.splice(n+1,1))}}else{var c=this.targetNode.anchors;c.forEach(function(m){if(m.x===h.x&&m.x===v.x||m.y===h.y&&m.y===v.y){var S=te(m.x,m.y,v.x,v.y),M=te(h.x,h.y,v.x,v.y);S<M&&(i[n+1]=m)}})}}return i},t.prototype.getDraggingPoints=function(r,n,o,i,a){var s=a.map(function(f){return f}),l=this.getAfterAnchor(r,o,i),u=this.getCrossPoint(r,o,l);return n==="start"?(s.unshift(u),s.unshift(l)):(s.push(u),s.push(l)),s},t.prototype.updateCrossPoints=function(r){var n=r.map(function(m){return m}),o=r[0],i=r[1],a=r[n.length-2],s=r[n.length-1],l=this,u=l.sourceNode,f=l.targetNode,d=u.modelType,c=f.modelType,p=Do(o,i),v=n[0];switch(d){case G.RECT_NODE:if(u.radius!==0){var h=Rl(o,u);h||(v=Cl(o,p,u))}break;case G.CIRCLE_NODE:v=Qi(o,p,u);break;case G.ELLIPSE_NODE:v=jl(o,p,u);break;case G.DIAMOND_NODE:v=Kn(o,p,u);break;case G.POLYGON_NODE:v=Kn(o,p,u);break}v&&(n[0]=v);var _=Do(a,s),y=n[n.length-1];switch(c){case G.RECT_NODE:if(f.radius!==0){var h=Rl(s,f);h||(y=Cl(s,_,f))}break;case G.CIRCLE_NODE:y=Qi(s,_,f);break;case G.ELLIPSE_NODE:y=jl(s,_,f);break;case G.DIAMOND_NODE:y=Kn(s,_,f);break;case G.POLYGON_NODE:y=Kn(s,_,f);break}return y&&(n[n.length-1]=y),n},t.prototype.updatePath=function(r){this.pointsList=r,this.points=this.getPath(this.pointsList)},t.prototype.getData=function(){var r=e.prototype.getData.call(this),n=this.pointsList.map(function(o){var i=o.x,a=o.y;return{x:i,y:a}});return Object.assign({},r,{pointsList:n})},t.prototype.getPath=function(r){return r.map(function(n){return"".concat(n.x,",").concat(n.y)}).join(" ")},t.prototype.initPoints=function(){this.pointsList.length>0?this.points=this.getPath(this.pointsList):this.updatePoints()},t.prototype.updatePoints=function(){var r=Ol({x:this.startPoint.x,y:this.startPoint.y},{x:this.endPoint.x,y:this.endPoint.y},this.sourceNode,this.targetNode,this.offset||0);this.pointsList=r,this.points=r.map(function(n){return"".concat(n.x,",").concat(n.y)}).join(" ")},t.prototype.updateStartPoint=function(r){this.startPoint=Object.assign({},r),this.updatePoints()},t.prototype.moveStartPoint=function(r,n){this.startPoint.x+=r,this.startPoint.y+=n,this.updatePoints()},t.prototype.updateEndPoint=function(r){this.endPoint=Object.assign({},r),this.updatePoints()},t.prototype.moveEndPoint=function(r,n){this.endPoint.x+=r,this.endPoint.y+=n,this.updatePoints()},t.prototype.updatePointsList=function(r,n){this.pointsList.forEach(function(a){a.x+=r,a.y+=n});var o=this.pointsList[0];this.startPoint=Object.assign({},o);var i=this.pointsList[this.pointsList.length-1];this.endPoint=Object.assign({},i),this.initPoints()},t.prototype.dragAppendStart=function(){this.draggingPointList=this.pointsList.map(function(r){return r})},t.prototype.dragAppendSimple=function(r,n){var o;this.isDragging=!0;var i=r.start,a=r.end,s=r.startIndex,l=r.endIndex,u=r.direction,f=this.pointsList,d=f;return u===ut.HORIZONTAL?(f[s]={x:i.x,y:i.y+n.y},f[l]={x:a.x,y:a.y+n.y},d=this.pointsList.map(function(c){return c})):u===ut.VERTICAL&&(f[s]={x:i.x+n.x,y:i.y},f[l]={x:a.x+n.x,y:a.y},d=this.pointsList.map(function(c){return c})),this.updatePointsAfterDrag(d),this.draggingPointList=d,!((o=this.text)===null||o===void 0)&&o.value&&this.setText(it({},this.text,this.textPosition)),{start:it({},f[s]),end:it({},f[l]),startIndex:s,endIndex:l,direction:u}},t.prototype.dragAppend=function(r,n){var o;this.isDragging=!0;var i=r.start,a=r.end,s=r.startIndex,l=r.endIndex,u=r.direction,f=this.pointsList;if(u===ut.HORIZONTAL){f[s]={x:i.x,y:i.y+n.y},f[l]={x:a.x,y:a.y+n.y};var d=this.pointsList.map(function(_){return _});if(s!==0&&l!==this.pointsList.length-1&&(d=this.removeCrossPoints(s,l,d)),s===0){var c={x:i.x,y:i.y+n.y},p=Te(c,this.sourceNode);if(!p){var v=this.sourceNode.anchors;d=this.getDraggingPoints(u,"start",c,v,d)}}if(l===this.pointsList.length-1){var h={x:a.x,y:a.y+n.y},p=Te(h,this.targetNode);if(!p){var v=this.targetNode.anchors;d=this.getDraggingPoints(u,"end",h,v,d)}}this.updatePointsAfterDrag(d),this.draggingPointList=d}else if(u===ut.VERTICAL){f[s]={x:i.x+n.x,y:i.y},f[l]={x:a.x+n.x,y:a.y};var d=this.pointsList.map(function(y){return y});if(s!==0&&l!==this.pointsList.length-1&&(d=this.removeCrossPoints(s,l,d)),s===0){var c={x:i.x+n.x,y:i.y},p=Te(c,this.sourceNode);if(!p){var v=this.sourceNode.anchors;d=this.getDraggingPoints(u,"start",c,v,d)}}if(l===this.pointsList.length-1){var h={x:a.x+n.x,y:a.y},p=Te(h,this.targetNode);if(!p){var v=this.targetNode.anchors;d=this.getDraggingPoints(u,"end",h,v,d)}}this.updatePointsAfterDrag(d),this.draggingPointList=d}return!((o=this.text)===null||o===void 0)&&o.value&&this.setText(it({},this.text,this.textPosition)),{start:it({},f[s]),end:it({},f[l]),startIndex:s,endIndex:l,direction:u}},t.prototype.dragAppendEnd=function(){if(this.draggingPointList){var r=Qd(lr(this.points));this.pointsList=r.map(function(i){return i}),this.draggingPointList=[];var n=r[0];this.startPoint=it({},n);var o=r[r.length-1];this.endPoint=it({},o)}this.isDragging=!1},t.prototype.updatePointsAfterDrag=function(r){var n=this.updateCrossPoints(r);this.points=n.map(function(o){return"".concat(o.x,",").concat(o.y)}).join(" ")},t.prototype.getAdjustStart=function(){return this.pointsList[0]||this.startPoint},t.prototype.getAdjustEnd=function(){var r=this.pointsList;return r[r.length-1]||this.endPoint},t.prototype.updateAfterAdjustStartAndEnd=function(r){var n=r.startPoint,o=r.endPoint,i=r.sourceNode,a=r.targetNode;this.pointsList=Ol({x:n.x,y:n.y},{x:o.x,y:o.y},i,a,this.offset||0),this.initPoints()},bt([O],t.prototype,"offset",void 0),bt([O],t.prototype,"dbClickPosition",void 0),bt([E],t.prototype,"initPoints",null),bt([E],t.prototype,"updatePoints",null),bt([E],t.prototype,"updateStartPoint",null),bt([E],t.prototype,"moveStartPoint",null),bt([E],t.prototype,"updateEndPoint",null),bt([E],t.prototype,"moveEndPoint",null),bt([E],t.prototype,"updatePointsList",null),bt([E],t.prototype,"dragAppendStart",null),bt([E],t.prototype,"dragAppendSimple",null),bt([E],t.prototype,"dragAppend",null),bt([E],t.prototype,"dragAppendEnd",null),bt([E],t.prototype,"updatePointsAfterDrag",null),bt([E],t.prototype,"getAdjustStart",null),bt([E],t.prototype,"getAdjustEnd",null),bt([E],t.prototype,"updateAfterAdjustStartAndEnd",null),t}(ai),_t=function(){return _t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},_t.apply(this,arguments)},B=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Gl=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Hx=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Ve=function(){function e(t,r){var n;this.BaseType=ct.NODE,this.id="",this.type="",this.x=0,this.y=0,this.textMode=Yt.TEXT,this.text={value:"",x:0,y:0,draggable:!1,editable:!0},this._width=100,this._height=80,this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3,this.anchorsOffset=[],this.virtual=!1,this.isSelected=!1,this.isHovered=!1,this.isShowAnchor=!1,this.isDragging=!1,this.isHitable=!0,this.isHittable=!0,this.draggable=!0,this.visible=!0,this.rotatable=!0,this.resizable=!0,this.zIndex=1,this.state=J.DEFAULT,this.autoToFront=!0,this.style={},this._rotate=0,this.modelType=G.NODE,this.additionStateData={},this.targetRules=[],this.sourceRules=[],this.moveRules=[],this.resizeRules=[],this.hasSetTargetRules=!1,this.hasSetSourceRules=!1,this.graphModel=r,this.properties=(n=t.properties)!==null&&n!==void 0?n:{},this.initNodeData(t),this.setAttributes()}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t;var r=this,n=r.x,o=n===void 0?0:n,i=r.y,a=i===void 0?0:i;this.transform=new No(-o,-a).rotate(t).translate(o,a).toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"incoming",{get:function(){return{nodes:this.graphModel.getNodeIncomingNode(this.id),edges:this.graphModel.getNodeIncomingEdge(this.id)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"outgoing",{get:function(){return{nodes:this.graphModel.getNodeOutgoingNode(this.id),edges:this.graphModel.getNodeOutgoingEdge(this.id)}},enumerable:!1,configurable:!0}),e.prototype.initNodeData=function(t){if(t.properties||(t.properties={}),!t.id){var r=this.graphModel.idGenerator,n=r&&r(t.type),o=this.createId();t.id=o||n||or()}this.formatText(t),it(this,Vm(t));var i=this.graphModel.overlapMode;i===Jt.INCREASE&&(this.zIndex=t.zIndex||Za())},e.prototype.setAttributes=function(){},e.prototype.createId=function(){return null},e.prototype.setTextMode=function(t){this.textMode=t},e.prototype.formatText=function(t){var r,n,o,i=this.graphModel.editConfigModel,a=i.nodeTextDraggable,s=i.nodeTextEdit,l=t.x,u=t.y,f=t.text,d={value:"",x:l,y:u,draggable:a,editable:s};f&&(typeof f=="string"?d.value=f:(d=_t(_t({},d),{x:(r=f.x)!==null&&r!==void 0?r:l,y:(n=f.y)!==null&&n!==void 0?n:u,value:(o=f.value)!==null&&o!==void 0?o:""}),Br(f.draggable)||(d.draggable=f.draggable),Br(f.editable)||(d.editable=f.editable))),t.text=d},e.prototype.resize=function(t){var r=t.width,n=t.height,o=t.deltaX,i=t.deltaY,a=this.isAllowResizeNode(o,i,r,n);return a?(this.move(o/2,i/2),this.width=r,this.height=n,this.setProperties({width:r,height:n}),this.getData()):this.getData()},e.prototype.proportionalResize=function(){},e.prototype.getData=function(){var t=this.text,r=t.x,n=t.y,o=t.value,i=this.properties;Cr(i)&&(i=ce(i)),Qt(i.width)&&(i.width=this.width),Qt(i.height)&&(i.height=this.height);var a={id:this.id,type:this.type,x:this.x,y:this.y,properties:i};return this.rotate&&(a.rotate=this.rotate),this.graphModel.overlapMode===Jt.INCREASE&&(a.zIndex=this.zIndex),o&&(a.text={x:r,y:n,value:o}),a},e.prototype.getHistoryData=function(){return this.getData()},e.prototype.getProperties=function(){return ce(this.properties)},e.prototype.getOuterGAttributes=function(){return{className:""}},e.prototype.getNodeStyle=function(){return _t(_t({},this.graphModel.theme.baseNode),this.style)},e.prototype.getTextStyle=function(){var t=this.graphModel.theme.nodeText,r=this.properties.textStyle,n=r===void 0?{}:r;return _t(_t({},k(t)),k(n))},e.prototype.getRotateControlStyle=function(){var t=this.graphModel.theme.rotateControl;return k(t)},e.prototype.getResizeControlStyle=function(){var t=this.graphModel.theme.resizeControl;return k(t)},e.prototype.getResizeOutlineStyle=function(){var t=this.graphModel.theme.resizeOutline;return k(t)},e.prototype.getAnchorStyle=function(t){var r=this.graphModel.theme.anchor;return k(r)},e.prototype.getAnchorLineStyle=function(t){var r=this.graphModel.theme.anchorLine;return k(r)},e.prototype.getOutlineStyle=function(){var t=this.graphModel.theme.outline;return k(t)},e.prototype.isAllowConnectedAsSource=function(t,r,n,o){var i=this.hasSetSourceRules?this.sourceRules:this.getConnectedSourceRules();this.hasSetSourceRules=!0;for(var a=!0,s="",l=0;l<i.length;l++){var u=i[l];if(!u.validate.call(this,this,t,r,n,o)){a=!1,s=u.message;break}}return{isAllPass:a,msg:s}},e.prototype.getConnectedSourceRules=function(){return this.sourceRules},e.prototype.isAllowConnectedAsTarget=function(t,r,n,o){var i=this.hasSetTargetRules?this.targetRules:this.getConnectedTargetRules();this.hasSetTargetRules=!0;for(var a=!0,s="",l=0;l<i.length;l++){var u=i[l];if(!u.validate.call(this,t,this,r,n,o)){a=!1,s=u.message;break}}return{isAllPass:a,msg:s}},e.prototype.isAllowMoveNode=function(t,r){var n,o,i=!0,a=!0,s=this.moveRules.concat(this.graphModel.nodeMoveRules);try{for(var l=Gl(s),u=l.next();!u.done;u=l.next()){var f=u.value,d=f(this,t,r);if(!d)return!1;if(typeof d=="object"){var c=d;if(!c.x&&!c.y)return!1;i=i&&c.x,a=a&&c.y}}}catch(p){n={error:p}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return{x:i,y:a}},e.prototype.getConnectedTargetRules=function(){return this.targetRules},e.prototype.getAnchorsByOffset=function(){var t=this,r=t.anchorsOffset,n=t.id,o=t.x,i=t.y;return r&&r.length>0?r.map(function(a,s){return a.length?(a=a,{id:"".concat(n,"_").concat(s),x:o+a[0],y:i+a[1]}):(a=a,_t(_t({},a),{x:o+a.x,y:i+a.y,id:a.id||"".concat(n,"_").concat(s)}))}):this.getDefaultAnchor()},e.prototype.getDefaultAnchor=function(){return[]},e.prototype.getTargetAnchor=function(t){return Um(t,this)},e.prototype.getBounds=function(){return{minX:this.x-this.width/2,minY:this.y-this.height/2,maxX:this.x+this.width/2,maxY:this.y+this.height/2}},Object.defineProperty(e.prototype,"anchors",{get:function(){var t=this.getAnchorsByOffset(),r=this,n=r.x,o=r.y,i=r.rotate;return t.forEach(function(a){var s=a.x,l=a.y,u=Hx(new $n([s,l,1]).translate(-n,-o).rotate(i).translate(n,o)[0],2),f=u[0],d=u[1];a.x=f,a.y=d}),t},enumerable:!1,configurable:!0}),e.prototype.getAnchorInfo=function(t){if(!Qt(t))for(var r=0;r<this.anchors.length;r++){var n=this.anchors[r];if(n.id===t)return n}},e.prototype.addNodeMoveRules=function(t){this.moveRules.includes(t)||this.moveRules.push(t)},e.prototype.isAllowMoveByXORY=function(t,r,n){var o,i;if(n)o=!0,i=!0;else{var a=this.isAllowMoveNode(t,r);typeof a=="boolean"?(o=a,i=a):(o=a.x,i=a.y)}return{isAllowMoveX:o,isAllowMoveY:i}},e.prototype.move=function(t,r,n){n===void 0&&(n=!1);var o=this.isAllowMoveByXORY(t,r,n),i=o.isAllowMoveX,a=o.isAllowMoveY;return i&&(this.x=this.x+t,this.text&&this.moveText(t,0)),a&&(this.y=this.y+r,this.text&&this.moveText(0,r)),(i||a)&&(this.rotate=this._rotate),i||a},e.prototype.getMoveDistance=function(t,r,n){n===void 0&&(n=!1);var o=this.isAllowMoveByXORY(t,r,n),i=o.isAllowMoveX,a=o.isAllowMoveY,s=0,l=0;return i&&t&&(this.x=this.x+t,this.text&&this.moveText(t,0),s=t),a&&r&&(this.y=this.y+r,this.text&&this.moveText(0,r),l=r),this.transform=new No(-this.x,-this.y).rotate(this.rotate).translate(this.x,this.y).toString(),[s,l]},e.prototype.moveTo=function(t,r,n){n===void 0&&(n=!1);var o=t-this.x,i=r-this.y;return!n&&!this.isAllowMoveNode(o,i)?!1:(this.text&&this.moveText(o,i),this.x=t,this.y=r,!0)},e.prototype.moveText=function(t,r){var n=this.text,o=n.x,i=n.y,a=n.value,s=n.draggable,l=n.editable;this.text={value:a,editable:l,draggable:s,x:o+t,y:i+r}},e.prototype.updateText=function(t){this.text=_t(_t({},ce(this.text)),{value:t})},e.prototype.addNodeResizeRules=function(t){this.resizeRules.includes(t)||this.resizeRules.push(t)},e.prototype.isAllowResizeNode=function(t,r,n,o){var i,a,s=this.resizeRules.concat(this.graphModel.nodeResizeRules);try{for(var l=Gl(s),u=l.next();!u.done;u=l.next()){var f=u.value,d=f(this,t,r,n,o);if(!d)return!1}}catch(c){i={error:c}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return!0},e.prototype.setSelected=function(t){t===void 0&&(t=!0),this.isSelected=t},e.prototype.setHovered=function(t){t===void 0&&(t=!0),this.isHovered=t,this.setIsShowAnchor(t)},e.prototype.setIsShowAnchor=function(t){t===void 0&&(t=!0),this.isShowAnchor=t},e.prototype.setRotatable=function(t){t===void 0&&(t=!0),this.rotatable=t},e.prototype.setResizable=function(t){t===void 0&&(t=!0),this.resizable=t},e.prototype.setHitable=function(t){t===void 0&&(t=!0),this.isHitable=t},e.prototype.setHittable=function(t){t===void 0&&(t=!0),this.isHittable=t},e.prototype.setElementState=function(t,r){this.state=t,this.additionStateData=r},e.prototype.updateProperties=function(t,r){var n=ce(this.properties);this.properties=t,this.setAttributes(),this.graphModel.eventCenter.emit(R.NODE_PROPERTIES_CHANGE,{id:this.id,keys:r,preProperties:n,properties:t})},e.prototype.setProperty=function(t,r){var n=ce(this.properties),o=k(n);um(o,t,Mt(r)),this.updateProperties(o,[t])},e.prototype.setProperties=function(t){var r=ce(this.properties),n=_t(_t({},r),Mt(t)),o=[];om(t,function(i,a){(vl(r,a)&&r[a]!==i||!vl(r,a))&&o.push(a)}),this.updateProperties(n,o)},e.prototype.deleteProperty=function(t){delete this.properties[t],this.setAttributes()},e.prototype.setStyle=function(t,r){var n;this.style=_t(_t({},this.style),(n={},n[t]=Mt(r),n))},e.prototype.setStyles=function(t){this.style=_t(_t({},this.style),Mt(t))},e.prototype.updateStyles=function(t){this.style=_t({},Mt(t))},e.prototype.setZIndex=function(t){t===void 0&&(t=1),this.zIndex=t},e.prototype.updateAttributes=function(t){it(this,t)},e.BaseType=ct.NODE,B([O],e.prototype,"type",void 0),B([O],e.prototype,"x",void 0),B([O],e.prototype,"y",void 0),B([O],e.prototype,"textMode",void 0),B([O],e.prototype,"text",void 0),B([O],e.prototype,"properties",void 0),B([O],e.prototype,"_width",void 0),B([O],e.prototype,"_height",void 0),B([O],e.prototype,"anchorsOffset",void 0),B([O],e.prototype,"isSelected",void 0),B([O],e.prototype,"isHovered",void 0),B([O],e.prototype,"isShowAnchor",void 0),B([O],e.prototype,"isDragging",void 0),B([O],e.prototype,"isHitable",void 0),B([O],e.prototype,"isHittable",void 0),B([O],e.prototype,"draggable",void 0),B([O],e.prototype,"visible",void 0),B([O],e.prototype,"rotatable",void 0),B([O],e.prototype,"resizable",void 0),B([O],e.prototype,"zIndex",void 0),B([O],e.prototype,"state",void 0),B([O],e.prototype,"autoToFront",void 0),B([O],e.prototype,"style",void 0),B([O],e.prototype,"transform",void 0),B([O],e.prototype,"_rotate",void 0),B([at],e.prototype,"incoming",null),B([at],e.prototype,"outgoing",null),B([E],e.prototype,"setTextMode",null),B([E],e.prototype,"addNodeMoveRules",null),B([E],e.prototype,"move",null),B([E],e.prototype,"getMoveDistance",null),B([E],e.prototype,"moveTo",null),B([E],e.prototype,"moveText",null),B([E],e.prototype,"updateText",null),B([E],e.prototype,"addNodeResizeRules",null),B([E],e.prototype,"setSelected",null),B([E],e.prototype,"setHovered",null),B([E],e.prototype,"setIsShowAnchor",null),B([E],e.prototype,"setRotatable",null),B([E],e.prototype,"setResizable",null),B([E],e.prototype,"setHitable",null),B([E],e.prototype,"setHittable",null),B([E],e.prototype,"setElementState",null),B([E],e.prototype,"setProperty",null),B([E],e.prototype,"setProperties",null),B([E],e.prototype,"deleteProperty",null),B([E],e.prototype,"setStyle",null),B([E],e.prototype,"setStyles",null),B([E],e.prototype,"updateStyles",null),B([E],e.prototype,"setZIndex",null),B([E],e.prototype,"updateAttributes",null),e}(),Yx=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ln=function(){return ln=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ln.apply(this,arguments)},Ei=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Ul=function(e){Yx(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.modelType=G.CIRCLE_NODE,o.r=50,o.initNodeData(r),o.setAttributes(),o}return Object.defineProperty(t.prototype,"width",{get:function(){return this.r*2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.r*2},enumerable:!1,configurable:!0}),t.prototype.setAttributes=function(){e.prototype.setAttributes.call(this);var r=this.properties.r;r&&(this.r=r)},t.prototype.getNodeStyle=function(){var r=e.prototype.getNodeStyle.call(this),n=this.graphModel.theme.circle,o=this.properties.style,i=o===void 0?{}:o;return ln(ln(ln({},r),k(n)),k(i))},t.prototype.getDefaultAnchor=function(){var r=this,n=r.x,o=r.y,i=r.r;return[{x:n,y:o-i,id:"".concat(this.id,"_0")},{x:n+i,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+i,id:"".concat(this.id,"_2")},{x:n-i,y:o,id:"".concat(this.id,"_3")}]},t.prototype.resize=function(r){var n=r.width,o=r.deltaX,i=r.deltaY;return this.move(o/2,i/2),this.r=n,this.setProperties({r:n}),this.getData()},Ei([O],t.prototype,"r",void 0),Ei([at],t.prototype,"width",null),Ei([at],t.prototype,"height",null),t}(Ve),Gx=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),un=function(){return un=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},un.apply(this,arguments)},hr=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},qn=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},zl=function(e){Gx(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.modelType=G.DIAMOND_NODE,o.rx=30,o.ry=50,o.initNodeData(r),o.setAttributes(),o}return t.prototype.setAttributes=function(){e.prototype.setAttributes.call(this);var r=this.properties,n=r.rx,o=r.ry;n&&(this.rx=n),o&&(this.ry=o)},t.prototype.getNodeStyle=function(){var r=e.prototype.getNodeStyle.call(this),n=this.graphModel.theme.diamond,o=this.properties.style,i=o===void 0?{}:o;return un(un(un({},r),k(n)),k(i))},Object.defineProperty(t.prototype,"points",{get:function(){var r=this,n=r.x,o=r.y,i=r.rx,a=r.ry;return[[n,o-a],[n+i,o],[n,o+a],[n-i,o]]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointsPosition",{get:function(){return Pe(this.points,function(r){var n=qn(r,2),o=n[0],i=n[1];return{x:o,y:i}})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var r=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return ht(this.points,function(o){var i=qn(o,1),a=i[0];a<r&&(r=a),a>n&&(n=a)}),n-r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var r=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return ht(this.points,function(o){var i=qn(o,2),a=i[1];a<r&&(r=a),a>n&&(n=a)}),n-r},enumerable:!1,configurable:!0}),t.prototype.getDefaultAnchor=function(){var r=this;return Pe(this.points,function(n,o){var i=qn(n,2),a=i[0],s=i[1];return{x:a,y:s,id:"".concat(r.id,"_").concat(o)}})},t.prototype.resize=function(r){var n=r.width,o=r.height,i=r.deltaX,a=r.deltaY;return this.move(i/2,a/2),this.rx=n,this.ry=o,this.setProperties({rx:n,ry:o}),this.getData()},hr([O],t.prototype,"rx",void 0),hr([O],t.prototype,"ry",void 0),hr([at],t.prototype,"points",null),hr([at],t.prototype,"pointsPosition",null),hr([at],t.prototype,"width",null),hr([at],t.prototype,"height",null),t}(Ve),Ux=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),dn=function(){return dn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},dn.apply(this,arguments)},Jn=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Wl=function(e){Ux(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.modelType=G.ELLIPSE_NODE,o.rx=30,o.ry=45,o.initNodeData(r),o.setAttributes(),o}return t.prototype.setAttributes=function(){e.prototype.setAttributes.call(this);var r=this.properties,n=r.rx,o=r.ry;n&&(this.rx=n),o&&(this.ry=o)},t.prototype.getNodeStyle=function(){var r=e.prototype.getNodeStyle.call(this),n=this.graphModel.theme.ellipse,o=this.properties.style,i=o===void 0?{}:o;return dn(dn(dn({},r),k(n)),k(i))},Object.defineProperty(t.prototype,"width",{get:function(){return this.rx*2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.ry*2},enumerable:!1,configurable:!0}),t.prototype.getDefaultAnchor=function(){var r=this,n=r.x,o=r.y,i=r.rx,a=r.ry;return[{x:n,y:o-a,id:"".concat(this.id,"_0")},{x:n+i,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+a,id:"".concat(this.id,"_2")},{x:n-i,y:o,id:"".concat(this.id,"_3")}]},t.prototype.resize=function(r){var n=r.width,o=r.height,i=r.deltaX,a=r.deltaY;return this.move(i/2,a/2),this.rx=n,this.ry=o,this.setProperties({rx:n,ry:o}),this.getData()},Jn([O],t.prototype,"rx",void 0),Jn([O],t.prototype,"ry",void 0),Jn([at],t.prototype,"width",null),Jn([at],t.prototype,"height",null),t}(Ve),zx=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),fn=function(){return fn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},fn.apply(this,arguments)},Qn=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},to=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Vl=function(e){zx(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.modelType=G.POLYGON_NODE,o.points=[[50,0],[100,50],[50,100],[0,50]],o.initNodeData(r),o.setAttributes(),o}return t.prototype.setAttributes=function(){e.prototype.setAttributes.call(this);var r=this.properties,n=r.points,o=r.width,i=r.height,a=n||this.points;this.points=Fm(a,o,i)},t.prototype.getNodeStyle=function(){var r=e.prototype.getNodeStyle.call(this),n=this.graphModel.theme.polygon,o=this.properties.style,i=o===void 0?{}:o;return fn(fn(fn({},r),k(n)),k(i))},Object.defineProperty(t.prototype,"pointsPosition",{get:function(){var r=this,n=r.x,o=r.y,i=r.width,a=r.height;return this.points.map(function(s){return{x:s[0]+n-i/2,y:s[1]+o-a/2}})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var r=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return this.points.forEach(function(o){var i=to(o,1),a=i[0];a<r&&(r=a),a>n&&(n=a)}),n-r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var r=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return this.points.forEach(function(o){var i=to(o,2),a=i[1];a<r&&(r=a),a>n&&(n=a)}),n-r},enumerable:!1,configurable:!0}),t.prototype.getDefaultAnchor=function(){var r=this,n=this,o=n.x,i=n.y,a=n.width,s=n.height,l=n.points;return l.map(function(u,f){var d=to(u,2),c=d[0],p=d[1];return{x:o+c-a/2,y:i+p-s/2,id:"".concat(r.id,"_").concat(f)}})},t.prototype.resize=function(r){var n=this,o=r.width,i=r.height,a=r.deltaX,s=r.deltaY;this.move(a/2,s/2);var l=Pe(this.points,function(u){var f=to(u,2),d=f[0],c=f[1];return[d*o/n.width,c*i/n.height]});return this.points=l,this.properties.points=l,this.getData()},Qn([O],t.prototype,"points",void 0),Qn([at],t.prototype,"pointsPosition",null),Qn([at],t.prototype,"width",null),Qn([at],t.prototype,"height",null),t}(Ve),Wx=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cn=function(){return cn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},cn.apply(this,arguments)},Vx=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Kl=function(e){Wx(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.modelType=G.RECT_NODE,o.radius=0,o.initNodeData(r),o.setAttributes(),o}return t.prototype.setAttributes=function(){e.prototype.setAttributes.call(this);var r=this.properties,n=r.width,o=r.height,i=r.radius;Qt(n)||(this.width=n),Qt(o)||(this.height=o),Qt(i)||(this.radius=i)},t.prototype.getDefaultAnchor=function(){var r=this,n=r.x,o=r.y,i=r.width,a=r.height;return[{x:n,y:o-a/2,id:"".concat(this.id,"_0")},{x:n+i/2,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+a/2,id:"".concat(this.id,"_2")},{x:n-i/2,y:o,id:"".concat(this.id,"_3")}]},t.prototype.getNodeStyle=function(){var r=e.prototype.getNodeStyle.call(this),n=this.graphModel.theme.rect,o=this.properties.style,i=o===void 0?{}:o;return cn(cn(cn({},r),k(n)),k(i))},Vx([O],t.prototype,"radius",void 0),t}(Ve),Kx=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pn=function(){return pn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},pn.apply(this,arguments)},Zl=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Zx=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},qx=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},ql=function(e){Kx(t,e);function t(){var r=e.apply(this,qx([],Zx(arguments),!1))||this;return r.modelType=G.TEXT_NODE,r}return t.prototype.getTextStyle=function(){var r=e.prototype.getTextStyle.call(this),n=this.graphModel.theme.text,o=this.properties.textStyle;return pn(pn(pn({},r),k(n)),k(o))},Object.defineProperty(t.prototype,"width",{get:function(){var r=String(this.text.value).split(/[\r\n]/g),n=this.getTextStyle().fontSize,o=Il({rows:r,fontSize:n,rowsLength:r.length}).width;return o},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var r=String(this.text.value).split(/[\r\n]/g),n=this.getTextStyle().fontSize,o=Il({rows:r,fontSize:n,rowsLength:r.length}).height;return o},enumerable:!1,configurable:!0}),Zl([at],t.prototype,"width",null),Zl([at],t.prototype,"height",null),t}(Ve),Jx=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jl=function(e){Jx(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.modelType=G.HTML_NODE,o.setAttributes(),o}return t.prototype.setAttributes=function(){e.prototype.setAttributes.call(this);var r=this.properties,n=r.width,o=r.height;n&&(this.width=n),o&&(this.height=o)},t.prototype.getDefaultAnchor=function(){var r=this,n=r.x,o=r.y,i=r.width,a=r.height;return[{x:n,y:o-a/2,id:"".concat(this.id,"_0")},{x:n+i/2,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+a/2,id:"".concat(this.id,"_2")},{x:n-i/2,y:o,id:"".concat(this.id,"_3")}]},t}(Ve),Z=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Qx={stopZoomGraph:!1,stopScrollGraph:!1,stopMoveGraph:!1,adjustEdge:!1,adjustEdgeStartAndEnd:!1,adjustNodePosition:!1,hideAnchors:!0,allowRotate:!1,allowResize:!1,nodeSelectedOutline:!0,textEdit:!1,nodeTextEdit:!1,edgeTextEdit:!1,textDraggable:!1,nodeTextDraggable:!1,edgeTextDraggable:!1},eo=["isSilentMode","stopZoomGraph","stopScrollGraph","stopMoveGraph","snapGrid","adjustEdge","adjustEdgeMiddle","adjustEdgeStartAndEnd","adjustEdgeStart","adjustEdgeEnd","adjustNodePosition","hideAnchors","allowRotate","allowResize","autoExpand","hoverOutline","nodeSelectedOutline","edgeSelectedOutline","textEdit","nodeTextEdit","edgeTextEdit","textDraggable","nodeTextDraggable","edgeTextDraggable","multipleSelectKey","textMode","nodeTextMode","edgeTextMode","nodeTextMultiple","edgeTextMultiple","nodeTextVertical","edgeTextVertical"],tE=function(){function e(t){this.isSilentMode=!1,this.stopZoomGraph=!1,this.stopMoveGraph=!1,this.stopScrollGraph=!1,this.snapGrid=!1,this.textMode=Yt.TEXT,this.textEdit=!0,this.textDraggable=!1,this.nodeTextEdit=!0,this.nodeTextDraggable=!1,this.nodeTextMultiple=!1,this.nodeTextVertical=!1,this.nodeTextMode=Yt.TEXT,this.edgeTextMode=Yt.TEXT,this.edgeTextEdit=!0,this.edgeTextDraggable=!1,this.edgeTextMultiple=!1,this.edgeTextVertical=!1,this.hideAnchors=!1,this.allowRotate=!1,this.allowResize=!1,this.hoverOutline=!0,this.nodeSelectedOutline=!0,this.adjustNodePosition=!0,this.autoExpand=!1,this.adjustEdge=!0,this.adjustEdgeMiddle=!1,this.adjustEdgeStartAndEnd=!1,this.adjustEdgeStart=!1,this.adjustEdgeEnd=!1,this.edgeSelectedOutline=!0,this.multipleSelectKey="",it(this,this.computeConfig(t))}return e.prototype.updateEditConfig=function(t){var r=this.computeConfig(t);it(this,r)},e.prototype.computeConfig=function(t){var r=t.isSilentMode,n=t.textDraggable,o=t.textMode,i=t.textEdit,a=t.adjustEdgeStartAndEnd,s={};if(r===!1&&it(s,this.stagedConfig),r===!0&&r!==this.isSilentMode){var l=xr(Qx,eo);this.stagedConfig=xr(this,eo),it(s,l)}Br(i)||it(s,{nodeTextEdit:i,edgeTextEdit:i}),Br(n)||it(s,{nodeTextDraggable:n,edgeTextDraggable:n}),o&&it(s,{nodeTextMode:o,edgeTextMode:o}),Vi(a)&&it(s,{adjustEdgeStart:a,adjustEdgeEnd:a});var u=xr(t,eo);return it(s,u)},e.prototype.updateTextMode=function(t){this.textMode=t,this.edgeTextMode=t,this.nodeTextMode=t},e.prototype.getConfig=function(){return xr(this,eo)},Z([O],e.prototype,"isSilentMode",void 0),Z([O],e.prototype,"stopZoomGraph",void 0),Z([O],e.prototype,"stopMoveGraph",void 0),Z([O],e.prototype,"stopScrollGraph",void 0),Z([O],e.prototype,"snapGrid",void 0),Z([O],e.prototype,"textMode",void 0),Z([O],e.prototype,"textEdit",void 0),Z([O],e.prototype,"textDraggable",void 0),Z([O],e.prototype,"nodeTextEdit",void 0),Z([O],e.prototype,"nodeTextDraggable",void 0),Z([O],e.prototype,"nodeTextMultiple",void 0),Z([O],e.prototype,"nodeTextVertical",void 0),Z([O],e.prototype,"nodeTextMode",void 0),Z([O],e.prototype,"edgeTextMode",void 0),Z([O],e.prototype,"edgeTextEdit",void 0),Z([O],e.prototype,"edgeTextDraggable",void 0),Z([O],e.prototype,"edgeTextMultiple",void 0),Z([O],e.prototype,"edgeTextVertical",void 0),Z([O],e.prototype,"hideAnchors",void 0),Z([O],e.prototype,"allowRotate",void 0),Z([O],e.prototype,"allowResize",void 0),Z([O],e.prototype,"hoverOutline",void 0),Z([O],e.prototype,"nodeSelectedOutline",void 0),Z([O],e.prototype,"adjustNodePosition",void 0),Z([O],e.prototype,"autoExpand",void 0),Z([O],e.prototype,"adjustEdge",void 0),Z([O],e.prototype,"adjustEdgeMiddle",void 0),Z([O],e.prototype,"adjustEdgeStartAndEnd",void 0),Z([O],e.prototype,"adjustEdgeStart",void 0),Z([O],e.prototype,"adjustEdgeEnd",void 0),Z([O],e.prototype,"edgeSelectedOutline",void 0),Z([E],e.prototype,"updateEditConfig",null),Z([E],e.prototype,"updateTextMode",null),e}(),eE="*",rE=function(){function e(){this._events={}}return e.prototype.on=function(t,r,n){var o=this;t==null||t.split(",").forEach(function(i){i=i.trim(),o._events[i]||(o._events[i]=[]),o._events[i].push({callback:r,once:!!n})})},e.prototype.once=function(t,r){var n=this;t==null||t.split(",").forEach(function(o){o=o.trim(),n.on(o,r,!0)})},e.prototype.emit=function(t,r){var n=this;t==null||t.split(",").forEach(function(o){var i=n._events[o]||[],a=n._events[eE]||[],s=function(l){for(var u=l.length,f=0;f<u;f++)if(l[f]){var d=l[f],c=d.callback,p=d.once;p&&(l.splice(f,1),l.length===0&&delete n._events[o],u--,f--),c.apply(n,[r])}};s(i),s(a)})},e.prototype.off=function(t,r){var n=this;t||(this._events={}),t.split(",").forEach(function(o){if(!r)delete n._events[o];else{for(var i=n._events[o]||[],a=i.length,s=0;s<a;s++)i[s].callback===r&&(i.splice(s,1),a--,s--);i.length===0&&delete n._events[o]}})},e.prototype.getEvents=function(){return this._events},e.prototype.destroy=function(){this._events={}},e}(),nE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),sa=function(){return sa=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},sa.apply(this,arguments)},oE=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},iE=function(e){nE(t,e);function t(r){var n=e.call(this)||this;n.stepScrollX=0,n.stepScrollY=0,n.onDragging=function(s){var l=s.deltaX,u=s.deltaY;n.setState({isDragging:!0});var f=n.props.graphModel,d=f.transformModel,c=f.editConfigModel;c.stopMoveGraph!==!0&&d.translate(l,u)},n.onDragEnd=function(){n.setState({isDragging:!1})},n.zoomHandler=function(s){var l=n.props,u=l.graphModel,f=u.editConfigModel,d=u.transformModel,c=u.gridSize,p=l.graphModel,v=s.deltaX,h=s.deltaY,_=f.stopScrollGraph,y=f.stopZoomGraph;if(!_&&!s.ctrlKey&&!s.metaKey){if(s.preventDefault(),n.stepScrollX+=v,n.stepScrollY+=h,Math.abs(n.stepScrollX)>=c){var m=n.stepScrollX%c,S=n.stepScrollX-m;d.translate(-S*d.SCALE_X,0),n.stepScrollX=m}if(Math.abs(n.stepScrollY)>=c){var M=n.stepScrollY%c,A=n.stepScrollY-M;d.translate(0,-A*d.SCALE_Y),n.stepScrollY=M}return}if(!y){s.preventDefault();var b=p.getPointByClient({x:s.clientX,y:s.clientY}),g=b.canvasOverlayPosition,x=g.x,T=g.y;d.zoom(s.deltaY<0,[x,T])}},n.clickHandler=function(s){var l=s.target;if(l.getAttribute("name")==="canvas-overlay"){var u=n.props.graphModel,f=u.selectElements;f.size>0&&u.clearSelectElements(),u.eventCenter.emit(R.BLANK_CLICK,{e:s})}},n.handleContextMenu=function(s){var l=s.target;if(l.getAttribute("name")==="canvas-overlay"){s.preventDefault();var u=n.props.graphModel,f=u.getPointByClient({x:s.clientX,y:s.clientY});u.eventCenter.emit(R.BLANK_CONTEXTMENU,{e:s,position:f})}},n.mouseDownHandler=function(s){var l=n.props.graphModel,u=l.eventCenter,f=l.editConfigModel,d=l.transformModel.SCALE_X,c=l.gridSize,p=f.adjustEdge,v=f.adjustNodePosition,h=f.stopMoveGraph,_=s.target,y=!p&&!v;(_.getAttribute("name")==="canvas-overlay"||y)&&(h!==!0?(n.stepDrag.setStep(c*d),n.stepDrag.handleMouseDown(s)):u.emit(R.BLANK_MOUSEDOWN,{e:s}),n.clickHandler(s))};var o=r.graphModel,i=o.gridSize,a=o.eventCenter;return n.stepDrag=new Ee({onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:i,eventType:"BLANK",isStopPropagation:!1,eventCenter:a,model:void 0}),n.state={isDragging:!1},n}return t.prototype.render=function(){var r=this.props.graphModel.transformModel,n=r.getTransformStyle().transform,o=this.props,i=o.children,a=o.dnd,s=this.state.isDragging;return w("svg",sa({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",name:"canvas-overlay",onWheel:this.zoomHandler,onMouseDown:this.mouseDownHandler,onContextMenu:this.handleContextMenu,className:s?"lf-canvas-overlay lf-dragging":"lf-canvas-overlay lf-drag-able"},a.eventMap(),{children:w("g",{transform:n,children:i})}))},t=oE([$t],t),t}(W),ff=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),An=function(){return An=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},An.apply(this,arguments)},aE=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},sE=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Ql=function(e){ff(t,e);function t(){var r=e.call(this)||this;return r.onDragging=function(n){var o=n.event,i=r.props,a=i.graphModel,s=i.bezierModel,l=i.type,u=a.getPointByClient({x:o.clientX,y:o.clientY}).canvasOverlayPosition,f=u.x,d=u.y;s.updateAdjustAnchor({x:f,y:d},l),a.eventCenter.emit(R.EDGE_ADJUST,{data:s.getData()})},r.onDragEnd=function(){var n=r.props.bezierModel;n.isDragging=!1},r.dragHandler=new Ee({onDragging:r.onDragging,onDragEnd:r.onDragEnd}),r}return t.prototype.render=function(){var r=this,n=this.props.position,o=n.x,i=n.y,a=this.props.bezierModel,s=a.getEdgeStyle().adjustAnchor;return w(Fr,An({className:"lf-bezier-adjust-anchor",x:o,y:i},s,{onMouseDown:function(l){r.dragHandler.handleMouseDown(l)}}))},t}(W),lE=function(e){ff(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getBezierAdjust=function(r,n){var o=r.path,i=r.id,a=Va(o),s=sE(a,4),l=s[0],u=s[1],f=s[2],d=s[3],c=r.getEdgeStyle().adjustLine,p=[];return p.push(w(Xr,An({x1:l.x,y1:l.y,x2:u.x,y2:u.y},c))),p.push(w(Ql,{position:u,bezierModel:r,graphModel:n,type:"sNext"},"".concat(i,"_ePre"))),p.push(w(Xr,An({x1:d.x,y1:d.y,x2:f.x,y2:f.y},c))),p.push(w(Ql,{position:f,bezierModel:r,graphModel:n,type:"ePre"},"".concat(i,"_sNext"))),p},t.prototype.selectedBezierEdge=function(){for(var r=this.props.graphModel,n=r.edges,o=[],i=0;i<n.length;i++){var a=n[i];a.isSelected&&a.modelType===G.BEZIER_EDGE&&a.draggable&&o.push(this.getBezierAdjust(a,r))}return o},t.prototype.render=function(){return w("g",{className:"lf-bezier-adjust",children:this.selectedBezierEdge()})},t=aE([$t],t),t}(W),uE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),dE=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},fE=function(e){uE(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){var r=this.props.background;return w("div",{className:"lf-background",children:w("div",{style:At(r)?r:{},className:"lf-background-area"})})},t=dE([$t],t),t}(W),cE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pE=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Io=function(e){cE(t,e);function t(r){var n=e.call(this,r)||this;return n.id=or(),n.gridOptions=n.props.graphModel.grid,n}return t.prototype.renderDot=function(){var r=this.gridOptions,n=r.config,o=r.size,i=o===void 0?1:o,a=r.visible,s=n??{},l=s.color,u=s.thickness,f=u===void 0?2:u,d=Math.min(Math.max(2,f),i/4),c=a?1:0;return w("g",{fill:l,opacity:c,children:[w("circle",{cx:0,cy:0,r:d/2}),w("circle",{cx:0,cy:i,r:d/2}),w("circle",{cx:i,cy:0,r:d/2}),w("circle",{cx:i,cy:i,r:d/2})]})},t.prototype.renderMesh=function(){var r=this.gridOptions,n=r.config,o=r.size,i=o===void 0?1:o,a=r.visible,s=n??{},l=s.color,u=s.thickness,f=u===void 0?1:u,d=Math.min(Math.max(1,f),i/2),c="M 0 0 H ".concat(i," V ").concat(i," H 0 Z"),p=a?1:0;return w("path",{d:c,stroke:l,strokeWidth:d/2,opacity:p,fill:"transparent"})},t.prototype.render=function(){var r=this.props.graphModel.transformModel,n=this.gridOptions,o=n.type,i=n.size,a=i===void 0?1:i,s=r.SCALE_X,l=r.SKEW_Y,u=r.SKEW_X,f=r.SCALE_Y,d=r.TRANSLATE_X,c=r.TRANSLATE_Y,p=[s,l,u,f,d,c].join(","),v="matrix(".concat(p,")");return w("div",{className:"lf-grid",children:w("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%",children:[w("defs",{children:w("pattern",{id:this.id,patternUnits:"userSpaceOnUse",patternTransform:v,x:"0",y:"0",width:a,height:a,children:[o==="dot"&&this.renderDot(),o==="mesh"&&this.renderMesh()]})}),w("rect",{width:"100%",height:"100%",fill:"url(#".concat(this.id,")")})]})})},t=pE([$t],t),t}(W);(function(e){e.defaultProps={size:gm,visible:!0,type:"dot",config:{color:"#ababab",thickness:1}};function t(r){var n=k(e.defaultProps);return typeof r=="number"?it(n,{size:r}):typeof r=="boolean"?it(n,{visible:r}):it(n,r)}e.getGridOptions=t})(Io||(Io={}));var hE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vE=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},yE=function(e){hE(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){var r=this.props.graphModel.transformModel,n=r.getTransformStyle().transform,o=this.props.children;return w("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%",className:"modification-overlay",children:w("g",{transform:n,children:o})})},t=vE([$t],t),t}(W),gE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ie=function(){return Ie=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ie.apply(this,arguments)},_E=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},mE=function(e){gE(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getNodesOutline=function(){var r=this.props.graphModel,n=r.nodes,o=r.editConfigModel,i=o.hoverOutline,a=o.nodeSelectedOutline,s=[];return n.forEach(function(l){if(l.isHovered||l.isSelected){var u=l.isHovered,f=l.isSelected,d=l.x,c=l.y,p=l.width,v=l.height;if(a&&f||i&&u){var h=l.getOutlineStyle(),_={};if(Object.keys(h).forEach(function(m){m!=="hover"&&(_[m]=h[m])}),u){var y=h.hover;_=Ie(Ie({},_),y)}s.push(w(ye,Ie({transform:l.transform,className:"lf-outline-node",x:d,y:c,width:p+10,height:v+10},_)))}}}),s},t.prototype.getEdgeOutline=function(){for(var r=this.props.graphModel,n=r.edges,o=r.editConfigModel,i=o.edgeSelectedOutline,a=o.hoverOutline,s=[],l=0;l<n.length;l++){var u=n[l];(i&&u.isSelected||a&&u.isHovered)&&(u.modelType===G.LINE_EDGE?s.push(this.getLineOutline(u)):u.modelType===G.POLYLINE_EDGE?s.push(this.getPolylineOutline(u)):u.modelType===G.BEZIER_EDGE&&s.push(this.getBezierOutline(u)))}return s},t.prototype.getLineOutline=function(r){var n=r.startPoint,o=r.endPoint,i=(n.x+o.x)/2,a=(n.y+o.y)/2,s=Math.abs(n.x-o.x)+10,l=Math.abs(n.y-o.y)+10,u=r.getOutlineStyle();return w(ye,Ie({className:"lf-outline-edge",x:i,y:a,width:s,height:l},u))},t.prototype.getPolylineOutline=function(r){var n=r.points,o=lr(n),i=On(o,8),a=i.x,s=i.y,l=i.width,u=i.height,f=r.getOutlineStyle();return w(ye,Ie({className:"lf-outline",x:a,y:s,width:l,height:u},f))},t.prototype.getBezierOutline=function(r){var n=r.path,o=Va(n),i=On(o,8),a=i.x,s=i.y,l=i.width,u=i.height,f=r.getOutlineStyle();return w(ye,Ie({className:"lf-outline",x:a,y:s,width:l,height:u},f))},t.prototype.render=function(){return w("g",{className:"lf-outline",children:[this.getNodesOutline(),this.getEdgeOutline()]})},t=_E([$t],t),t}(W),xE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Be=function(){return Be=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Be.apply(this,arguments)},EE=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},bE=function(e){xE(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){var r=this.props.snaplineModel,n=r??{},o=n.position,i=n.isShowHorizontal,a=n.isShowVertical,s=r==null?void 0:r.getStyle(),l=o??{},u=l.x,f=u===void 0?0:u,d=l.y,c=d===void 0?0:d,p=Be(Be({x1:-1e5,y1:c,x2:1e5,y2:c},s),{stroke:i?s==null?void 0:s.stroke:"none"}),v=Be(Be({x1:f,y1:-1e5,x2:f,y2:1e5},s),{stroke:a?s==null?void 0:s.stroke:"none"});return w("g",{className:"lf-snapline",children:[w(Xr,Be({},p)),w(Xr,Be({},v))]})},t=EE([$t],t),t}(W),OE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wE=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},SE=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},ME=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},AE=function(e){OE(t,e);function t(){var r=e.apply(this,ME([],SE(arguments),!1))||this;return r.zoomHandler=function(n){var o;(o=r.props.getCanvasOverlay())===null||o===void 0||o.zoomHandler(n)},r}return t.prototype.componentDidMount=function(){this.triggerToolRender()},t.prototype.componentDidUpdate=function(){this.triggerToolRender()},t.prototype.getTools=function(){var r=this.props,n=r.tool,o=r.graphModel,i=o.textEditElement,a=n.getTools(),s=a.map(function(l){return Sr(l,{textEditElement:i,graphModel:o,lf:n.instance})});return n.components=s,s},t.prototype.triggerToolRender=function(){var r=this.props,n=r.tool,o=r.graphModel,i=document.querySelector("#ToolOverlay_".concat(o.flowId)),a=n.getInstance();a.components.forEach(function(s){return s(a,i)}),a.components=[]},t.prototype.render=function(){var r=this.props.graphModel;return w("div",{className:"lf-tool-overlay",id:"ToolOverlay_".concat(r.flowId),onWheel:this.zoomHandler,children:this.getTools()})},t=wE([$t],t),t}(W),$e=function(){return $e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$e.apply(this,arguments)},N=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},TE=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},mt=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Ft=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},PE=function(){function e(t){var r=this,n,o;this.modelMap=new Map,this.nodeModelMap=new Map,this.edgeModelMap=new Map,this.elementsModelMap=new Map,this.nodeMoveRules=[],this.nodeResizeRules=[],this.nodes=[],this.edges=[],this.overlapMode=Jt.DEFAULT,this.gridSize=1,this.partial=!1,this.waitCleanEffects=[];var i=t.container,a=t.partial,s=t.background,l=s===void 0?{}:s,u=t.grid,f=t.idGenerator,d=t.edgeGenerator,c=t.animation,p=t.customTrajectory;this.rootEl=i,this.partial=!!a,this.background=l,typeof u=="object"&&t.snapGrid&&(this.gridSize=u.size||1),this.theme=df(t.style),this.grid=Io.getGridOptions(u??!1),this.edgeType=t.edgeType||"polyline",this.animation=hm(c),this.overlapMode=t.overlapMode||Jt.DEFAULT,this.width=(n=t.width)!==null&&n!==void 0?n:this.rootEl.getBoundingClientRect().width,this.isContainerWidth=Qt(t.width),this.height=(o=t.height)!==null&&o!==void 0?o:this.rootEl.getBoundingClientRect().height,this.isContainerHeight=Qt(t.height);var v=new ResizeObserver(za(function(h){var _,y;try{for(var m=TE(h),S=m.next();!S.done;S=m.next()){var M=S.value;M.target===r.rootEl&&(r.resize(),r.eventCenter.emit("graph:resize",{target:r.rootEl,contentRect:M.contentRect}))}}catch(A){_={error:A}}finally{try{S&&!S.done&&(y=m.return)&&y.call(m)}finally{if(_)throw _.error}}},16));v.observe(this.rootEl),this.waitCleanEffects.push(function(){v.disconnect()}),this.eventCenter=new rE,this.editConfigModel=new tE(t),this.transformModel=new CE(this.eventCenter,t),this.flowId=or(),this.idGenerator=f,this.edgeGenerator=$m(this,d),this.customTrajectory=p}return Object.defineProperty(e.prototype,"nodesMap",{get:function(){return this.nodes.reduce(function(t,r,n){return t[r.id]={index:n,model:r},t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"edgesMap",{get:function(){return this.edges.reduce(function(t,r,n){return t[r.id]={index:n,model:r},t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelsMap",{get:function(){return Ft(Ft([],mt(this.nodes),!1),mt(this.edges),!1).reduce(function(t,r){return t[r.id]=r,t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortElements",{get:function(){for(var t=Ft(Ft([],mt(this.nodes),!1),mt(this.edges),!1).sort(function(s,l){return s.zIndex-l.zIndex}),r=[],n=[-200,-200],o=[this.width+_l,this.height+_l],i=0;i<t.length;i++){var a=t[i];a.visible&&(!this.partial||a.isSelected||this.isElementInArea(a,n,o,!1,!1))&&r.push(a)}return r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textEditElement",{get:function(){var t=this.nodes.find(function(n){return n.state===J.TEXT_EDIT}),r=this.edges.find(function(n){return n.state===J.TEXT_EDIT});return t||r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectElements",{get:function(){var t=new Map;return this.nodes.forEach(function(r){r.isSelected&&t.set(r.id,r)}),this.edges.forEach(function(r){r.isSelected&&t.set(r.id,r)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectNodes",{get:function(){var t=[];return this.nodes.forEach(function(r){r.isSelected&&t.push(r)}),t},enumerable:!1,configurable:!0}),e.prototype.getAreaElement=function(t,r,n,o,i){var a=this;n===void 0&&(n=!0),o===void 0&&(o=!0),i===void 0&&(i=!1);var s=[];return ht(Ft(Ft([],mt(this.nodes),!1),mt(this.edges),!1),function(l){var u=a.isElementInArea(l,t,r,n,o);(!i||l.visible)&&u&&s.push(l)}),s},e.prototype.getModel=function(t){return this.modelMap.get(t)},e.prototype.getNodeModelById=function(t){var r;return this.fakeNode&&t===this.fakeNode.id?this.fakeNode:(r=this.nodesMap[t])===null||r===void 0?void 0:r.model},e.prototype.getPointByClient=function(t){var r=t.x,n=t.y,o=this.rootEl.getBoundingClientRect(),i={x:r-o.left,y:n-o.top},a=mt(this.transformModel.HtmlPointToCanvasPoint([i.x,i.y]),2),s=a[0],l=a[1],u={x:s,y:l};return{domOverlayPosition:i,canvasOverlayPosition:u}},e.prototype.isElementInArea=function(t,r,n,o,i){var a;if(o===void 0&&(o=!0),i===void 0&&(i=!0),t.BaseType===ct.NODE){t=t;for(var s=Bt(t),l=s.minX,u=s.minY,f=s.maxX,d=s.maxY,c=[{x:l,y:u},{x:f,y:u},{x:f,y:d},{x:l,y:d}],p=i,v=0;v<c.length;v++){var h=c[v],_=h.x,y=h.y;if(a=mt(this.transformModel.CanvasPointToHtmlPoint([_,y]),2),_=a[0],y=a[1],_i([_,y],r,n)!==i){p=!i;break}}return p}if(t.BaseType===ct.EDGE){t=t;var m=t.startPoint,S=t.endPoint,M=this.transformModel.CanvasPointToHtmlPoint([m.x,m.y]),A=this.transformModel.CanvasPointToHtmlPoint([S.x,S.y]),b=_i(M,r,n),g=_i(A,r,n);return o?b&&g:b||g}return!1},e.prototype.graphDataToModel=function(t){var r=this;if(!t){this.clearData();return}if(this.elementsModelMap.clear(),this.nodeModelMap.clear(),this.edgeModelMap.clear(),t.nodes?this.nodes=Pe(t.nodes,function(o){var i=r.getModelAfterSnapToGrid(o);return r.elementsModelMap.set(i.id,i),r.nodeModelMap.set(i.id,i),i}):this.nodes=[],t.edges){var n=this.edgeType;this.edges=Pe(t.edges,function(o){var i,a=r.getModel((i=o.type)!==null&&i!==void 0?i:n);if(!a)throw new Error("".concat(o.type,""));var s=new a(o,r);return r.edgeModelMap.set(s.id,s),r.elementsModelMap.set(s.id,s),s})}else this.edges=[]},e.prototype.modelToGraphData=function(){var t=[];this.edges.forEach(function(n){var o=n.getData();o&&!n.virtual&&t.push(o)});var r=[];return this.nodes.forEach(function(n){var o=n.getData();o&&!n.virtual&&r.push(o)}),{nodes:r,edges:t}},e.prototype.modelToHistoryData=function(){for(var t=!1,r=[],n=0;n<this.nodes.length;n++){var o=this.nodes[n];if(o.isDragging){t=!0;break}else r.push(o.getHistoryData())}if(t)return!1;for(var i=!1,a=[],s=0;s<this.edges.length;s++){var l=this.edges[s];if(l.isDragging){i=!0;break}else a.push(l.getHistoryData())}return i?!1:{nodes:r,edges:a}},e.prototype.getEdgeModelById=function(t){var r;return(r=this.edgesMap[t])===null||r===void 0?void 0:r.model},e.prototype.getElement=function(t){return this.modelsMap[t]},e.prototype.getNodeEdges=function(t){for(var r=[],n=0;n<this.edges.length;n++){var o=this.edges[n],i=o.sourceNodeId===t,a=o.targetNodeId===t;(i||a)&&r.push(o)}return r},e.prototype.getSelectElements=function(t){t===void 0&&(t=!0);var r=this.selectElements,n={nodes:[],edges:[]};return r.forEach(function(o){if(o.BaseType===ct.NODE&&n.nodes.push(o.getData()),o.BaseType===ct.EDGE){var i=o.getData(),a=r.get(i.sourceNodeId)&&r.get(i.targetNodeId);(t||a)&&n.edges.push(i)}}),n},e.prototype.updateAttributes=function(t,r){var n=this.getElement(t);n==null||n.updateAttributes(r)},e.prototype.changeNodeId=function(t,r){return r||(r=or()),this.nodesMap[r]?(console.warn("".concat(r,", ")),""):this.nodesMap[t]?(this.edges.forEach(function(n){n.sourceNodeId===t&&(n.sourceNodeId=r),n.targetNodeId===t&&(n.targetNodeId=r)}),this.nodesMap[t].model.id=r,this.nodesMap[r]=this.nodesMap[t],r):(console.warn("".concat(t,", ")),"")},e.prototype.changeEdgeId=function(t,r){return r||(r=or()),this.edgesMap[r]?(console.warn(": ".concat(r,", ")),""):this.edgesMap[t]?(this.edges.forEach(function(n){n.id===t&&n.changeEdgeId(r)}),r):(console.warn(": ".concat(r,", ")),"")},e.prototype.getTextModel=function(t){var r=this.editConfigModel,n=r.textMode,o=r.nodeTextMode,i=r.edgeTextMode;if(t.BaseType===ct.NODE)return t.textMode||o||n||Yt.TEXT;if(t.BaseType===ct.EDGE)return t.textMode||i||n||Yt.TEXT},e.prototype.setTextMode=function(t,r){this.editConfigModel.updateEditConfig({textMode:t})},e.prototype.setFakeNode=function(t){this.fakeNode=t},e.prototype.removeFakeNode=function(){this.fakeNode=null},e.prototype.setModel=function(t,r){return this.modelMap.set(t,r)},e.prototype.toFront=function(t){var r,n,o,i=((r=this.nodesMap[t])===null||r===void 0?void 0:r.model)||((n=this.edgesMap[t])===null||n===void 0?void 0:n.model);i&&(this.overlapMode===Jt.DEFAULT&&((o=this.topElement)===null||o===void 0||o.setZIndex(),i.setZIndex(ym),this.topElement=i),this.overlapMode===Jt.INCREASE&&this.setElementZIndex(t,"top"))},e.prototype.setElementZIndex=function(t,r){var n,o,i=((n=this.nodesMap[t])===null||n===void 0?void 0:n.model)||((o=this.edgesMap[t])===null||o===void 0?void 0:o.model);if(i){var a=void 0;typeof r=="number"?a=r:(r==="top"&&(a=Za()),r==="bottom"&&(a=Ix())),i.setZIndex(a)}},e.prototype.deleteNode=function(t){var r=this.nodesMap[t].model,n=r.getData();this.deleteEdgeBySource(t),this.deleteEdgeByTarget(t),this.nodes.splice(this.nodesMap[t].index,1),this.eventCenter.emit(R.NODE_DELETE,{data:n,model:r})},e.prototype.addNode=function(t,r,n){r===void 0&&(r=R.NODE_ADD);var o=Mt(t),i=o.id;i&&this.nodesMap[i]&&delete o.id;var a=this.getModelAfterSnapToGrid(o);this.nodes.push(a);var s=a.getData(),l={data:s};return n&&(l.e=n),this.eventCenter.emit(r,l),a},e.prototype.getModelAfterSnapToGrid=function(t){var r=this.getModel(t.type),n=this.editConfigModel.snapGrid;if(!r)throw new Error("".concat(t.type,""));var o=t.x,i=t.y;o&&i&&(t.x=$r(o,this.gridSize,n),t.y=$r(i,this.gridSize,n),typeof t.text=="object"&&t.text!==null&&(t.text.x+=t.x-o,t.text.y+=t.y-i));var a=new r(t,this);return this.nodeModelMap.set(a.id,a),this.elementsModelMap.set(a.id,a),a},e.prototype.cloneNode=function(t){var r=this.getNodeModelById(t),n=r==null?void 0:r.getData();if(n){n.x+=30,n.y+=30,n.id="",typeof n.text=="object"&&n.text!==null&&(n.text.x+=30,n.text.y+=30);var o=this.addNode(n);return o.setSelected(!0),r==null||r.setSelected(!1),o.getData()}},e.prototype.moveNode=function(t,r,n,o){var i;o===void 0&&(o=!1);var a=this.nodesMap[t];if(!a){console.warn("id".concat(t,""));return}var s=a.model;i=mt(s.getMoveDistance(r,n,o),2),r=i[0],n=i[1],this.moveEdge(t,r,n)},e.prototype.moveNode2Coordinate=function(t,r,n,o){o===void 0&&(o=!1);var i=this.nodesMap[t];if(!i){console.warn("id".concat(t,""));return}var a=i.model,s=a.x,l=a.y,u=r-s,f=n-l;this.moveNode(t,u,f,o)},e.prototype.editText=function(t){this.setElementStateById(t,J.TEXT_EDIT)},e.prototype.addEdge=function(t){var r=Mt(t),n=r.type;n||(n=this.edgeType),r.id&&this.edgesMap[r.id]&&delete r.id;var o=this.getModel(n);if(!o)throw new Error("".concat(n,""));var i=new o($e($e({},r),{type:n}),this);this.edgeModelMap.set(i.id,i),this.elementsModelMap.set(i.id,i);var a=i.getData();return this.edges.push(i),this.eventCenter.emit(R.EDGE_ADD,{data:a}),i},e.prototype.moveEdge=function(t,r,n){for(var o=0;o<this.edges.length;o++){var i=this.edges[o],a=i.textPosition,s=a.x,l=a.y,u=this.edges[o].sourceNodeId===t,f=this.edges[o].targetNodeId===t;u&&i.moveStartPoint(r,n),f&&i.moveEndPoint(r,n),(u||f)&&this.handleEdgeTextMove(i,s,l)}},e.prototype.handleEdgeTextMove=function(t,r,n){var o;if(t.customTextPosition){t.resetTextPosition();return}if(t.modelType===G.POLYLINE_EDGE&&(!((o=t.text)===null||o===void 0)&&o.value)){var i=t.text,a=ef(i,t.points);t.moveText(a.x-i.x,a.y-i.y)}var s=t.textPosition,l=s.x,u=s.y;t.moveText(l-r,u-n)},e.prototype.deleteEdgeBySourceAndTarget=function(t,r){for(var n=0;n<this.edges.length;n++)if(this.edges[n].sourceNodeId===t&&this.edges[n].targetNodeId===r){var o=this.edges[n].getData();this.edges.splice(n,1),n--,this.eventCenter.emit(R.EDGE_DELETE,{data:o})}},e.prototype.deleteEdgeById=function(t){var r=this.edgesMap[t];if(r){var n=this.edgesMap[t].index,o=this.edgesMap[t].model.getData();this.edges.splice(n,1),this.eventCenter.emit(R.EDGE_DELETE,{data:o})}},e.prototype.deleteEdgeBySource=function(t){for(var r=0;r<this.edges.length;r++)if(this.edges[r].sourceNodeId===t){var n=this.edges[r].getData();this.edges.splice(r,1),r--,this.eventCenter.emit(R.EDGE_DELETE,{data:n})}},e.prototype.deleteEdgeByTarget=function(t){for(var r=0;r<this.edges.length;r++)if(this.edges[r].targetNodeId===t){var n=this.edges[r].getData();this.edges.splice(r,1),r--,this.eventCenter.emit(R.EDGE_DELETE,{data:n})}},e.prototype.setElementStateById=function(t,r,n){this.nodes.forEach(function(o){o.id===t?o.setElementState(r,n):o.setElementState(J.DEFAULT)}),this.edges.forEach(function(o){o.id===t?o.setElementState(r,n):o.setElementState(J.DEFAULT)})},e.prototype.updateText=function(t,r){var n=sr(Ft(Ft([],mt(this.nodes),!1),mt(this.edges),!1),function(o){return o.id===t});n==null||n.updateText(r)},e.prototype.selectNodeById=function(t,r){var n;r===void 0&&(r=!1),r||this.clearSelectElements();var o=(n=this.nodesMap[t])===null||n===void 0?void 0:n.model;o==null||o.setSelected(!0)},e.prototype.selectEdgeById=function(t,r){var n;r===void 0&&(r=!1),r||this.clearSelectElements();var o=(n=this.edgesMap[t])===null||n===void 0?void 0:n.model;o==null||o.setSelected(!0)},e.prototype.selectElementById=function(t,r){r===void 0&&(r=!1),r||this.clearSelectElements();var n=this.getElement(t);n==null||n.setSelected(!0)},e.prototype.clearSelectElements=function(){var t;this.selectElements.forEach(function(r){r==null||r.setSelected(!1)}),this.selectElements.clear(),this.overlapMode===Jt.DEFAULT&&((t=this.topElement)===null||t===void 0||t.setZIndex())},e.prototype.moveNodes=function(t,r,n,o){var i,a,s,l=this;o===void 0&&(o=!1);for(var u=t.reduce(function(S,M){var A,b=(A=l.nodesMap[M])===null||A===void 0?void 0:A.model;return b&&(S[M]=b.getMoveDistance(r,n,o)),S},{}),f=0;f<this.edges.length;f++){var d=this.edges[f],c=d.textPosition,p=c.x,v=c.y,h=u[d.sourceNodeId],_=u[d.targetNodeId],y=void 0,m=void 0;h&&_&&d.modelType===G.POLYLINE_EDGE?(i=mt(h,2),y=i[0],m=i[1],d.updatePointsList(y,m)):(h&&(a=mt(h,2),y=a[0],m=a[1],d.moveStartPoint(y,m)),_&&(s=mt(_,2),y=s[0],m=s[1],d.moveEndPoint(y,m))),(h||_)&&this.handleEdgeTextMove(d,p,v)}},e.prototype.addNodeMoveRules=function(t){this.nodeMoveRules.includes(t)||this.nodeMoveRules.push(t)},e.prototype.addNodeResizeRules=function(t){this.nodeResizeRules.includes(t)||this.nodeResizeRules.push(t)},e.prototype.setDefaultEdgeType=function(t){this.edgeType=t},e.prototype.changeNodeType=function(t,r){var n=this.getNodeModelById(t);if(!n){console.warn("id".concat(t,""));return}var o=n.getData();o.type=r;var i=this.getModel(r);if(!i)throw new Error("".concat(r,""));var a=new i(o,this);this.nodes.splice(this.nodesMap[t].index,1,a);var s=this.getNodeEdges(t);s.forEach(function(l){if(l.sourceNodeId===t){var u=Ll(a,l.startPoint,a.width,a.height);l.updateStartPoint(u)}if(l.targetNodeId===t){var u=Ll(a,l.endPoint,a.width,a.height);l.updateEndPoint(u)}})},e.prototype.changeEdgeType=function(t,r){var n=this.getEdgeModelById(t);if(!n){console.warn("id".concat(t,""));return}if(n.type!==r){var o=n.getData();o.type=r;var i=this.getModel(r);if(!i)throw new Error("".concat(r,""));delete o.pointsList;var a=new i(o,this);this.edges.splice(this.edgesMap[t].index,1,a)}},e.prototype.getNodeIncomingEdge=function(t){var r=[];return this.edges.forEach(function(n){n.targetNodeId===t&&r.push(n)}),r},e.prototype.getNodeOutgoingEdge=function(t){var r=[];return this.edges.forEach(function(n){n.sourceNodeId===t&&r.push(n)}),r},e.prototype.getAnchorIncomingEdge=function(t){var r=[];return this.edges.forEach(function(n){n.targetAnchorId===t&&r.push(n)}),r},e.prototype.getAnchorOutgoingEdge=function(t){var r=[];return this.edges.forEach(function(n){n.sourceAnchorId===t&&r.push(n)}),r},e.prototype.getNodeIncomingNode=function(t){var r=this,n=[];return this.edges.forEach(function(o){var i;o.targetNodeId===t&&n.push((i=r.nodesMap[o.sourceNodeId])===null||i===void 0?void 0:i.model)}),n},e.prototype.getNodeOutgoingNode=function(t){var r=this,n=[];return this.edges.forEach(function(o){o.sourceNodeId===t&&n.push(r.nodesMap[o.targetNodeId].model)}),n},e.prototype.setTheme=function(t){this.theme=Rx($e($e({},this.theme),t))},e.prototype.updateGridOptions=function(t){Wa(this.grid,t)},e.prototype.updateGridSize=function(t){this.gridSize=t},e.prototype.updateBackgroundOptions=function(t){Vi(t)||Vi(this.background)?this.background=t:this.background=$e($e({},this.background),t)},e.prototype.resize=function(t,r){this.width=t??this.rootEl.getBoundingClientRect().width,this.isContainerWidth=Qt(t),this.height=r??this.rootEl.getBoundingClientRect().height,this.isContainerHeight=Qt(r),(!this.width||!this.height)&&console.warn("containerDOM@see https://github.com/didi/LogicFlow/issues/675")},e.prototype.clearData=function(){this.nodes=[],this.edges=[],this.edgeModelMap.clear(),this.nodeModelMap.clear(),this.elementsModelMap.clear()},e.prototype.getVirtualRectSize=function(){var t=this.nodes,r=[],n=[];t.forEach(function(c){var p=c.x,v=c.y,h=c.width,_=c.height,y=c.getNodeStyle().strokeWidth,m=y===void 0?0:y,S=p+h/2+m,M=p-h/2-m,A=v+_/2+m,b=v-_/2-m;r=r.concat([S,M].filter(function(g){return!Number.isNaN(g)})),n=n.concat([A,b].filter(function(g){return!Number.isNaN(g)}))});var o=Math.min.apply(Math,Ft([],mt(r),!1)),i=Math.max.apply(Math,Ft([],mt(r),!1)),a=Math.min.apply(Math,Ft([],mt(n),!1)),s=Math.max.apply(Math,Ft([],mt(n),!1)),l=i-o||0,u=s-a||0,f=o+l/2,d=a+u/2;return{width:l,height:u,x:f,y:d}},e.prototype.translateCenter=function(){var t=this,r=t.nodes,n=t.width,o=t.height,i=t.rootEl,a=t.transformModel;if(r.length){var s=n||i.clientWidth,l=o||i.clientHeight,u=this.getVirtualRectSize(),f=u.x,d=u.y;a.focusOn(f,d,s,l)}},e.prototype.fitView=function(t,r){t===void 0&&(t=20),r===void 0&&(r=20);var n=this,o=n.nodes,i=n.width,a=n.height,s=n.rootEl,l=n.transformModel;if(o.length){var u=i||s.clientWidth,f=a||s.clientHeight,d=this.getVirtualRectSize(),c=d.width,p=d.height,v=d.x,h=d.y,_=(c+r)/u,y=(p+t)/f,m=1/Math.max(_,y),S=[u/2,f/2];l.zoom(m,S),l.focusOn(v,h,u,f)}},e.prototype.openEdgeAnimation=function(t){var r=this.getEdgeModelById(t);r==null||r.openEdgeAnimation()},e.prototype.closeEdgeAnimation=function(t){var r=this.getEdgeModelById(t);r==null||r.closeEdgeAnimation()},e.prototype.getPartial=function(){return this.partial},e.prototype.setPartial=function(t){this.partial=t},e.prototype.destroy=function(){try{this.waitCleanEffects.forEach(function(t){t()})}catch(t){console.warn("error on destroy GraphModel",t)}this.waitCleanEffects.length=0,this.eventCenter.destroy()},N([O],e.prototype,"width",void 0),N([O],e.prototype,"height",void 0),N([O],e.prototype,"theme",void 0),N([O],e.prototype,"grid",void 0),N([O],e.prototype,"edgeType",void 0),N([O],e.prototype,"nodes",void 0),N([O],e.prototype,"edges",void 0),N([O],e.prototype,"fakeNode",void 0),N([O],e.prototype,"overlapMode",void 0),N([O],e.prototype,"background",void 0),N([O],e.prototype,"gridSize",void 0),N([O],e.prototype,"transformModel",void 0),N([O],e.prototype,"editConfigModel",void 0),N([O],e.prototype,"partial",void 0),N([at],e.prototype,"nodesMap",null),N([at],e.prototype,"edgesMap",null),N([at],e.prototype,"modelsMap",null),N([at],e.prototype,"sortElements",null),N([at],e.prototype,"textEditElement",null),N([at],e.prototype,"selectElements",null),N([at],e.prototype,"selectNodes",null),N([E],e.prototype,"setTextMode",null),N([E],e.prototype,"setFakeNode",null),N([E],e.prototype,"removeFakeNode",null),N([E],e.prototype,"setModel",null),N([E],e.prototype,"toFront",null),N([E],e.prototype,"setElementZIndex",null),N([E],e.prototype,"deleteNode",null),N([E],e.prototype,"addNode",null),N([E],e.prototype,"cloneNode",null),N([E],e.prototype,"moveNode",null),N([E],e.prototype,"moveNode2Coordinate",null),N([E],e.prototype,"editText",null),N([E],e.prototype,"addEdge",null),N([E],e.prototype,"moveEdge",null),N([E],e.prototype,"deleteEdgeBySourceAndTarget",null),N([E],e.prototype,"deleteEdgeById",null),N([E],e.prototype,"deleteEdgeBySource",null),N([E],e.prototype,"deleteEdgeByTarget",null),N([E],e.prototype,"setElementStateById",null),N([E],e.prototype,"updateText",null),N([E],e.prototype,"selectNodeById",null),N([E],e.prototype,"selectEdgeById",null),N([E],e.prototype,"selectElementById",null),N([E],e.prototype,"clearSelectElements",null),N([E],e.prototype,"moveNodes",null),N([E],e.prototype,"setDefaultEdgeType",null),N([E],e.prototype,"changeNodeType",null),N([E],e.prototype,"changeEdgeType",null),N([E],e.prototype,"getNodeIncomingEdge",null),N([E],e.prototype,"getNodeOutgoingEdge",null),N([E],e.prototype,"getAnchorIncomingEdge",null),N([E],e.prototype,"getAnchorOutgoingEdge",null),N([E],e.prototype,"getNodeIncomingNode",null),N([E],e.prototype,"getNodeOutgoingNode",null),N([E],e.prototype,"setTheme",null),N([E],e.prototype,"resize",null),N([E],e.prototype,"clearData",null),N([E],e.prototype,"translateCenter",null),N([E],e.prototype,"fitView",null),N([E],e.prototype,"openEdgeAnimation",null),N([E],e.prototype,"closeEdgeAnimation",null),N([E],e.prototype,"setPartial",null),e}(),Qe=function(){return Qe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Qe.apply(this,arguments)},Kr=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},DE=function(){function e(t){this.isShowHorizontal=!1,this.isShowVertical=!1,this.position={x:0,y:0},this.graphModel=t}return e.prototype.getStyle=function(){return Qe({},this.graphModel.theme.snapline)},e.prototype.getCenterSnapLine=function(t,r){for(var n=t.x,o=t.y,i=!1,a=!1,s=0;s<r.length;s++){var l=r[s];if(l.id!==t.id&&(n===l.x&&(i=!0),o===l.y&&(a=!0),i&&a))break}return{isShowVertical:i,isShowHorizontal:a,position:{x:n,y:o}}},e.prototype.getHorizontalSnapline=function(t,r){var n=!1,o=0,i=t.id,a;if(i){var s=this.graphModel.fakeNode;if(s&&s.id===i)a=Bt(s);else{var l=this.graphModel.getNodeModelById(i);l&&(a=Bt(l))}}for(var u=0;u<r.length;u++){var f=r[u];if(f.id!==t.id){var d=Bt(f);if(d.minY===(a==null?void 0:a.minY)||d.maxY===(a==null?void 0:a.minY)){n=!0,o=a.minY;break}if(d.minY===(a==null?void 0:a.maxY)||d.maxY===(a==null?void 0:a.maxY)){n=!0,o=a.maxY;break}}}return{isShowHorizontal:n,isShowVertical:this.isShowVertical,position:Qe(Qe({},this.position),{y:o})}},e.prototype.getVerticalSnapline=function(t,r){var n=!1,o=0,i=t.id,a;if(i){var s=this.graphModel.fakeNode;if(s&&s.id===i)a=Bt(s);else{var l=this.graphModel.getNodeModelById(i);l&&(a=Bt(l))}}for(var u=0;u<r.length;u++){var f=r[u];if(f.id!==t.id){var d=Bt(f);if(d.minX===(a==null?void 0:a.minX)||d.maxX===(a==null?void 0:a.minX)){n=!0,o=a.minX;break}if(d.minX===(a==null?void 0:a.maxX)||d.maxX===(a==null?void 0:a.maxX)){n=!0,o=a.maxX;break}}}return{isShowHorizontal:this.isShowHorizontal,isShowVertical:n,position:Qe(Qe({},this.position),{x:o})}},e.prototype.getSnapLinePosition=function(t,r){var n=this.getCenterSnapLine(t,r),o=n.isShowHorizontal,i=n.isShowVertical;if(!o){var a=this.getHorizontalSnapline(t,r);a.isShowHorizontal&&(n.isShowHorizontal=a.isShowHorizontal,n.position.y=a.position.y)}if(!i){var s=this.getVerticalSnapline(t,r);s.isShowVertical&&(n.isShowVertical=s.isShowVertical,n.position.x=s.position.x)}return n},e.prototype.setSnaplineInfo=function(t){var r=t.isShowHorizontal,n=t.isShowVertical,o=t.position;this.position=o,this.isShowHorizontal=r,this.isShowVertical=n},e.prototype.clearSnapline=function(){this.position={x:0,y:0},this.isShowHorizontal=!1,this.isShowVertical=!1},e.prototype.setNodeSnapLine=function(t){var r=this.graphModel.nodes,n=this.getSnapLinePosition(t,r);this.setSnaplineInfo(n)},Kr([O],e.prototype,"isShowHorizontal",void 0),Kr([O],e.prototype,"isShowVertical",void 0),Kr([O],e.prototype,"position",void 0),Kr([E],e.prototype,"clearSnapline",null),Kr([E],e.prototype,"setNodeSnapLine",null),e}(),Vt=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},vr=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},NE={false:[-1/0,-1/0,1/0,1/0],true:[-1/0,-1/0,1/0,1/0],vertical:[-1/0,0,1/0,0],horizontal:[0,-1/0,0,1/0]},CE=function(){function e(t,r){this.MINI_SCALE_SIZE=.2,this.MAX_SCALE_SIZE=16,this.SCALE_X=1,this.SKEW_Y=0,this.SKEW_X=0,this.SCALE_Y=1,this.TRANSLATE_X=0,this.TRANSLATE_Y=0,this.ZOOM_SIZE=.04,this.translateLimitMinX=-1/0,this.translateLimitMinY=-1/0,this.translateLimitMaxX=1/0,this.translateLimitMaxY=1/0,this.eventCenter=t;var n=r.stopMoveGraph,o=n===void 0?!1:n;this.updateTranslateLimits(o)}return e.prototype.setZoomMiniSize=function(t){this.MINI_SCALE_SIZE=t},e.prototype.setZoomMaxSize=function(t){this.MAX_SCALE_SIZE=t},e.prototype.HtmlPointToCanvasPoint=function(t){var r=vr(t,2),n=r[0],o=r[1];return[(n-this.TRANSLATE_X)/this.SCALE_X,(o-this.TRANSLATE_Y)/this.SCALE_Y]},e.prototype.CanvasPointToHtmlPoint=function(t){var r=vr(t,2),n=r[0],o=r[1];return[n*this.SCALE_X+this.TRANSLATE_X,o*this.SCALE_Y+this.TRANSLATE_Y]},e.prototype.moveCanvasPointByHtml=function(t,r,n){var o=vr(t,2),i=o[0],a=o[1];return[i+r/this.SCALE_X,a+n/this.SCALE_Y]},e.prototype.fixDeltaXY=function(t,r){return[t/this.SCALE_X,r/this.SCALE_Y]},e.prototype.getTransformStyle=function(){var t=[this.SCALE_X,this.SKEW_Y,this.SKEW_X,this.SCALE_Y,this.TRANSLATE_X,this.TRANSLATE_Y].join(",");return{transform:"matrix(".concat(t,")")}},e.prototype.zoom=function(t,r){t===void 0&&(t=!1);var n=this.SCALE_X,o=this.SCALE_Y;return typeof t=="number"?(n=t,o=t):t?(n+=this.ZOOM_SIZE,o+=this.ZOOM_SIZE):(n-=this.ZOOM_SIZE,o-=this.ZOOM_SIZE),n<this.MINI_SCALE_SIZE||n>this.MAX_SCALE_SIZE?"".concat(this.SCALE_X*100,"%"):(r&&(this.TRANSLATE_X-=(n-this.SCALE_X)*r[0],this.TRANSLATE_Y-=(o-this.SCALE_Y)*r[1]),this.SCALE_X=n,this.SCALE_Y=o,this.emitGraphTransform("zoom"),"".concat(this.SCALE_X*100,"%"))},e.prototype.emitGraphTransform=function(t){this.eventCenter.emit(R.GRAPH_TRANSFORM,{type:t,transform:{SCALE_X:this.SCALE_X,SKEW_Y:this.SKEW_Y,SKEW_X:this.SKEW_X,SCALE_Y:this.SCALE_Y,TRANSLATE_X:this.TRANSLATE_X,TRANSLATE_Y:this.TRANSLATE_Y}})},e.prototype.resetZoom=function(){this.SCALE_X=1,this.SCALE_Y=1,this.emitGraphTransform("resetZoom")},e.prototype.translate=function(t,r){this.TRANSLATE_X+t<=this.translateLimitMaxX&&this.TRANSLATE_X+t>=this.translateLimitMinX&&(this.TRANSLATE_X+=t),this.TRANSLATE_Y+r<=this.translateLimitMaxY&&this.TRANSLATE_Y+r>=this.translateLimitMinY&&(this.TRANSLATE_Y+=r),this.emitGraphTransform("translate")},e.prototype.focusOn=function(t,r,n,o){var i=vr(this.CanvasPointToHtmlPoint([t,r]),2),a=i[0],s=i[1],l=vr([n/2-a,o/2-s],2),u=l[0],f=l[1];this.TRANSLATE_X+=u,this.TRANSLATE_Y+=f,this.emitGraphTransform("focusOn")},e.prototype.updateTranslateLimits=function(t){var r;r=vr(Array.isArray(t)&&t.length===4?t:NE[t.toString()],4),this.translateLimitMinX=r[0],this.translateLimitMinY=r[1],this.translateLimitMaxX=r[2],this.translateLimitMaxY=r[3]},Vt([O],e.prototype,"SCALE_X",void 0),Vt([O],e.prototype,"SKEW_Y",void 0),Vt([O],e.prototype,"SKEW_X",void 0),Vt([O],e.prototype,"SCALE_Y",void 0),Vt([O],e.prototype,"TRANSLATE_X",void 0),Vt([O],e.prototype,"TRANSLATE_Y",void 0),Vt([O],e.prototype,"ZOOM_SIZE",void 0),Vt([E],e.prototype,"zoom",null),Vt([E],e.prototype,"resetZoom",null),Vt([E],e.prototype,"translate",null),Vt([E],e.prototype,"focusOn",null),e}(),RE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),jE=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},LE=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},IE=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},BE=function(e){RE(t,e);function t(){var r=e.apply(this,IE([],LE(arguments),!1))||this;return r.canvasOverlayRef=Yo(),r.getCanvasOverlay=function(){return r.canvasOverlayRef.current},r.handleResize=function(){var n=r.props,o=n.graphModel,i=n.options,a=o.width,s=o.height,l=o.isContainerWidth,u=o.isContainerHeight,f=a,d=s,c=!1;l&&(f=void 0,c=!0),u&&(d=void 0,c=!0),c&&o.resize(f,d),i.width=a,i.height=s},r.throttleResize=fm(r.handleResize,200),r}return t.prototype.componentDidMount=function(){window.addEventListener("resize",this.throttleResize)},t.prototype.componentDidUpdate=function(){var r=this.props.graphModel.modelToGraphData();this.props.graphModel.eventCenter.emit(R.GRAPH_UPDATED,{data:r})},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.throttleResize)},t.prototype.getComponent=function(r,n,o){o===void 0&&(o="canvas-overlay");var i=this.props.getView,a=i(r.type);return a?w(a,{model:r,graphModel:n,overlay:o},r.id):null},t.prototype.render=function(){var r=this,n=this.props,o=n.graphModel,i=n.tool,a=n.options,s=n.dnd,l=n.snaplineModel,u={};a.width&&(u.width="".concat(o.width,"px")),a.height&&(u.height="".concat(o.height,"px"));var f=o.fakeNode,d=o.editConfigModel,c=o.background,p=d.adjustEdge;return w("div",{className:"lf-graph","flow-id":o.flowId,style:u,children:[w(iE,{ref:this.canvasOverlayRef,graphModel:o,dnd:s,children:[w("g",{className:"lf-base",children:Pe(o.sortElements,function(v){return r.getComponent(v,o)})}),f?this.getComponent(f,o):""]}),w(yE,{graphModel:o,children:[w(mE,{graphModel:o}),p?w(lE,{graphModel:o}):"",a.snapline!==!1?w(bE,{snaplineModel:l}):""]}),w(AE,{graphModel:o,tool:i,getCanvasOverlay:this.getCanvasOverlay}),c&&w(fE,{background:c}),w(Io,{graphModel:o})]})},t=jE([$t],t),t}(W),$E=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),fe=function(){return fe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},fe.apply(this,arguments)},XE=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},FE=function(e){$E(t,e);function t(){var r=e.call(this)||this;return r.onDragStart=function(n){var o=n.event,i=r.props,a=i.anchorData,s=i.nodeModel,l=i.graphModel;l.selectNodeById(s.id),s.autoToFront&&l.toFront(s.id),l.eventCenter.emit(R.ANCHOR_DRAGSTART,{data:a,e:o,nodeModel:s}),r.setState({startX:a.x,startY:a.y,endX:a.x,endY:a.y})},r.onDragging=function(n){var o=n.event,i=r.props,a=i.graphModel,s=i.nodeModel,l=i.anchorData,u=a.transformModel,f=a.eventCenter,d=a.width,c=a.height,p=a.editConfigModel,v=p.autoExpand,h=p.stopMoveGraph;if(o){var _=o.clientX,y=o.clientY,m=a.getPointByClient({x:_,y}),S=m.domOverlayPosition,M=S.x,A=S.y,b=m.canvasOverlayPosition,g=b.x,x=b.y;r.t&&Lo(r.t);var T=[],P=10;M<10?T=[P,0]:M+10>d?T=[-10,0]:A<10?T=[0,P]:A+10>c&&(T=[0,-10]),r.setState({endX:g,endY:x,dragging:!0}),r.moveAnchorEnd(g,x),T.length>0&&!h&&v&&(r.t=af(function(){var j=XE(T,2),L=j[0],U=j[1];u.translate(L,U);var D=r.state,tt=D.endX,et=D.endY;r.setState({endX:tt-L,endY:et-U}),r.moveAnchorEnd(tt-L,et-U)})),f.emit(R.ANCHOR_DRAG,{data:l,e:o,nodeModel:s})}},r.onDragEnd=function(n){var o=n.event;r.t&&Lo(r.t);var i=r.checkEnd(o);r.setState({startX:0,startY:0,endX:0,endY:0,dragging:!1}),r.sourceRuleResults.clear(),r.targetRuleResults.clear();var a=r.props,s=a.graphModel,l=a.nodeModel,u=a.anchorData;s.eventCenter.emit(R.ANCHOR_DRAGEND,{data:u,e:o,nodeModel:l,edgeModel:i??void 0})},r.checkEnd=function(n){var o,i=r.props,a=i.graphModel,s=i.nodeModel,l=i.anchorData,u=l.x,f=l.y,d=l.id,c=r.state,p=c.endX,v=c.endY,h=c.dragging,_=Ro({x:p,y:v},a);if(r.preTargetNode&&r.preTargetNode.state!==J.DEFAULT&&r.preTargetNode.setElementState(J.DEFAULT),!!h&&_&&_.node){var y=_.node,m=_.anchor.id,S="".concat(s.id,"_").concat(y.id,"_").concat(m,"_").concat(d),M=r.sourceRuleResults.get(S)||{},A=M.isAllPass,b=M.msg,g=r.targetRuleResults.get(S)||{},x=g.isAllPass,T=g.msg;if(A&&x){y.setElementState(J.DEFAULT);var P=a.getNodeModelById(_.node.id),j=(o=a.edgeGenerator)===null||o===void 0?void 0:o.call(a,s.getData(),P==null?void 0:P.getData()),L=a.addEdge(fe(fe({},j),{sourceNodeId:s.id,sourceAnchorId:d,startPoint:{x:u,y:f},targetNodeId:_.node.id,targetAnchorId:_.anchor.id,endPoint:{x:_.anchor.x,y:_.anchor.y}})),U=r.props.anchorData;return a.eventCenter.emit(R.ANCHOR_DROP,{data:U,e:n,nodeModel:s,edgeModel:L}),L}var D=y.getData();return a.eventCenter.emit(R.CONNECTION_NOT_ALLOWED,{data:D,msg:T||b||""}),null}},r.sourceRuleResults=new Map,r.targetRuleResults=new Map,r.state={startX:0,startY:0,endX:0,endY:0,dragging:!1},r.dragHandler=new Ee({onDragStart:r.onDragStart,onDragging:r.onDragging,onDragEnd:r.onDragEnd}),r}return t.prototype.getAnchorShape=function(){var r=this.props,n=r.anchorData,o=r.style,i=r.node,a=i.getAnchorShape(n);if(a)return a;var s=n.x,l=n.y,u=fe(fe({},o),o==null?void 0:o.hover);return w("g",{children:[w(Fr,fe({className:"lf-node-anchor-hover"},u,{x:s,y:l})),w(Fr,fe({className:"lf-node-anchor"},o,{x:s,y:l}))]})},Object.defineProperty(t.prototype,"customTrajectory",{get:function(){var r=this.props.graphModel.customTrajectory;return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"relateEdges",{get:function(){var r=this.props,n=r.graphModel,o=n.getAnchorIncomingEdge,i=n.getAnchorOutgoingEdge,a=r.anchorData.id;return{incomingEdgeList:o(a),outgoingEdgeList:i(a)}},enumerable:!1,configurable:!0}),t.prototype.moveAnchorEnd=function(r,n){var o,i,a=this.props,s=a.graphModel,l=a.nodeModel,u=a.anchorData,f=Ro({x:r,y:n},s);if(f){var d=f.node,c=f.anchor.id;if(this.preTargetNode&&this.preTargetNode!==f.node&&this.preTargetNode.setElementState(J.DEFAULT),u.id===c)return;this.preTargetNode=d;var p="".concat(l.id,"_").concat(d.id,"_").concat(c,"_").concat(u.id);if(!this.targetRuleResults.has(p)){var v=f.anchor,h=l.isAllowConnectedAsSource(d,u,v),_=d.isAllowConnectedAsTarget(l,u,v);this.sourceRuleResults.set(p,jo(h)),this.targetRuleResults.set(p,jo(_))}var y=((o=this.sourceRuleResults.get(p))!==null&&o!==void 0?o:{}).isAllPass,m=((i=this.targetRuleResults.get(p))!==null&&i!==void 0?i:{}).isAllPass;y&&m?d.setElementState(J.ALLOW_CONNECT):d.setElementState(J.NOT_ALLOW_CONNECT)}else this.preTargetNode&&this.preTargetNode.state!==J.DEFAULT&&this.preTargetNode.setElementState(J.DEFAULT)},t.prototype.isShowLine=function(){var r=this.state,n=r.startX,o=r.startY,i=r.endX,a=r.endY,s=te(n,o,i,a);return s>10},t.prototype.render=function(){var r=this,n=this.state,o=n.startX,i=n.startY,a=n.endX,s=n.endY,l=this.props,u=l.anchorData,f=l.edgeStyle,d=l.nodeModel,c=l.graphModel,p=u.edgeAddable;return w("g",{className:"lf-anchor",children:[w("g",{onClick:function(v){v.stopPropagation(),c.eventCenter.emit(R.ANCHOR_CLICK,{data:u,e:v,nodeModel:d})},onMouseDown:function(v){c.eventCenter.emit(R.ANCHOR_MOUSEDOWN,{data:u,e:v,nodeModel:d}),p!==!1&&r.dragHandler.handleMouseDown(v)},children:this.getAnchorShape()}),this.isShowLine()&&(this.customTrajectory?this.customTrajectory(fe({sourcePoint:{x:o,y:i},targetPoint:{x:a,y:s}},f)):w(Xr,fe({x1:o,y1:i,x2:a,y2:s},f,{"pointer-events":"none"})))]})},t}(W),kE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),la=function(){return la=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},la.apply(this,arguments)},HE=function(e){kE(t,e);function t(r){var n=e.call(this,r)||this;return n.style={},n.onDragging=function(o){var i,a=o.event,s=n.props,l=s.graphModel,u=s.nodeModel,f=s.eventCenter,d=l.selectNodes,c=u.x,p=u.y,v=a.clientX,h=a.clientY,_=l.getPointByClient({x:v,y:h}).canvasOverlayPosition,y=_.x,m=_.y,S=new St(y-c,m-p),M=((i=n.normal)===null||i===void 0?void 0:i.angle(S))-n.defaultAngle,A=new No(-c,-p).rotate(M).translate(c,p).toString();u.transform=A,u.rotate=M;var b=Pe(d,function(x){return x.id});b.indexOf(u.id)===-1&&(b=[u.id]);var g=lm(b,function(x,T){var P=l.getNodeModelById(T);return x[T]=P==null?void 0:P.getMoveDistance(0,0,!1),x},{});b.forEach(function(x){var T=l.getNodeEdges(x);T.forEach(function(P){if(g[P.sourceNodeId]){var j=l.getNodeModelById(P.sourceNodeId),L=j.anchors.find(function(U){return U.id===P.sourceAnchorId});P.updateStartPoint(L)}if(g[P.targetNodeId]){var j=l.getNodeModelById(P.targetNodeId),L=j.anchors.find(function(tt){return tt.id===P.targetAnchorId});P.updateEndPoint(L)}})}),f.emit(R.NODE_ROTATE,{e:a,model:u,data:u.getData()})},n.style=r.style,n.stepperDrag=new Ee({onDragging:n.onDragging}),n}return t.prototype.render=function(){var r=this,n=this.props.nodeModel,o=n.x,i=n.y,a=n.width,s=n.height,l=o+a/2+20,u=i-s/2-20;return this.normal=new St(1,0),this.defaultAngle=this.normal.angle(new St(l-o,u-i)),n.defaultAngle=this.defaultAngle,w("g",{className:"lf-rotate-control",children:w("g",{onMouseDown:function(f){r.stepperDrag.handleMouseDown(f)},children:w(Fr,la({},this.style,{cx:l,cy:u}))})})},t}(W),cf={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function r(){for(var i="",a=0;a<arguments.length;a++){var s=arguments[a];s&&(i=o(i,n(s)))}return i}function n(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return r.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var a="";for(var s in i)t.call(i,s)&&i[s]&&(a=o(a,s));return a}function o(i,a){return a?i?i+" "+a:i+a:i}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(cf);var YE=cf.exports;const GE=vu(YE);var UE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ua=function(){return ua=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ua.apply(this,arguments)},zE=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},pf=function(e){UE(t,e);function t(r){var n=e.call(this)||this;n.mouseDownHandler=function(i){var a=n.props,s=a.draggable,l=a.model,u=a.graphModel,f=u.editConfigModel.nodeTextDraggable;(s??f)&&(i.stopPropagation(),n.stepperDrag.model=l,n.stepperDrag.handleMouseDown(i))},n.onDragging=function(i){var a=i.deltaX,s=i.deltaY,l=n.props,u=l.model,f=l.graphModel.transformModel;if(a||s){var d=zE(f.fixDeltaXY(a,s),2),c=d[0],p=d[1];u.moveText(c,p)}},n.dbClickHandler=function(){var i=n.props,a=i.editable,s=i.graphModel.eventCenter,l=i.model;a&&l.setElementState(J.TEXT_EDIT),s.emit(R.TEXT_DBCLICK,{data:l.text,model:l})};var o=r.draggable;return n.stepperDrag=new Ee({onDragging:n.onDragging,step:1,eventType:"TEXT",isStopPropagation:o}),n}return t.prototype.getShape=function(){var r=this.props,n=r.model,o=r.graphModel,i=o.editConfigModel,a=n.text,s=a.value,l=a.x,u=a.y,f=a.editable,d=a.draggable,c={x:l,y:u,className:"",value:s},p=n.getTextStyle(),v=i.nodeTextDraggable||d;return w(sf,ua({},c,p,{className:GE({"lf-element-text":f,"lf-text-draggable":!f&&v,"lf-text-disabled":!f&&!v}),model:n}))},t.prototype.render=function(){var r=this.props.model.text;if(r)return w("g",{onMouseDown:this.mouseDownHandler,onDblClick:this.dbClickHandler,children:this.getShape()})},t}(W),WE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Kt=function(){return Kt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Kt.apply(this,arguments)},ro=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},VE=function(e){WE(t,e);function t(r){var n=e.call(this,r)||this;return n.setHoverOn=function(){n.setState({isHovered:!0})},n.setHoverOff=function(){n.setState({isHovered:!1})},n.state={isHovered:!1},n}return t.prototype.getBackground=function(){var r=this.state.isHovered,n=this.props.model,o=n.text,i=n.getTextStyle(),a=i.background||{};if(r&&i.hover&&i.hover.background&&(a=Kt(Kt({},a),i.hover.background)),o!=null&&o.value&&(a==null?void 0:a.fill)!=="transparent"){var s=i.fontSize,l=i.textWidth,u=i.lineHeight,f=i.overflowMode,d=a.wrapPadding,c=o==null?void 0:o.value.split(/[\r\n]/g),p=c.length,v=o.x,h=o.y,_={};if(f==="autoWrap"&&l){var y=of({rows:c,style:{fontSize:"".concat(s,"px"),width:"".concat(l,"px"),lineHeight:u,padding:d},rowsLength:p,className:"lf-get-text-height"});_=Kt(Kt({},a),{x:v,y:h,width:l,height:y})}else{var m=Xm({rows:c,rowsLength:p,fontSize:s}),S=m.width,M=m.height;if(f==="ellipsis"&&(S=l,M=s+2),typeof a.wrapPadding=="string"){var A=a.wrapPadding.split(",").filter(function(Et){return Et.trim()}).map(function(Et){return parseFloat(Et.trim())});if(A.length>0&&A.length<=4){if(A.length===1){var b=ro(A,1),g=b[0];A=[g,g,g,g]}else if(A.length===2){var x=ro(A,2),T=x[0],P=x[1];A=[T,P,T,P]}else if(A.length===3){var j=ro(A,3),L=j[0],P=j[1],U=j[2];A=[L,P,U,P]}var D=ro(A,4),tt=D[0],et=D[1],jt=D[2],zt=D[3];S+=et+zt,M+=tt+jt,v=v+(et-zt)/2,h=h+(jt-tt)/2}}_=Kt(Kt({},a),{x:v-1,y:h-1,width:S,height:M})}return w(ye,Kt({},_))}return null},t.prototype.getShape=function(){var r=this.props.model,n=r.text,o=n.x,i=n.y,a=n.value;if(!a)return null;var s=r.getTextStyle(),l=Kt({x:o,y:i,value:a,model:r,className:"lf-element-text"},s);return w("g",{className:"lf-line-text",onMouseEnter:this.setHoverOn,onMouseLeave:this.setHoverOff,children:[this.getBackground(),w(sf,Kt({},l))]})},t}(pf),KE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bo=function(){return Bo=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Bo.apply(this,arguments)},ZE=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},no=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Ke=function(e){KE(t,e);function t(r){var n=e.call(this)||this;n.onDragStart=function(l){var u=l.event,f=n.props,d=f.model,c=f.graphModel;if(u){var p=c.getPointByClient({x:u.clientX,y:u.clientY}).canvasOverlayPosition,v=p.x,h=p.y;n.moveOffset={dx:d.x-v,dy:d.y-h}}},n.onDragging=function(l){var u,f,d,c,p=l.event,v=n.props,h=v.model,_=v.graphModel,y=_.editConfigModel,m=y.stopMoveGraph,S=y.autoExpand,M=y.snapGrid,A=_.transformModel,b=_.selectNodes,g=_.width,x=_.height,T=_.gridSize;h.isDragging=!0;var P=p,j=P.clientX,L=P.clientY,U=_.getPointByClient({x:j,y:L}).canvasOverlayPosition,D=U.x,tt=U.y,et=no(A.CanvasPointToHtmlPoint([D,tt]),2),jt=et[0],zt=et[1];if(D=D+((f=(u=n.moveOffset)===null||u===void 0?void 0:u.dx)!==null&&f!==void 0?f:0),tt=tt+((c=(d=n.moveOffset)===null||d===void 0?void 0:d.dy)!==null&&c!==void 0?c:0),D=$r(D,T,M),tt=$r(tt,T,M),!g||!x){_.moveNode2Coordinate(h.id,D,tt);return}var Et=jt<0||zt<0||jt>g||zt>x;if(!(S&&!m&&Et)){var Tt=no(A.CanvasPointToHtmlPoint([D-h.width/2,tt-h.height/2]),2),X=Tt[0],V=Tt[1],nt=no(A.CanvasPointToHtmlPoint([D+h.width/2,tt+h.height/2]),2),z=nt[0],dt=nt[1],Nt=Math.max(T,20),K=[];X<0?K=[Nt,0]:z>_.width?K=[-Nt,0]:V<0?K=[0,Nt]:dt>_.height&&(K=[0,-Nt]),n.t&&Lo(n.t);var vt=b.map(function(Wt){return Wt.id});vt.indexOf(h.id)===-1&&(vt=[h.id]),K.length>0&&!m&&S?n.t=af(function(){var Wt=no(K,2),Pt=Wt[0],Re=Wt[1];A.translate(Pt??0,Re??0);var li=-(Pt??0)/A.SCALE_X,gf=-(Re??0)/A.SCALE_X;_.moveNodes(vt,li,gf)}):_.moveNodes(vt,D-h.x,tt-h.y)}},n.onDragEnd=function(){n.t&&Lo(n.t);var l=n.props.model;l.isDragging=!1},n.onMouseOut=function(l){vm()&&n.setHoverOff(l)},n.handleMouseUp=function(){var l=n.props.model;n.mouseUpDrag=l.isDragging},n.handleClick=function(l){var u=n.mouseUpDrag===!1;if(n.startTime){var f=n.props,d=f.model,c=f.graphModel;if(u){var p=d.getData(),v=c.getPointByClient({x:l.clientX,y:l.clientY}),h={data:p,e:l,position:v,isSelected:!1,isMultiple:!1},_=l.button===2,y=l.detail===2;if(!_){var m=c.editConfigModel,S=rf(l,m);h.isMultiple=S,d.isSelected&&!y&&S?(h.isSelected=!1,d.setSelected(!1)):(c.selectNodeById(d.id,S),h.isSelected=!0,m.isSilentMode||n.toFront()),y?(m.nodeTextEdit&&d.text.editable&&m.textMode===Yt.TEXT&&(d.setSelected(!1),c.setElementStateById(d.id,J.TEXT_EDIT)),c.eventCenter.emit(R.NODE_DBCLICK,h)):(c.eventCenter.emit(R.ELEMENT_CLICK,h),c.eventCenter.emit(R.NODE_CLICK,h))}}}},n.handleContextMenu=function(l){l.preventDefault();var u=n.props,f=u.model,d=u.graphModel,c=d.editConfigModel,p=f.getData(),v=d.getPointByClient({x:l.clientX,y:l.clientY});d.setElementStateById(f.id,J.SHOW_MENU,v.domOverlayPosition),f.isSelected||d.selectNodeById(f.id),d.eventCenter.emit(R.NODE_CONTEXTMENU,{data:p,e:l,position:v}),c.isSilentMode||n.toFront()},n.handleMouseDown=function(l){var u=n.props,f=u.model,d=u.graphModel;n.startTime=new Date().getTime();var c=d.editConfigModel;c.adjustNodePosition&&f.draggable&&n.stepDrag&&n.stepDrag.handleMouseDown(l)},n.handleFocus=function(){var l=n.props,u=l.model,f=l.graphModel;f.eventCenter.emit(R.NODE_FOCUS,{data:u.getData()})},n.handleBlur=function(){var l=n.props,u=l.model,f=l.graphModel;f.eventCenter.emit(R.NODE_BLUR,{data:u.getData()})},n.setHoverOn=function(l){var u=n.props,f=u.model,d=u.graphModel;if(!f.isHovered){var c=f.getData();f.setHovered(!0),d.eventCenter.emit(R.NODE_MOUSEENTER,{data:c,e:l})}},n.setHoverOff=function(l){var u=n.props,f=u.model,d=u.graphModel,c=f.getData();f.isHovered&&(f.setHovered(!1),d.eventCenter.emit(R.NODE_MOUSELEAVE,{data:c,e:l}))};var o=r.graphModel,i=o.gridSize,a=o.eventCenter,s=r.model;return n.stepDrag=new Ee({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:i,eventType:"NODE",isStopPropagation:!1,eventCenter:a,model:s}),n.modelDisposer=Wu(function(){return n.props},function(l){l&&l.model&&n.stepDrag.setModel(l.model)}),n}return t.prototype.componentWillUnmount=function(){this.modelDisposer&&this.modelDisposer(),this.render.$mobx&&this.render.$mobx.dispose()},t.prototype.componentDidMount=function(){},t.prototype.componentDidUpdate=function(){},t.prototype.getAnchorShape=function(r){return null},t.prototype.getAnchors=function(){var r=this,n=this.props,o=n.model,i=n.graphModel,a=o.isSelected,s=o.isHitable,l=o.isDragging,u=o.isShowAnchor;return s&&(a||u)&&!l?Pe(o.anchors,function(f,d){var c=o.getAnchorLineStyle(f),p=o.getAnchorStyle(f);return w(FE,{anchorData:f,node:r,style:p,edgeStyle:c,anchorIndex:d,nodeModel:o,graphModel:i,setHoverOff:r.setHoverOff})}):[]},t.prototype.getRotateControl=function(){var r=this.props,n=r.model,o=r.graphModel,i=o.editConfigModel,a=i.isSilentMode,s=i.allowRotate,l=n.isSelected,u=n.isHitable,f=n.rotatable,d=n.isHovered,c=s&&f,p=n.getRotateControlStyle();if(!a&&u&&(l||d)&&c)return w(HE,{graphModel:o,nodeModel:n,eventCenter:o.eventCenter,style:p})},t.prototype.getResizeControl=function(){var r=this.props,n=r.model,o=r.graphModel,i=o.editConfigModel,a=i.isSilentMode,s=i.allowResize,l=n.isSelected,u=n.isHitable,f=n.resizable,d=n.isHovered,c=s&&f,p=n.getResizeControlStyle();return!a&&u&&(l||d)&&c?w(hx,{style:p,model:n,graphModel:o}):null},t.prototype.getText=function(){var r,n=this.props,o=n.model,i=n.graphModel,a=i.editConfigModel;if(a.nodeTextMode!==Yt.TEXT||o.state===J.TEXT_EDIT)return null;if(o.text){var s=!1;return a.nodeTextDraggable&&o.text.draggable&&(s=!0),w(pf,{editable:a.nodeTextEdit&&((r=o.text.editable)!==null&&r!==void 0?r:!0),model:o,graphModel:i,draggable:s})}return null},t.prototype.getStateClassName=function(){var r=this.props.model,n=r.state,o=r.isDragging,i=r.isSelected,a="lf-node";switch(n){case J.ALLOW_CONNECT:a+=" lf-node-allow";break;case J.NOT_ALLOW_CONNECT:a+=" lf-node-not-allow";break;default:a+=" lf-node-default";break}return o&&(a+=" lf-dragging"),i&&(a+=" lf-node-selected"),a},t.prototype.toFront=function(){var r=this.props,n=r.model,o=r.graphModel;n.autoToFront&&o.toFront(n.id)},t.prototype.render=function(){var r=this.props,n=r.model,o=r.graphModel,i=o.editConfigModel,a=i.hideAnchors,s=i.adjustNodePosition,l=i.allowRotate,u=i.allowResize,f=o.gridSize,d=o.transformModel.SCALE_X,c=n.isHitable,p=n.draggable,v=n.transform,h=n.getOuterGAttributes(),_=h.className,y=_===void 0?"":_,m=ZE(h,["className"]),S=w("g",{className:"lf-node-content",children:[w("g",{transform:v,children:[this.getShape(),this.getText(),l&&this.getRotateControl(),u&&this.getResizeControl()]}),!a&&this.getAnchors()]}),M;return c?(s&&p&&this.stepDrag.setStep(f*d),M=w("g",Bo({className:"".concat(this.getStateClassName()," ").concat(y),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,onMouseEnter:this.setHoverOn,onMouseOver:this.setHoverOn,onMouseLeave:this.setHoverOff,onMouseOut:this.onMouseOut,onContextMenu:this.handleContextMenu,onFocus:this.handleFocus,onBlur:this.handleBlur},m,{children:S}))):M=w("g",Bo({className:"".concat(this.getStateClassName()," ").concat(y)},m,{children:S})),M},t.isObserved=!1,t}(W),qE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),da=function(){return da=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},da.apply(this,arguments)},tu=function(e){qE(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getShape=function(){var r=this.props.model,n=r.getNodeStyle();return w(ye,da({},n,{x:r.x,y:r.y,width:r.width,height:r.height,radius:r.radius}))},t}(Ke),JE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),fa=function(){return fa=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},fa.apply(this,arguments)},eu=function(e){JE(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getShape=function(){var r=this.props.model,n=r.x,o=r.y,i=r.r,a=r.getNodeStyle();return w(Fr,fa({},a,{x:n,y:o,r:i}))},t}(Ke),QE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$o=function(){return $o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$o.apply(this,arguments)},ru=function(e){QE(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getShape=function(){var r=this.props.model,n=r,o=n.x,i=n.y,a=n.width,s=n.height,l=n.points,u=r.getNodeStyle(),f={transform:"matrix(1 0 0 1 ".concat(o-a/2," ").concat(i-s/2,")")};return w("g",$o({},f,{children:w(lf,$o({},u,{points:l,x:o,y:i}))}))},t}(Ke),t0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ca=function(){return ca=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ca.apply(this,arguments)},nu=function(e){t0(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getShape=function(){var r=this.props.model,n=r.getNodeStyle();return w("g",{children:w(lf,ca({},n,{points:r.points,x:r.x,y:r.y}))})},t}(Ke),e0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pa=function(){return pa=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},pa.apply(this,arguments)},ou=function(e){e0(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getShape=function(){var r=this.props.model,n=r.getNodeStyle();return w(sx,pa({},n,{x:r.x,y:r.y,rx:r.rx,ry:r.ry}))},t}(Ke),r0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),hn=function(){return hn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},hn.apply(this,arguments)},iu=function(e){r0(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getBackground=function(){var r=this.props.model,n=r.getTextStyle(),o=r.width,i=r.height,a=r.x,s=r.y,l=hn(hn({},n.background),{x:a,y:s,width:o,height:i});return w(ye,hn({},l))},t.prototype.getResizeControl=function(){return null},t.prototype.getShape=function(){return w("g",{children:this.getBackground()})},t}(Ke),n0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ha=function(){return ha=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ha.apply(this,arguments)},o0=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},i0=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},au=function(e){n0(t,e);function t(){var r=e.apply(this,i0([],o0(arguments),!1))||this;return r.ref=Yo(),r}return Object.defineProperty(t.prototype,"rootEl",{get:function(){return this.ref.current},enumerable:!1,configurable:!0}),t.prototype.setHtml=function(r){r.appendChild(document.createElement("div"))},t.prototype.confirmUpdate=function(r){this.setHtml(r)},t.prototype.shouldUpdate=function(){return this.preProperties&&this.preProperties===this.currentProperties?!1:(this.preProperties=this.currentProperties,!0)},t.prototype.componentDidMount=function(){this.shouldUpdate()&&this.rootEl&&this.setHtml(this.rootEl)},t.prototype.componentDidUpdate=function(){this.shouldUpdate()&&this.rootEl&&this.confirmUpdate(this.rootEl)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.rootEl.innerHTML=""},t.prototype.getShape=function(){var r=this.props.model,n=r.x,o=r.y,i=r.height,a=r.width,s=r.getNodeStyle();return this.currentProperties=JSON.stringify(r.properties),w("foreignObject",ha({},s,{x:n-a/2,y:o-i/2,width:a,height:i,ref:this.ref}))},t}(Ke),a0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zt=function(){return Zt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Zt.apply(this,arguments)},s0=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},l0=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},he;(function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"})(he||(he={}));var su=function(e){a0(t,e);function t(r){var n=e.call(this)||this;n.handleMouseDown=function(l){n.stepDrag&&n.stepDrag.handleMouseDown(l)},n.onDragStart=function(){var l=n.props,u=l.x,f=l.y,d=l.edgeModel,c=d.startPoint,p=d.endPoint,v=d.pointsList;n.oldEdge={startPoint:c,endPoint:p,pointsList:v},n.setState({endX:u,endY:f,dragging:!0})},n.onDragging=function(l){var u=l.deltaX,f=l.deltaY,d=n.state,c=d.endX,p=d.endY,v=n.props,h=v.graphModel,_=v.type,y=h.transformModel,m=h.editConfigModel,S=l0(y.moveCanvasPointByHtml([c,p],u,f),2),M=S[0],A=S[1];n.setState({endX:M,endY:A,dragging:!0});var b=n.props.edgeModel,g=Ro({x:c,y:p},h);if(g&&g.node&&n.isAllowAdjust(g).pass){var x=b.startPoint,T=b.endPoint,P=b.sourceNode,j=b.targetNode,L=_===he.SOURCE?{startPoint:{x:g.anchor.x,y:g.anchor.y},endPoint:{x:T.x,y:T.y},sourceNode:g.node,targetNode:j}:{startPoint:{x:x.x,y:x.y},endPoint:{x:g.anchor.x,y:g.anchor.y},sourceNode:P,targetNode:g.node};b.updateAfterAdjustStartAndEnd(L)}else _===he.SOURCE?b.updateStartPoint({x:M,y:A}):b.updateEndPoint({x:M,y:A});b.text.value&&m.adjustEdge&&b.setText(Object.assign({},b.text,b.textPosition))},n.onDragEnd=function(l){var u,f,d,c=l.event;try{n.setState({dragging:!1});var p=n.props,v=p.graphModel,h=p.edgeModel,_=p.type,y=n.state,m=y.endX,S=y.endY,M=y.dragging,A=Ro({x:m,y:S},v);if(!M)return;var b=!1,g=void 0;if(A&&A.node){var x=n.isAllowAdjust(A),T=x.pass,P=x.msg,j=x.newTargetNode;if(T){var L=h.getData(),U=L.text,D=L.sourceAnchorId,tt=D===void 0?"":D,et=L.targetAnchorId,jt=et===void 0?"":et,zt=s0(L,["text","sourceAnchorId","targetAnchorId"]);if(g=Zt(Zt({sourceAnchorId:tt,targetAnchorId:jt},zt),{text:(U==null?void 0:U.value)||""}),_===he.SOURCE){var Et=v.getNodeModelById(A.node.id),Tt=v.getNodeModelById(h.targetNodeId),X=(u=v.edgeGenerator)===null||u===void 0?void 0:u.call(v,Et==null?void 0:Et.getData(),Tt==null?void 0:Tt.getData(),g);g=Zt(Zt({},X),{sourceNodeId:A.node.id,sourceAnchorId:A.anchor.id,startPoint:{x:A.anchor.x,y:A.anchor.y},targetNodeId:h.targetNodeId,endPoint:Zt({},h.endPoint)}),h.sourceNodeId===A.node.id&&h.sourceAnchorId===A.anchor.id&&(b=!0)}else if(_===he.TARGET){var Et=v.getNodeModelById(h.sourceNodeId),Tt=v.getNodeModelById(A.node.id),X=(f=v.edgeGenerator)===null||f===void 0?void 0:f.call(v,Et==null?void 0:Et.getData(),Tt==null?void 0:Tt.getData(),g);g=Zt(Zt({},X),{sourceNodeId:h.sourceNodeId,startPoint:Zt({},h.startPoint),targetNodeId:A.node.id,targetAnchorId:A.anchor.id,endPoint:{x:A.anchor.x,y:A.anchor.y}}),h.targetNodeId===A.node.id&&h.targetAnchorId===A.anchor.id&&(b=!0)}}else{b=!0;var V=j.getData();v.eventCenter.emit(R.CONNECTION_NOT_ALLOWED,{data:V,msg:P})}}else b=!0;if(b)n.recoveryEdge();else{var nt=h.getData();v.deleteEdgeById(h.id);var z=v.addEdge(Zt({},g));v.eventCenter.emit(R.EDGE_EXCHANGE_NODE,{data:{newEdge:z.getData(),oldEdge:nt}})}(d=n.preTargetNode)===null||d===void 0||d.setElementState(J.DEFAULT)}finally{var v=n.props.graphModel;v.eventCenter.emit(R.ADJUST_POINT_DRAGEND,{e:c,data:n.stepDragData})}},n.recoveryEdge=function(){var l=n.props.edgeModel,u=n.oldEdge,f=u.startPoint,d=u.endPoint,c=u.pointsList;l.updateStartPoint(f),l.updateEndPoint(d),l.modelType!==G.LINE_EDGE&&(l.pointsList=c??[],l.initPoints())},n.getAdjustPointStyle=function(){var l=n.props.graphModel.theme,u=l.edgeAdjust;return u},n.state={dragging:!1,endX:0,endY:0},n.targetRuleResults=new Map,n.sourceRuleResults=new Map;var o=r.type,i=r.edgeModel,a=r.graphModel,s=a.eventCenter;return n.stepDragData={type:o,edgeData:i.getData()},n.stepDrag=new Ee({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,eventType:"ADJUST_POINT",isStopPropagation:!1,eventCenter:s,data:n.stepDragData}),n}return t.prototype.isAllowAdjust=function(r){var n=this.props,o=n.edgeModel,i=o.id,a=o.sourceNode,s=o.targetNode,l=o.sourceAnchorId,u=o.targetAnchorId,f=n.type,d,c,p,v;if(f===he.SOURCE?(d=r.node,c=s,p=r.anchor,v=s.getAnchorInfo(u)):(d=a,c=r.node,v=r.anchor,p=a.getAnchorInfo(l)),this.preTargetNode&&this.preTargetNode!==r.node&&this.preTargetNode.setElementState(J.DEFAULT),this.preTargetNode=r.node,v.id===p.id)return{pass:!1,msg:"",newTargetNode:c};var h="".concat(d.id,"_").concat(c.id,"_").concat(p.id,"_").concat(v.id);if(!this.targetRuleResults.has(h)){var _=d.isAllowConnectedAsSource(c,p,v,i),y=c.isAllowConnectedAsTarget(d,p,v,i);this.sourceRuleResults.set(h,jo(_)),this.targetRuleResults.set(h,jo(y))}var m=this.sourceRuleResults.get(h),S=m.isAllPass,M=m.msg,A=this.targetRuleResults.get(h),b=A.isAllPass,g=A.msg,x=S&&b?J.ALLOW_CONNECT:J.NOT_ALLOW_CONNECT;return f===he.SOURCE?d.setElementState(x):c.setElementState(x),{pass:S&&b,msg:g||M,newTargetNode:c}},t.prototype.render=function(){var r=this.props,n=r.x,o=r.y,i=r.getAdjustPointShape,a=r.edgeModel,s=this.state.dragging;return w("g",{pointerEvents:s?"none":"",onMouseDown:this.handleMouseDown,children:s?"":i(n,o,a)})},t}(W),u0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),va=function(){return va=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},va.apply(this,arguments)};(function(e){u0(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getArrowAttributes=function(){var r=this.props,n=r.arrowInfo,o=r.style,i=n.start,a=n.end,s={start:i,end:a,offset:o.offset,verticalLength:o.verticalLength,type:"end"},l=bn(s),u=l.leftX,f=l.leftY,d=l.rightX,c=l.rightY;return va({d:"M".concat(u," ").concat(f," L").concat(a.x," ").concat(a.y," L").concat(d," ").concat(c," z")},o)},t.prototype.getShape=function(){var r=this.getArrowAttributes(),n=r.d,o=r.strokeWidth,i=r.stroke,a=r.fill;return w(Sn,{d:n,fill:a,strokeWidth:o,stroke:i})},t.prototype.render=function(){return w("g",{className:"lf-arrow",children:this.getShape()})},t})(W);var d0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vn=function(){return vn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},vn.apply(this,arguments)},f0=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},si=function(e){d0(t,e);function t(){var r=e.call(this)||this;return r.textRef=Yo(),r.handleHover=function(n,o){var i=r.props,a=i.model,s=i.graphModel.eventCenter;a.setHovered(n);var l=n?R.EDGE_MOUSEENTER:R.EDGE_MOUSELEAVE,u=a.getData();s.emit(l,{data:u,e:o})},r.setHoverOn=function(n){var o=r.props.model.isHovered;o||(r.textRef&&r.textRef.current&&r.textRef.current.setHoverOn(),r.handleHover(!0,n))},r.setHoverOff=function(n){var o=r.props.model.isHovered;o&&(r.textRef&&r.textRef.current&&r.textRef.current.setHoverOff(),r.handleHover(!1,n))},r.handleContextMenu=function(n){n.preventDefault(),r.contextMenuTime=new Date().getTime(),r.clickTimer&&clearTimeout(r.clickTimer);var o=r.props,i=o.model,a=o.graphModel,s=a.editConfigModel,l=a.getPointByClient({x:n.clientX,y:n.clientY});a.setElementStateById(i.id,J.SHOW_MENU,l.domOverlayPosition),s.isSilentMode||r.toFront(),i.isSelected||a.selectEdgeById(i.id);var u=i==null?void 0:i.getData();a.eventCenter.emit(R.EDGE_CONTEXTMENU,{data:u,e:n,position:l})},r.handleMouseDown=function(n){n.stopPropagation(),r.startTime=new Date().getTime()},r.handleMouseUp=function(){var n=r.props.model;r.mouseUpDrag=n.isDragging},r.handleClick=function(n){if(r.startTime&&!r.mouseUpDrag){var o=n.button===2;if(!o){var i=n.detail===2,a=r.props,s=a.model,l=a.graphModel,u=s==null?void 0:s.getData(),f=l.getPointByClient({x:n.clientX,y:n.clientY});if(i){var d=l.editConfigModel,c=l.textEditElement,p=s.id,v=s.text,h=s.modelType;if(c&&c.id===p&&l.setElementStateById(p,J.DEFAULT),d.edgeTextEdit&&v.editable&&(s.setSelected(!1),l.setElementStateById(p,J.TEXT_EDIT)),h===G.POLYLINE_EDGE){var _=s,y=l.getPointByClient({x:n.x,y:n.y}).canvasOverlayPosition,m=y.x,S=y.y;_.dbClickPosition=ef({x:m,y:S},_.points)}l.eventCenter.emit(R.EDGE_DBCLICK,{data:u,e:n,position:f})}else l.eventCenter.emit(R.ELEMENT_CLICK,{data:u,e:n,position:f}),l.eventCenter.emit(R.EDGE_CLICK,{data:u,e:n,position:f});var M=l.editConfigModel;l.selectEdgeById(s.id,rf(n,M)),M.isSilentMode||r.toFront()}}},r.handleFocus=function(){var n=r.props,o=n.model,i=n.graphModel;i.eventCenter.emit(R.EDGE_FOCUS,{data:o.getData()})},r.handleBlur=function(){var n=r.props,o=n.model,i=n.graphModel;i.eventCenter.emit(R.EDGE_BLUR,{data:o.getData()})},r}return t.prototype.getShape=function(){return w("g",{children:this.getEdge()})},t.prototype.getTextStyle=function(){},t.prototype.getText=function(){var r,n=this.props,o=n.model,i=n.graphModel,a=i.editConfigModel;if(a.edgeTextMode!==Yt.TEXT||o.state===J.TEXT_EDIT)return null;if(o.text){var s=!1;return a.edgeTextDraggable&&o.text.draggable&&(s=!0),w(VE,{ref:this.textRef,editable:a.edgeTextEdit&&((r=o.text.editable)!==null&&r!==void 0?r:!0),model:o,graphModel:i,draggable:s})}return null},t.prototype.getArrowInfo=function(){var r=this.props.model,n=r.startPoint,o=r.endPoint,i=r.isSelected,a=this.state.hover;return{start:n,end:o,hover:a,isSelected:i}},t.prototype.getLastTwoPoints=function(){var r=this.props.model,n=r.startPoint,o=r.endPoint;return[n,o]},t.prototype.getArrowStyle=function(){return console.error("getArrowStyle is deprecated in 1.2.0, please use model.getArrowStyle"),null},t.prototype.getArrow=function(){var r=this.props.model,n=r.id,o=r.getArrowStyle(),i=o.refY,a=i===void 0?0:i,s=o.refX,l=s===void 0?2:s,u=f0(this.getLastTwoPoints(),2),f=u[0],d=u[1],c="auto";return f!==null&&d!==null&&(c=Nx(Dx({x:d.x-f.x,y:d.y-f.y}))),w("g",{children:w("defs",{children:[w("marker",{id:"marker-start-".concat(n),refX:-l,refY:a,overflow:"visible",orient:"auto",markerUnits:"userSpaceOnUse",children:this.getStartArrow()}),w("marker",{id:"marker-end-".concat(n),refX:l,refY:a,overflow:"visible",orient:c,markerUnits:"userSpaceOnUse",children:this.getEndArrow()})]})})},t.prototype.getStartArrow=function(){return w("path",{})},t.prototype.getEndArrow=function(){var r=this.props.model,n=r.getArrowStyle(),o=n.stroke,i=n.strokeWidth,a=n.offset,s=n.verticalLength;return w("path",{stroke:o,fill:o,strokeWidth:i,transform:"rotate(180)",d:"M 0 0 L ".concat(a," -").concat(s," L ").concat(a," ").concat(s," Z")})},t.prototype.getAdjustPointShape=function(r,n,o){var i=o.getAdjustPointStyle();return w(Fr,vn({className:"lf-edge-adjust-point"},i,{x:r,y:n}))},t.prototype.getAdjustPoints=function(){var r=this.props,n=r.model,o=r.graphModel,i=o.editConfigModel,a=i.adjustEdgeStartAndEnd,s=i.adjustEdgeStart,l=i.adjustEdgeEnd,u=n.getAdjustStart(),f=n.getAdjustEnd();return w("g",{children:[a&&s&&w(su,vn({type:he.SOURCE},u,{getAdjustPointShape:this.getAdjustPointShape,edgeModel:n,graphModel:o})),a&&l&&w(su,vn({type:he.TARGET},f,{getAdjustPointShape:this.getAdjustPointShape,edgeModel:n,graphModel:o}))]})},t.prototype.getAnimation=function(){console.error("getAnimation is deprecated in 1.2.0, please use model.getEdgeAnimationStyle")},t.prototype.getAppendWidth=function(){return w("g",{})},t.prototype.getAppend=function(){return w("g",{className:"lf-edge-append",children:this.getAppendWidth()})},t.prototype.getEdge=function(){return null},t.prototype.toFront=function(){var r=this.props,n=r.graphModel,o=r.model;n.toFront(o.id)},t.prototype.render=function(){var r=this.props.model,n=r.isSelected,o=r.isHitable,i=r.isShowAdjustPoint;return w("g",{children:[w("g",{className:["lf-edge",!o&&"pointer-none",n&&"lf-edge-selected"].filter(Boolean).join(" "),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onMouseOver:this.setHoverOn,onMouseEnter:this.setHoverOn,onMouseLeave:this.setHoverOff,onFocus:this.handleFocus,onBlur:this.handleBlur,children:[this.getShape(),this.getAppend(),this.getText(),this.getArrow()]}),i&&n?this.getAdjustPoints():""]})},t.isObserved=!1,t}(W),c0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ya=function(){return ya=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ya.apply(this,arguments)},p0=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},lu=function(e){c0(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getEdge=function(){var r=this.props.model,n=r.getEdgeStyle(),o=r,i=o.path,a=o.isAnimation,s=o.arrowConfig,l=r.getEdgeAnimationStyle(),u=l.strokeDasharray,f=l.stroke,d=l.strokeDashoffset,c=l.animationName,p=l.animationDuration,v=l.animationIterationCount,h=l.animationTimingFunction,_=l.animationDirection;return w(Sn,ya({d:i},n,s,a?{strokeDasharray:u,stroke:f,style:{strokeDashoffset:d,animationName:c,animationDuration:p,animationIterationCount:v,animationTimingFunction:h,animationDirection:_}}:{}))},t.prototype.getAppendWidth=function(){var r=this.props.model.path;return w(Sn,{d:r,strokeWidth:10,stroke:"transparent",fill:"none"})},t.prototype.getArrowInfo=function(){var r=this.props.model,n=this.state.hover,o=r.isSelected,i=r.getArrowStyle().offset,a=r.pointsList.map(function(d){return{x:d.x,y:d.y}}),s=p0(Pl(a,i),2),l=s[0],u=s[1],f={start:l,end:u,hover:n,isSelected:o};return f},t.prototype.getLastTwoPoints=function(){var r=this.props.model,n=r.getArrowStyle().offset,o=r.pointsList.map(function(i){return{x:i.x,y:i.y}});return Pl(o,n)},t}(si),h0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ga=function(){return ga=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ga.apply(this,arguments)},uu=function(e){h0(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getEdge=function(){var r=this.props.model,n=r.startPoint,o=r.endPoint,i=r.isAnimation,a=r.arrowConfig,s=r.getEdgeStyle(),l=r.getEdgeAnimationStyle(),u=l.strokeDasharray,f=l.stroke,d=l.strokeDashoffset,c=l.animationName,p=l.animationDuration,v=l.animationIterationCount,h=l.animationTimingFunction,_=l.animationDirection;return w(Xr,ga({},s,{x1:n.x,y1:n.y,x2:o.x,y2:o.y},a,i?{strokeDasharray:u,stroke:f,style:{strokeDashoffset:d,animationName:c,animationDuration:p,animationIterationCount:v,animationTimingFunction:h,animationDirection:_}}:{}))},t.prototype.getAppendWidth=function(){var r=this.props.model,n=r.startPoint,o=r.endPoint,i={start:n,end:o},a=Im(i),s=a.d,l=a.strokeWidth,u=a.fill,f=a.strokeDasharray,d=a.stroke;return w(Sn,{d:s,fill:u,strokeWidth:l,stroke:d,strokeDasharray:f})},t}(si),v0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),tr=function(){return tr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},tr.apply(this,arguments)},y0=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},du=function(e){v0(t,e);function t(){var r=e.call(this)||this;return r.onDragStart=function(){var n=r.props.model;n.dragAppendStart(),r.isShowAdjustPointTemp=n.isShowAdjustPoint,n.isShowAdjustPoint=!1},r.onDragging=function(n){var o=n.deltaX,i=n.deltaY,a=r.props,s=a.model,l=a.graphModel;r.isDragging=!0;var u=l.transformModel,f=l.editConfigModel,d=y0(u.fixDeltaXY(o,i),2),c=d[0],p=d[1],v=s,h=f.adjustEdgeMiddle;h?r.appendInfo=v.dragAppendSimple(r.appendInfo,{x:c,y:p}):r.appendInfo=v.dragAppend(r.appendInfo,{x:c,y:p})},r.onDragEnd=function(){var n,o=r.props,i=o.model,a=o.graphModel.eventCenter,s=i;s.dragAppendEnd(),r.isDragging=!1,s.isShowAdjustPoint=(n=r.isShowAdjustPointTemp)!==null&&n!==void 0?n:!1,r.appendInfo=void 0,a.emit(R.EDGE_ADJUST,{data:s.getData()})},r.beforeDragStart=function(n,o){o.draggable&&r.drag.handleMouseDown(n),r.appendInfo=o},r.drag=new Ee({onDragStart:r.onDragStart,onDragging:r.onDragging,onDragEnd:r.onDragEnd,isStopPropagation:!1}),r}return t.prototype.getEdge=function(){var r=this.props.model,n=r.points,o=r.isAnimation,i=r.arrowConfig,a=r.getEdgeStyle(),s=r.getEdgeAnimationStyle(),l=s.strokeDasharray,u=s.stroke,f=s.strokeDashoffset,d=s.animationName,c=s.animationDuration,p=s.animationIterationCount,v=s.animationTimingFunction,h=s.animationDirection;return w(dx,tr({points:n},a,i,o?{strokeDasharray:l,stroke:u,style:{strokeDashoffset:f,animationName:d,animationDuration:c,animationIterationCount:p,animationTimingFunction:v,animationDirection:h}}:{}))},t.prototype.getArrowInfo=function(){var r=this.props.model,n=r.points,o=r.isSelected,i=this.state.hover,a=lr(n),s=a[0],l=a[0];return a.length>=2&&(s=a[a.length-2],l=a[a.length-1]),{start:s,end:l,hover:i,isSelected:o}},t.prototype.getLastTwoPoints=function(){var r=this.props.model,n=r.points,o=lr(n),i=o[0],a=o[0];return o.length>=2&&(i=o[o.length-2],a=o[o.length-1]),[i,a]},t.prototype.getAppendAttributes=function(r){var n=r.start,o=r.end,i;if(n.x===o.x&&n.y===o.y)i="";else{var a={start:n,end:o,offset:10,verticalLength:5},s=bn(tr(tr({},a),{type:"start"})),l=bn(tr(tr({},a),{type:"end"}));i="M".concat(s.leftX," ").concat(s.leftY,`
      L`).concat(s.rightX," ").concat(s.rightY,`
      L`).concat(l.rightX," ").concat(l.rightY,`
      L`).concat(l.leftX," ").concat(l.leftY," z")}return{d:i,fill:"transparent",stroke:"transparent",strokeWidth:1,strokeDasharray:"4, 4"}},t.prototype.getAppendShape=function(r){var n=this.getAppendAttributes(r),o=n.d,i=n.strokeWidth,a=n.fill,s=n.strokeDasharray,l=n.stroke;return w(Sn,{d:o,fill:a,strokeWidth:i,stroke:l,strokeDasharray:s})},t.prototype.getAppendWidth=function(){for(var r=this,n=this.props,o=n.model,i=n.graphModel,a=o.pointsList,s=o.draggable,l=[],u=a.length,f=function(p){var v="lf-polyline-append",h={start:{x:a[p].x,y:a[p].y},end:{x:a[p+1].x,y:a[p+1].y},startIndex:p,endIndex:p+1,direction:ut.HORIZONTAL,draggable:!0},_=w("g",{className:v,children:d.getAppendShape(h)}),y=i.editConfigModel,m=y.adjustEdge,S=y.adjustEdgeMiddle;if(m&&s){var M=h.startIndex,A=h.endIndex,b=S&&(M===0||A===u-1);h.draggable=!b,h.start.x===h.end.x?(h.draggable&&(v+="-ew-resize"),h.direction=ut.VERTICAL):h.start.y===h.end.y&&(h.draggable&&(v+="-ns-resize"),h.direction=ut.HORIZONTAL),_=w("g",{className:d.isDragging?"lf-dragging":"lf-drag-able",onMouseDown:function(g){return r.beforeDragStart(g,h)},children:w("g",{className:v,children:d.getAppendShape(h)})})}l.push(_)},d=this,c=0;c<u-1;c++)f(c);return w("g",{children:l})},t}(si),br=function(){return br=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},br.apply(this,arguments)},g0=function(){function e(t){var r=this;this.nodeConfig=null,this.fakeNode=null,this.stopDrag=function(){r.nodeConfig=null,window.document.removeEventListener("mouseup",r.stopDrag)},this.dragEnter=function(o){!r.nodeConfig||r.fakeNode||(r.fakeNode=r.lf.createFakeNode(br(br({},r.nodeConfig),r.clientToLocalPoint({x:o.clientX,y:o.clientY}))))},this.onDragOver=function(o){if(o.preventDefault(),r.fakeNode){var i=r.clientToLocalPoint({x:o.clientX,y:o.clientY}),a=i.x,s=i.y;r.fakeNode.moveTo(a,s);var l=r.fakeNode.getData();r.lf.setNodeSnapLine(l),r.lf.graphModel.eventCenter.emit(R.NODE_DND_DRAG,{data:l,e:o})}return!1},this.onDragLeave=function(){r.fakeNode&&(r.lf.removeNodeSnapLine(),r.lf.graphModel.removeFakeNode(),r.fakeNode=null)},this.onDrop=function(o){!r.lf.graphModel||!o||!r.nodeConfig||(r.lf.addNode(br(br({},r.nodeConfig),r.clientToLocalPoint({x:o.clientX,y:o.clientY})),R.NODE_DND_ADD,o),o.preventDefault(),o.stopPropagation(),r.nodeConfig=null,r.lf.removeNodeSnapLine(),r.lf.graphModel.removeFakeNode(),r.fakeNode=null)};var n=t.lf;this.lf=n}return e.prototype.clientToLocalPoint=function(t){var r=t.x,n=t.y,o=In(this.lf.options,["grid","size"]),i=this.lf.graphModel.getPointByClient({x:r,y:n}),a=i.canvasOverlayPosition,s=a.x,l=a.y,u=this.lf.graphModel.editConfigModel.snapGrid;return{x:$r(s,o,u),y:$r(l,o,u)}},e.prototype.startDrag=function(t){var r=this.lf.graphModel.editConfigModel;r!=null&&r.isSilentMode||(this.nodeConfig=t,window.document.addEventListener("mouseup",this.stopDrag))},e.prototype.eventMap=function(){return{onMouseEnter:this.dragEnter,onMouseOver:this.dragEnter,onMouseMove:this.onDragOver,onMouseLeave:this.onDragLeave,onMouseUp:this.onDrop}},e}();function _0(e,t){e.on("node:mousemove",function(r){var n=r.data;t.setNodeSnapLine(n)}),e.on("node:mouseup",function(){t.clearSnapline()})}var m0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Oe=function(){return Oe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Oe.apply(this,arguments)},x0=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},E0=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},b0=function(e){m0(t,e);function t(r){var n=e.call(this,r)||this;return n.ref=Yo(),n.__prevText={type:"",text:"",id:""},n.keyupHandler=function(o){var i=n.props.graphModel.textEditElement;o.key==="Enter"&&o.altKey&&(i==null||i.setElementState(J.DEFAULT))},n.inputHandler=function(o){var i=o.target.innerText,a=n.props.graphModel.textEditElement;a&&(n.__prevText={type:a.type,text:i.replace(/(\r\n)+$|(\n)+$/,""),id:a.id})},n.keydownHandler=function(o){o.stopPropagation()},n.state={style:{left:0,top:0}},n}return t.getDerivedStateFromProps=function(r){var n,o=r.textEditElement,i=r.graphModel,a=i.transformModel,s=i.theme,l=s.inputText,u;if(o){if(!(!((n=o.text)===null||n===void 0)&&n.value)&&o.BaseType===ct.EDGE){var f=o.text,d=o.textPosition,c=d.x,p=d.y;f.x=c,f.y=p,o.setText(f)}var v={resize:"auto",whiteSpace:"normal",wordBreak:"break-all"};if(o.BaseType===ct.EDGE){var h=s.edgeText,_=h.overflowMode,y=h.lineHeight,m=h.wrapPadding,S=h.textWidth;S&&_==="autoWrap"&&(u=Oe(Oe({},v),{width:S,minWidth:S,lineHeight:y,padding:m}))}else if(o.BaseType===ct.NODE){var M=s.nodeText,_=M.overflowMode,y=M.lineHeight,m=M.wrapPadding,S=M.textWidth,A=o.width,b=o.modelType,g=o.textWidth,x=g||S||A;(b!==G.TEXT_NODE&&_==="autoWrap"||b===G.TEXT_NODE&&S)&&(u=Oe(Oe({},v),{width:x,minWidth:x,lineHeight:y,padding:m}))}var T=o.text,P=T.x,j=T.y,L=E0(a.CanvasPointToHtmlPoint([P,j]),2),U=L[0],D=L[1];return{style:Oe(Oe({left:U,top:D},u),l)}}return null},t.prototype.componentDidUpdate=function(){var r=this.props.graphModel;if(this.ref.current&&(this.ref.current.focus(),this.placeCaretAtEnd(this.ref.current)),this.__prevText.id!==""){var n=this.__prevText,o=n.text,i=n.id;r.updateText(i,o),r.eventCenter.emit(R.TEXT_UPDATE,{data:Oe({},this.__prevText)}),this.__prevText.id="",this.__prevText.text="",this.__prevText.type=""}},t.prototype.placeCaretAtEnd=function(r){if(window.getSelection!==void 0&&document.createRange!==void 0){var n=document.createRange();n.selectNodeContents(r),n.collapse(!1);var o=window.getSelection();o==null||o.removeAllRanges(),o==null||o.addRange(n)}},t.prototype.render=function(){var r,n=this.props.graphModel.textEditElement,o=this.state.style;return n?w("div",{contentEditable:!0,className:"lf-text-input",style:o,ref:this.ref,onKeyUp:this.keyupHandler,onKeyDown:this.keydownHandler,onKeyPress:this.keydownHandler,onInput:this.inputHandler,children:(r=n.text)===null||r===void 0?void 0:r.value},n.id):null},t.toolName="text-edit-tool",t=x0([$t],t),t}(W),O0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),w0=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},bi=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},S0=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},M0=function(e){O0(t,e);function t(r){var n=e.call(this,r)||this;n.handleMouseDown=function(s){n.stepDrag.handleMouseDown(s)},n.handleWheelEvent=function(s){var l,u;s.preventDefault();var f=s.deltaX,d=s.deltaY,c=s.clientX,p=s.clientY,v=s.ctrlKey,h=new WheelEvent("wheel",{deltaX:f,deltaY:d,clientX:c,clientY:p,ctrlKey:v});(u=(l=n.props.lf.container)===null||l===void 0?void 0:l.querySelector('.lf-canvas-overlay[name="canvas-overlay"]'))===null||u===void 0||u.dispatchEvent(h)},n.onDragging=function(s){var l=s.deltaX,u=s.deltaY,f=n.props,d=f.graphModel,c=f.lf,p=c.getTransform(),v=p.SCALE_X,h=p.SCALE_Y,_=d.getSelectElements(!0);d.moveNodes(_.nodes.map(function(y){return y.id}),l/v,u/h)},n.handleContextMenu=function(s){s.preventDefault();var l=n.props,u=l.graphModel,f=l.graphModel,d=f.eventCenter,c=f.selectElements,p=u.getPointByClient({x:s.clientX,y:s.clientY}),v={nodes:[],edges:[]},h=S0([],bi(c.values()),!1);h.forEach(function(_){_.BaseType===ct.NODE&&v.nodes.push(_.getData()),_.BaseType===ct.EDGE&&v.edges.push(_.getData())}),d.emit(R.SELECTION_CONTEXTMENU,{data:v,e:s,position:p})};var o=r.graphModel,i=o.gridSize,a=o.eventCenter;return n.stepDrag=new Ee({onDragging:n.onDragging,step:i,eventType:"SELECTION",eventCenter:a}),n}return t.prototype.render=function(){var r,n,o=this.props.graphModel,i=o.selectElements,a=o.transformModel,s=this.props.lf.getTransform(),l=s.SCALE_X,u=s.SCALE_Y;if(!(i.size<=1)){var f=Number.MAX_SAFE_INTEGER,d=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER;i.forEach(function(h){var _;h.BaseType===ct.NODE&&(_=mm(h)),h.BaseType===ct.EDGE&&(_=Om(h)),_!==void 0&&(f=Math.min(f,_.x),d=Math.min(d,_.y),c=Math.max(c,_.x1),p=Math.max(p,_.y1))}),r=bi(a.CanvasPointToHtmlPoint([f,d]),2),f=r[0],d=r[1],n=bi(a.CanvasPointToHtmlPoint([c,p]),2),c=n[0],p=n[1];var v={left:"".concat(f-20*l/2,"px"),top:"".concat(d-20*u/2,"px"),width:"".concat(c-f+20*l,"px"),height:"".concat(p-d+20*u,"px"),"border-width":"".concat(2*l,"px")};return w("div",{className:"lf-multiple-select",style:v,onMouseDown:this.handleMouseDown,onContextMenu:this.handleContextMenu,onWheel:this.handleWheelEvent})}},t.toolName="multiple-select-tool",t=w0([$t],t),t}(W),Oi=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},A0=[b0,M0],T0=function(){function e(t){var r=this;this.toolMap=new Map,this.disabledToolMap=new Map,this.instance=t,ht(A0,function(i){r.isDisabled(i.toolName)||r.registerTool(i.toolName,i)});var n=t.graphModel,o=n.eventCenter;o.on("".concat(R.GRAPH_TRANSFORM,",").concat(R.NODE_CLICK,",").concat(R.BLANK_CLICK," "),function(){var i,a=n.textEditElement,s=n.editConfigModel,l=s.edgeTextEdit,u=s.nodeTextEdit;(l||u)&&a&&((i=n.textEditElement)===null||i===void 0||i.setElementState(J.DEFAULT))})}return e.prototype.isDisabled=function(t){var r;return((r=this.instance.options.disabledTools)===null||r===void 0?void 0:r.indexOf(t))!==-1},e.prototype.registerTool=function(t,r){this.toolMap.set(t,r)},e.prototype.disableTool=function(t){var r=this.toolMap.get(t);if(r)return this.disabledToolMap.set(t,r),this.toolMap.delete(t),!0;throw new Error(" ".concat(r," "))},e.prototype.enableTool=function(t){var r=this.disabledToolMap.get(t);if(r)return this.toolMap.set(t,r),this.disabledToolMap.delete(t),!0;throw new Error(" ".concat(r," "))},e.prototype.getTools=function(){return Array.from(this.toolMap.values())},e.prototype.getInstance=function(){return this.instance},e.prototype.destroy=function(){this.toolMap.clear(),this.disabledToolMap.clear()},Oi([O],e.prototype,"toolMap",void 0),Oi([E],e.prototype,"disableTool",null),Oi([E],e.prototype,"enableTool",null),e}();function P0(e){throw new Error("[mobx-utils] "+e)}function Xo(e,t){t===void 0&&(t="Illegal state"),e||P0(t)}var hf=function(e){return e&&e!==Object.prototype&&Object.getOwnPropertyNames(e).concat(hf(Object.getPrototypeOf(e))||[])},D0=function(e){var t=hf(e),r=t.filter(function(n,o){return t.indexOf(n)===o});return r},N0=function(e){return D0(e).filter(function(t){return t!=="constructor"&&!~t.indexOf("__")})},vf="pending",Fo="fulfilled",qa="rejected";function C0(e){switch(this.state){case vf:return e.pending&&e.pending(this.value);case qa:return e.rejected&&e.rejected(this.value);case Fo:return e.fulfilled?e.fulfilled(this.value):this.value}}function fu(e,t){if(Xo(arguments.length<=2,"fromPromise expects up to two arguments"),Xo(typeof e=="function"||typeof e=="object"&&e&&typeof e.then=="function","Please pass a promise or function to fromPromise"),e.isPromiseBasedObservable===!0)return e;typeof e=="function"&&(e=new Promise(e));var r=e;e.then(E("observableFromPromise-resolve",function(o){r.value=o,r.state=Fo}),E("observableFromPromise-reject",function(o){r.value=o,r.state=qa})),r.isPromiseBasedObservable=!0,r.case=C0;var n=t&&t.state===Fo?t.value:void 0;return Bi(r,{value:n,state:vf},{},{deep:!1}),r}(function(e){e.reject=E("fromPromise.reject",function(r){var n=e(Promise.reject(r));return n.state=qa,n.value=r,n});function t(r){r===void 0&&(r=void 0);var n=e(Promise.resolve(r));return n.state=Fo,n.value=r,n}e.resolve=E("fromPromise.resolve",t)})(fu||(fu={}));var oo=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i};(function(){function e(t,r){var n=this;Bc(function(){n.current=r,n.subscription=t.subscribe(n)})}return e.prototype.dispose=function(){this.subscription&&this.subscription.unsubscribe()},e.prototype.next=function(t){this.current=t},e.prototype.complete=function(){this.dispose()},e.prototype.error=function(t){this.current=t,this.dispose()},oo([O.ref],e.prototype,"current",void 0),oo([E.bound],e.prototype,"next",null),oo([E.bound],e.prototype,"complete",null),oo([E.bound],e.prototype,"error",null),e})();var ko=function(){return ko=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ko.apply(this,arguments)},Zr=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},R0=["model","reset","submit","isDirty","isPropertyDirty","resetProperty"];(function(){function e(t){var r=this;this.model=t,this.localValues=O.map({}),this.localComputedValues=O.map({}),this.isPropertyDirty=function(n){return r.localValues.has(n)},Xo(se(t),"createViewModel expects an observable object"),N0(t).forEach(function(n){if(!(n===$||n==="__mobxDidRunLazyInitializers")){if(Xo(R0.indexOf(n)===-1,"The propertyname "+n+" is reserved and cannot be used with viewModels"),ls(t,n)){var o=Vo(t,n).derivation;r.localComputedValues.set(n,at(o.bind(r)))}var i=Object.getOwnPropertyDescriptor(t,n),a=i?{enumerable:i.enumerable}:{};Object.defineProperty(r,n,ko(ko({},a),{configurable:!0,get:function(){return ls(t,n)?r.localComputedValues.get(n).get():r.isPropertyDirty(n)?r.localValues.get(n):r.model[n]},set:E(function(s){s!==r.model[n]?r.localValues.set(n,s):r.localValues.delete(n)})}))}})}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this.localValues.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"changedValues",{get:function(){return this.localValues.toJS()},enumerable:!1,configurable:!0}),e.prototype.submit=function(){var t=this;Rr(this.localValues).forEach(function(r){var n=t.localValues.get(r),o=t.model[r];xe(o)?o.replace(n):Rt(o)?(o.clear(),o.merge(n)):Gc(n)||(t.model[r]=n)}),this.localValues.clear()},e.prototype.reset=function(){this.localValues.clear()},e.prototype.resetProperty=function(t){this.localValues.delete(t)},Zr([at],e.prototype,"isDirty",null),Zr([at],e.prototype,"changedValues",null),Zr([E.bound],e.prototype,"submit",null),Zr([E.bound],e.prototype,"reset",null),Zr([E.bound],e.prototype,"resetProperty",null),e})();function wi(e){if(!e)return"ROOT";for(var t=[];e.parent;)t.push(e.path),e=e.parent;return t.reverse().join("/")}function Si(e){return se(e)||xe(e)||Rt(e)}function j0(e,t){var r=new WeakMap;function n(s){var l=r.get(s.object);o(s,l),t(s,wi(l),e)}function o(s,l){switch(s.type){case"add":i(s.newValue,l,s.name);break;case"update":a(s.oldValue),i(s.newValue,l,s.name||""+s.index);break;case"remove":case"delete":a(s.oldValue);break;case"splice":s.removed.map(a),s.added.forEach(function(d,c){return i(d,l,""+(s.index+c))});for(var u=s.index+s.addedCount;u<s.object.length;u++)if(Si(s.object[u])){var f=r.get(s.object[u]);f&&(f.path=""+u)}break}}function i(s,l,u){if(Si(s)){var f=r.get(s);if(f){if(f.parent!==l||f.path!==u)throw new Error("The same observable object cannot appear twice in the same tree,"+(" trying to assign it to '"+wi(l)+"/"+u+"',")+(" but it already exists at '"+wi(f.parent)+"/"+f.path+"'"))}else{var d={parent:l,path:u,dispose:td(s,n)};r.set(s,d),Wc(s).forEach(function(c){var p=c[0],v=c[1];return i(v,d,p)})}}}function a(s){if(Si(s)){var l=r.get(s);if(!l)return;r.delete(s),l.dispose(),zc(s).forEach(a)}}return i(e,void 0,""),function(){a(e)}}var L0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(e){L0(t,e);function t(r,n,o){var i=o===void 0?{}:o,a=i.name,s=a===void 0?"ogm"+(Math.random()*1e3|0):a,l=i.keyToName,u=l===void 0?function(c){return""+c}:l,f=e.call(this)||this;f._keyToName=u,f._groupBy=n,f._ogmInfoKey=Symbol("ogmInfo"+s),f._base=r;for(var d=0;d<r.length;d++)f._addItem(r[d]);return f._disposeBaseObserver=td(f._base,function(c){if(c.type==="splice")qt(function(){for(var p=0,v=c.removed;p<v.length;p++){var h=v[p];f._removeItem(h)}for(var _=0,y=c.added;_<y.length;_++){var m=y[_];f._addItem(m)}});else if(c.type==="update")qt(function(){f._removeItem(c.oldValue),f._addItem(c.newValue)});else throw new Error("illegal state")}),f}return t.prototype.clear=function(){throw new Error("not supported")},t.prototype.delete=function(r){throw new Error("not supported")},t.prototype.set=function(r,n){throw new Error("not supported")},t.prototype.dispose=function(){this._disposeBaseObserver();for(var r=0;r<this._base.length;r++){var n=this._base[r],o=n[this._ogmInfoKey];o.reaction(),delete n[this._ogmInfoKey]}},t.prototype._getGroupArr=function(r){var n=e.prototype.get.call(this,r);return n===void 0&&(n=O([],{name:"GroupArray["+this._keyToName(r)+"]",deep:!1}),e.prototype.set.call(this,r,n)),n},t.prototype._removeFromGroupArr=function(r,n){var o=e.prototype.get.call(this,r);o.length===1?e.prototype.delete.call(this,r):(n===o.length-1||(o[n]=o[o.length-1],o[n][this._ogmInfoKey].groupArrIndex=n),o.length--)},t.prototype._addItem=function(r){var n=this,o=this._groupBy(r),i=this._getGroupArr(o),a={groupByValue:o,groupArrIndex:i.length,reaction:Wu(function(){return n._groupBy(r)},function(s,l){var u=r[n._ogmInfoKey];n._removeFromGroupArr(u.groupByValue,u.groupArrIndex);var f=n._getGroupArr(s),d=f.length;f.push(r),u.groupByValue=s,u.groupArrIndex=d})};Object.defineProperty(r,this._ogmInfoKey,{configurable:!0,enumerable:!1,value:a}),i.push(r)},t.prototype._removeItem=function(r){var n=r[this._ogmInfoKey];this._removeFromGroupArr(n.groupByValue,n.groupArrIndex),n.reaction(),delete r[this._ogmInfoKey]},t})(ja);Promise.resolve(),typeof queueMicrotask<"u"||typeof process<"u"&&process.nextTick;var _a=function(){return _a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},_a.apply(this,arguments)},I0=function(){function e(t){this.undos=[],this.redos=[],this.callbacks=[],this.stopWatch=null,this.curData=null,this.maxSize=50,this.waitTime=100,this.eventCenter=t}return e.prototype.add=function(t){yl($_(this.undos),t)||(this.undos.push(t),yl(this.curData,t)||(this.redos=[]),this.eventCenter.emit(R.HISTORY_CHANGE,{data:{undos:this.undos,redos:this.redos,undoAble:this.undoAble(),redoAble:this.redoAble()}}),this.undos.length>this.maxSize&&this.undos.shift())},e.prototype.undoAble=function(){return this.undos.length>1},e.prototype.undo=function(){if(this.undoAble()){var t=this.undos.pop();this.redos.push(t);var r=this.undos.pop();return this.curData=k(r),r}},e.prototype.redoAble=function(){return this.redos.length>0},e.prototype.redo=function(){if(this.redoAble()){var t=this.redos.pop();return this.curData=k(t),t}},e.prototype.watch=function(t){var r=this;this.stopWatch&&this.stopWatch(),this.undos.push(t.modelToGraphData()),this.stopWatch=j0(t,za(function(){var n=t.modelToHistoryData();n&&r.add(_a({},n))},this.waitTime))},e.prototype.destroy=function(){this.undos=[],this.redos=[],this.curData=null,this.stopWatch&&this.stopWatch()},e}(),yf={exports:{}};(function(e){(function(t,r,n){if(!t)return;for(var o={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},i={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},a={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},l,u=1;u<20;++u)o[111+u]="f"+u;for(u=0;u<=9;++u)o[u+96]=u.toString();function f(g,x,T){if(g.addEventListener){g.addEventListener(x,T,!1);return}g.attachEvent("on"+x,T)}function d(g){if(g.type=="keypress"){var x=String.fromCharCode(g.which);return g.shiftKey||(x=x.toLowerCase()),x}return o[g.which]?o[g.which]:i[g.which]?i[g.which]:String.fromCharCode(g.which).toLowerCase()}function c(g,x){return g.sort().join(",")===x.sort().join(",")}function p(g){var x=[];return g.shiftKey&&x.push("shift"),g.altKey&&x.push("alt"),g.ctrlKey&&x.push("ctrl"),g.metaKey&&x.push("meta"),x}function v(g){if(g.preventDefault){g.preventDefault();return}g.returnValue=!1}function h(g){if(g.stopPropagation){g.stopPropagation();return}g.cancelBubble=!0}function _(g){return g=="shift"||g=="ctrl"||g=="alt"||g=="meta"}function y(){if(!l){l={};for(var g in o)g>95&&g<112||o.hasOwnProperty(g)&&(l[o[g]]=g)}return l}function m(g,x,T){return T||(T=y()[g]?"keydown":"keypress"),T=="keypress"&&x.length&&(T="keydown"),T}function S(g){return g==="+"?["+"]:(g=g.replace(/\+{2}/g,"+plus"),g.split("+"))}function M(g,x){var T,P,j,L=[];for(T=S(g),j=0;j<T.length;++j)P=T[j],s[P]&&(P=s[P]),x&&x!="keypress"&&a[P]&&(P=a[P],L.push("shift")),_(P)&&L.push(P);return x=m(P,L,x),{key:P,modifiers:L,action:x}}function A(g,x){return g===null||g===r?!1:g===x?!0:A(g.parentNode,x)}function b(g){var x=this;if(g=g||r,!(x instanceof b))return new b(g);x.target=g,x._callbacks={},x._directMap={};var T={},P,j=!1,L=!1,U=!1;function D(X){X=X||{};var V=!1,nt;for(nt in T){if(X[nt]){V=!0;continue}T[nt]=0}V||(U=!1)}function tt(X,V,nt,z,dt,Nt){var K,vt,Wt=[],Pt=nt.type;if(!x._callbacks[X])return[];for(Pt=="keyup"&&_(X)&&(V=[X]),K=0;K<x._callbacks[X].length;++K)if(vt=x._callbacks[X][K],!(!z&&vt.seq&&T[vt.seq]!=vt.level)&&Pt==vt.action&&(Pt=="keypress"&&!nt.metaKey&&!nt.ctrlKey||c(V,vt.modifiers))){var Re=!z&&vt.combo==dt,li=z&&vt.seq==z&&vt.level==Nt;(Re||li)&&x._callbacks[X].splice(K,1),Wt.push(vt)}return Wt}function et(X,V,nt,z){x.stopCallback(V,V.target||V.srcElement,nt,z)||X(V,nt)===!1&&(v(V),h(V))}x._handleKey=function(X,V,nt){var z=tt(X,V,nt),dt,Nt={},K=0,vt=!1;for(dt=0;dt<z.length;++dt)z[dt].seq&&(K=Math.max(K,z[dt].level));for(dt=0;dt<z.length;++dt){if(z[dt].seq){if(z[dt].level!=K)continue;vt=!0,Nt[z[dt].seq]=1,et(z[dt].callback,nt,z[dt].combo,z[dt].seq);continue}vt||et(z[dt].callback,nt,z[dt].combo)}var Wt=nt.type=="keypress"&&L;nt.type==U&&!_(X)&&!Wt&&D(Nt),L=vt&&nt.type=="keydown"};function jt(X){typeof X.which!="number"&&(X.which=X.keyCode);var V=d(X);if(V){if(X.type=="keyup"&&j===V){j=!1;return}x.handleKey(V,p(X),X)}}function zt(){clearTimeout(P),P=setTimeout(D,1e3)}function Et(X,V,nt,z){T[X]=0;function dt(Pt){return function(){U=Pt,++T[X],zt()}}function Nt(Pt){et(nt,Pt,X),z!=="keyup"&&(j=d(Pt)),setTimeout(D,10)}for(var K=0;K<V.length;++K){var vt=K+1===V.length,Wt=vt?Nt:dt(z||M(V[K+1]).action);Tt(V[K],Wt,z,X,K)}}function Tt(X,V,nt,z,dt){x._directMap[X+":"+nt]=V,X=X.replace(/\s+/g," ");var Nt=X.split(" "),K;if(Nt.length>1){Et(X,Nt,V,nt);return}K=M(X,nt),x._callbacks[K.key]=x._callbacks[K.key]||[],tt(K.key,K.modifiers,{type:K.action},z,X,dt),x._callbacks[K.key][z?"unshift":"push"]({callback:V,modifiers:K.modifiers,action:K.action,seq:z,level:dt,combo:X})}x._bindMultiple=function(X,V,nt){for(var z=0;z<X.length;++z)Tt(X[z],V,nt)},f(g,"keypress",jt),f(g,"keydown",jt),f(g,"keyup",jt)}b.prototype.bind=function(g,x,T){var P=this;return g=g instanceof Array?g:[g],P._bindMultiple.call(P,g,x,T),P},b.prototype.unbind=function(g,x){var T=this;return T.bind.call(T,g,function(){},x)},b.prototype.trigger=function(g,x){var T=this;return T._directMap[g+":"+x]&&T._directMap[g+":"+x]({},g),T},b.prototype.reset=function(){var g=this;return g._callbacks={},g._directMap={},g},b.prototype.stopCallback=function(g,x){var T=this;if((" "+x.className+" ").indexOf(" mousetrap ")>-1||A(x,T.target))return!1;if("composedPath"in g&&typeof g.composedPath=="function"){var P=g.composedPath()[0];P!==g.target&&(x=P)}return x.tagName=="INPUT"||x.tagName=="SELECT"||x.tagName=="TEXTAREA"||x.isContentEditable},b.prototype.handleKey=function(){var g=this;return g._handleKey.apply(g,arguments)},b.addKeycodes=function(g){for(var x in g)g.hasOwnProperty(x)&&(o[x]=g[x]);l=null},b.init=function(){var g=b(r);for(var x in g)x.charAt(0)!=="_"&&(b[x]=function(T){return function(){return g[T].apply(g,arguments)}}(x))},b.init(),t.Mousetrap=b,e.exports&&(e.exports=b)})(typeof window<"u"?window:null,typeof window<"u"?document:null)})(yf);var B0=yf.exports;const $0=vu(B0);var ue=null;function cu(e,t){return e.x+=t,e.y+=t,Zd(e.text)||(e.text.x+=t,e.text.y+=t),e}function pu(e,t){return e.startPoint&&(e.startPoint.x+=t,e.startPoint.y+=t),e.endPoint&&(e.endPoint.x+=t,e.endPoint.y+=t),e.pointsList&&e.pointsList.length>0&&e.pointsList.forEach(function(r){r.x+=t,r.y+=t}),Zd(e.text)||(e.text.x+=t,e.text.y+=t),e}var yr=40,io=40;function X0(e,t){var r=e.keyboard,n=r.options.keyboard;r.on(["cmd + c","ctrl + c"],function(){if(io=yr,!(n!=null&&n.enabled)||t.textEditElement)return!0;var o=e.options.guards,i=t.getSelectElements(!1),a=o&&o.beforeClone?o.beforeClone(i):!0;return!a||i.nodes.length===0&&i.edges.length===0?(ue=null,!0):(ue=i,ue.nodes.forEach(function(s){return cu(s,yr)}),ue.edges.forEach(function(s){return pu(s,yr)}),!1)}),r.on(["cmd + v","ctrl + v"],function(){if(!(n!=null&&n.enabled)||t.textEditElement)return!0;if(ue&&(ue.nodes||ue.edges)){e.clearSelectElements();var o=e.addElements(ue,io);if(!o)return!0;o.nodes.forEach(function(i){return e.selectElementById(i.id,!0)}),o.edges.forEach(function(i){return e.selectElementById(i.id,!0)}),ue.nodes.forEach(function(i){return cu(i,yr)}),ue.edges.forEach(function(i){return pu(i,yr)}),io=io+yr}return!1}),r.on(["cmd + z","ctrl + z"],function(){return!(n!=null&&n.enabled)||t.textEditElement?!0:(e.undo(),!1)}),r.on(["cmd + y","ctrl + y"],function(){return!(n!=null&&n.enabled)||t.textEditElement?!0:(e.redo(),!1)}),r.on(["backspace"],function(){if(!(n!=null&&n.enabled)||t.textEditElement)return!0;var o=t.getSelectElements(!0);return e.clearSelectElements(),o.edges.forEach(function(i){return i.id&&e.deleteEdge(i.id)}),o.nodes.forEach(function(i){return i.id&&e.deleteNode(i.id)}),!1})}var F0=function(){function e(t){t.keyboard||(t.keyboard={enabled:!1}),this.options=t;var r=t.lf;this.target=r.container,this.mousetrap=new $0(this.target),t.keyboard.enabled&&!r.options.isSilentMode&&this.enable(!0)}return e.prototype.initShortcuts=function(){var t=this,r,n=((r=this.options.keyboard)!==null&&r!==void 0?r:{}).shortcuts;if(n)if(xt(n))n.forEach(function(s){var l=s.keys,u=s.callback,f=s.action;return t.on(l,u,f)});else{var o=n.keys,i=n.callback,a=n.action;this.on(o,i,a)}},e.prototype.on=function(t,r,n){this.mousetrap.bind(this.getKeys(t),r,n)},Object.defineProperty(e.prototype,"disabled",{get:function(){var t,r;return((r=(t=this.options)===null||t===void 0?void 0:t.keyboard)===null||r===void 0?void 0:r.enabled)!==!0},enumerable:!1,configurable:!0}),e.prototype.off=function(t,r){this.mousetrap.unbind(this.getKeys(t),r)},e.prototype.enable=function(t){(this.disabled||t)&&(this.options.keyboard&&(this.options.keyboard.enabled=!0),this.target instanceof HTMLElement&&(this.target.setAttribute("tabindex","-1"),this.target.style.outline="none"))},e.prototype.disable=function(){this.disabled||(this.options.keyboard&&(this.options.keyboard.enabled=!1),this.target instanceof HTMLElement&&this.target.removeAttribute("tabindex"))},e.prototype.destroy=function(){this.mousetrap.reset()},e.prototype.getKeys=function(t){var r=this;return(Array.isArray(t)?t:[t]).map(function(n){return r.formatKey(n)})},e.prototype.formatKey=function(t){return t.toLowerCase().replace(/\s/g,"").replace("delete","del").replace("cmd","command")},e}(),Xe=function(){return Xe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Xe.apply(this,arguments)},ao=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Mi=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},Ai=Symbol("plugin registered by Logicflow.use"),ma=function(){function e(t){var r=this,n;this.viewMap=new Map,this.components=[],this.extension={},this.setView=function(u,f){return r.viewMap.set(u,f)},this.getView=function(u){return r.viewMap.get(u)};var o=xn.get(t),i=o.container,a=o.width,s=o.height;this.options=o,this.container=this.initContainer(i,a,s),this.graphModel=new PE(Xe(Xe({},o),{container:this.container})),this.plugins=(n=o.plugins)!==null&&n!==void 0?n:[];var l=this.graphModel.eventCenter;this.tool=new T0(this),this.dnd=new g0({lf:this}),this.history=new I0(l),this.keyboard=new F0({lf:this,keyboard:o.keyboard}),o.snapline!==!1&&(this.snaplineModel=new DE(this.graphModel),_0(l,this.snaplineModel)),o.isSilentMode||(X0(this,this.graphModel),this.keyboard.initShortcuts()),this.defaultRegister(),this.installPlugins(o.disabledPlugins)}return e.prototype.initContainer=function(t,r,n){var o=document.createElement("div");return o.style.position="relative",o.style.width=r?"".concat(r,"px"):"100%",o.style.height=n?"".concat(n,"px"):"100%",t.innerHTML="",t.appendChild(o),o},Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return e.toStringTag},enumerable:!1,configurable:!0}),e.prototype.register=function(t,r,n){if(n===void 0&&(n=!0),typeof t!="string"){this.registerElement(t);return}var o={BaseEdge:si,BaseEdgeModel:ai,BaseNode:Ke,BaseNodeModel:Ve,RectNode:tu,RectNodeModel:Kl,CircleNode:eu,CircleNodeModel:Ul,PolygonNode:ru,PolygonNodeModel:Vl,TextNode:iu,TextNodeModel:ql,LineEdge:uu,LineEdgeModel:kl,DiamondNode:nu,DiamondNodeModel:zl,PolylineEdge:du,PolylineEdgeModel:Yl,BezierEdge:lu,BezierEdgeModel:Xl,EllipseNode:ou,EllipseNodeModel:Wl,HtmlNode:au,HtmlNodeModel:Jl,h:Sr,type:t};if(this.viewMap.forEach(function(u){var f=u.extendKey;f&&(o[f]=u)}),this.graphModel.modelMap.forEach(function(u){var f=u.extendKey;f&&(o[f]=u)}),r){var i=r(o),a=i.view,s=i.model,l=a;n&&!l.isObserved&&(l.isObserved=!0,l=$t(l)),this.setView(t,l),this.graphModel.setModel(t,s)}},e.prototype.registerElement=function(t){var r=t.view;t.isObserverView!==!1&&!r.isObserved&&(r.isObserved=!0,r=$t(r)),this.setView(t.type,r),this.graphModel.setModel(t.type,t.model)},e.prototype.batchRegister=function(t){var r=this;t===void 0&&(t=[]),ht(t,function(n){r.registerElement(n)})},e.prototype.defaultRegister=function(){var t=[{type:"rect",view:tu,model:Kl},{type:"circle",view:eu,model:Ul},{type:"polygon",view:ru,model:Vl},{type:"text",view:iu,model:ql},{type:"ellipse",view:ou,model:Wl},{type:"diamond",view:nu,model:zl},{type:"html",view:au,model:Jl},{type:"line",view:uu,model:kl},{type:"polyline",view:du,model:Yl},{type:"bezier",view:lu,model:Xl}];this.batchRegister(t)},e.prototype.addNode=function(t,r,n){return r===void 0&&(r=R.NODE_ADD),this.graphModel.addNode(t,r,n)},e.prototype.deleteNode=function(t){var r=this.graphModel.getNodeModelById(t);if(!r)return!1;var n=r.getData(),o=this.options.guards,i=o!=null&&o.beforeDelete?o.beforeDelete(n):!0;return i&&this.graphModel.deleteNode(t),i},e.prototype.cloneNode=function(t){var r=this.graphModel.getNodeModelById(t),n=r==null?void 0:r.getData();if(n){var o=this.options.guards,i=o!=null&&o.beforeClone?o.beforeClone(n):!0;if(i)return this.graphModel.cloneNode(t)}},e.prototype.changeNodeId=function(t,r){return this.graphModel.changeNodeId(t,r)},e.prototype.changeNodeType=function(t,r){this.graphModel.changeNodeType(t,r)},e.prototype.getNodeModelById=function(t){return this.graphModel.getNodeModelById(t)},e.prototype.getNodeDataById=function(t){var r=this.getNodeModelById(t);return r==null?void 0:r.getData()},e.prototype.getNodeIncomingEdge=function(t){return this.graphModel.getNodeIncomingEdge(t)},e.prototype.getNodeOutgoingEdge=function(t){return this.graphModel.getNodeOutgoingEdge(t)},e.prototype.getNodeIncomingNode=function(t){return this.graphModel.getNodeIncomingNode(t)},e.prototype.getNodeOutgoingNode=function(t){return this.graphModel.getNodeOutgoingNode(t)},e.prototype.createFakeNode=function(t){var r=this.graphModel.modelMap.get(t.type);if(!r)return console.warn("".concat(t.type,"")),null;var n=new r(Xe(Xe({},t),{virtual:!0}),this.graphModel);return this.graphModel.setFakeNode(n),n},e.prototype.removeFakeNode=function(){this.graphModel.removeFakeNode()},e.prototype.setNodeSnapLine=function(t){var r;(r=this.snaplineModel)===null||r===void 0||r.setNodeSnapLine(t)},e.prototype.removeNodeSnapLine=function(){var t;(t=this.snaplineModel)===null||t===void 0||t.clearSnapline()},e.prototype.setDefaultEdgeType=function(t){this.graphModel.setDefaultEdgeType(t)},e.prototype.addEdge=function(t){return this.graphModel.addEdge(t)},e.prototype.getEdgeDataById=function(t){var r=this.getEdgeModelById(t);return r==null?void 0:r.getData()},e.prototype.getEdgeModelById=function(t){return this.graphModel.getEdgeModelById(t)},e.prototype.getEdgeModels=function(t){var r=t.sourceNodeId,n=t.targetNodeId,o=[],i=this.graphModel.edges;return r&&n?ht(i,function(a){a.sourceNodeId===r&&a.targetNodeId===n&&o.push(a)}):r?ht(i,function(a){a.sourceNodeId===r&&o.push(a)}):n&&ht(i,function(a){a.targetNodeId===n&&o.push(a)}),o},e.prototype.changeEdgeId=function(t,r){return this.graphModel.changeEdgeId(t,r)},e.prototype.changeEdgeType=function(t,r){this.graphModel.changeEdgeType(t,r)},e.prototype.deleteEdge=function(t){var r=this.graphModel.getEdgeModelById(t);if(!r)return!1;var n=r.getData(),o=this.options.guards,i=o!=null&&o.beforeDelete?o.beforeDelete(n):!0;return i&&this.graphModel.deleteEdgeById(t),i},e.prototype.deleteEdgeByNodeId=function(t){var r=t.sourceNodeId,n=t.targetNodeId;r&&n?this.graphModel.deleteEdgeBySourceAndTarget(r,n):r?this.graphModel.deleteEdgeBySource(r):n&&this.graphModel.deleteEdgeByTarget(n)},e.prototype.getNodeEdges=function(t){return this.graphModel.getNodeEdges(t)},e.prototype.addElements=function(t,r){var n=this,o=t.nodes,i=t.edges;r===void 0&&(r=40),console.log("distance",r);var a={},s={nodes:[],edges:[]};return ht(o,function(l){var u=l.id,f=n.addNode(l);u&&(a[u]=f.id),s.nodes.push(f)}),ht(i,function(l){var u=l.sourceNodeId,f=l.targetNodeId;a[u]&&(u=a[u]),a[f]&&(f=a[f]);var d=n.graphModel.addEdge(Xe(Xe({},l),{sourceNodeId:u,targetNodeId:f}));s.edges.push(d)}),s},e.prototype.selectElementById=function(t,r,n){r===void 0&&(r=!1),n===void 0&&(n=!0),this.graphModel.selectElementById(t,r),!r&&n&&this.graphModel.toFront(t)},e.prototype.getSelectElements=function(t){return t===void 0&&(t=!0),this.graphModel.getSelectElements(t)},e.prototype.clearSelectElements=function(){this.graphModel.clearSelectElements()},e.prototype.getModelById=function(t){return this.graphModel.getElement(t)},e.prototype.getDataById=function(t){var r;return(r=this.graphModel.getElement(t))===null||r===void 0?void 0:r.getData()},e.prototype.deleteElement=function(t){var r,n,o,i=this.getModelById(t);if(!i)return!1;var a=(r={},r[ct.NODE]=this.deleteNode,r[ct.EDGE]=this.deleteEdge,r);return(o=(n=a[i.BaseType])===null||n===void 0?void 0:n.call(this,t))!==null&&o!==void 0?o:!1},e.prototype.setElementZIndex=function(t,r){return this.graphModel.setElementZIndex(t,r)},e.prototype.getAreaElement=function(t,r,n,o,i){return n===void 0&&(n=!0),o===void 0&&(o=!0),i===void 0&&(i=!1),this.graphModel.getAreaElement(t,r,n,o,i).map(function(a){return a.getData()})},e.prototype.setProperties=function(t,r){var n;(n=this.graphModel.getElement(t))===null||n===void 0||n.setProperties(Mt(r))},e.prototype.getProperties=function(t){var r;return(r=this.graphModel.getElement(t))===null||r===void 0?void 0:r.getProperties()},e.prototype.deleteProperty=function(t,r){var n;(n=this.graphModel.getElement(t))===null||n===void 0||n.deleteProperty(r)},e.prototype.updateAttributes=function(t,r){this.graphModel.updateAttributes(t,r)},e.prototype.editText=function(t){this.graphModel.editText(t)},e.prototype.updateText=function(t,r){this.graphModel.updateText(t,r)},e.prototype.updateEditConfig=function(t){var r=this.graphModel,n=r.editConfigModel,o=r.transformModel,i=n.snapGrid;if(n.updateEditConfig(t),(t==null?void 0:t.stopMoveGraph)!==void 0&&o.updateTranslateLimits(t.stopMoveGraph),t!=null&&t.isSilentMode?this.keyboard.disable():this.keyboard.enable(!0),!Qt(t==null?void 0:t.snapGrid)&&t.snapGrid!==i){var a=this.graphModel.grid.size,s=a===void 0?1:a;this.graphModel.updateGridSize(t.snapGrid?s:1)}},e.prototype.getEditConfig=function(){return this.graphModel.editConfigModel.getConfig()},e.prototype.setTheme=function(t){this.graphModel.setTheme(t)},e.prototype.focusByElement=function(t){var r=void 0,n=this.getNodeModelById(t);if(n){var o=n.getData(),i=o.x,a=o.y;r={x:i,y:a}}var s=this.getEdgeModelById(t);if(s){var l=s.textPosition,i=l.x,a=l.y;r={x:i,y:a}}r&&this.focusByCoordinate(r)},e.prototype.focusByCoordinate=function(t){var r=this.graphModel,n=r.transformModel,o=r.width,i=r.height,a=t.x,s=t.y;n.focusOn(a,s,o,i)},e.prototype.focusOn=function(t){if(typeof t=="string")this.focusByElement(t);else if("x"in t&&"y"in t)this.focusByCoordinate(t);else{var r=t.id,n=t.coordinate;r&&this.focusByElement(r),n&&this.focusByCoordinate(n)}},e.prototype.resize=function(t,r){this.graphModel.resize(t,r),this.options.width=this.graphModel.width,this.options.height=this.graphModel.height},e.prototype.toFront=function(t){this.graphModel.toFront(t)},e.prototype.getPointByClient=function(t,r){if(typeof t=="object")return this.graphModel.getPointByClient(t);if(typeof r=="number")return this.graphModel.getPointByClient({x:t,y:r})},e.prototype.getGraphData=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.getGraphRawData();return this.adapterOut?this.adapterOut.apply(this,Mi([n],ao(t),!1)):n},e.prototype.getGraphRawData=function(){return this.graphModel.modelToGraphData()},e.prototype.clearData=function(){this.graphModel.clearData(),this.render({})},e.prototype.renderRawData=function(t){this.graphModel.graphDataToModel(Mt(t)),this.options.history!==!1&&this.history.watch(this.graphModel),Ls(w(BE,{getView:this.getView,tool:this.tool,options:this.options,dnd:this.dnd,snaplineModel:this.snaplineModel,graphModel:this.graphModel}),this.container),this.emit(R.GRAPH_RENDERED,{data:this.graphModel.modelToGraphData(),graphModel:this.graphModel})},e.prototype.render=function(t){var r=k(t);this.adapterIn&&(r=this.adapterIn(r)),this.renderRawData(r)},e.prototype.undo=function(){if(this.history.undoAble()){var t=Mt(this.history.undo());this.clearSelectElements(),this.graphModel.graphDataToModel(t)}},e.prototype.redo=function(){if(this.history.redoAble()){var t=Mt(this.history.redo());this.clearSelectElements(),this.graphModel.graphDataToModel(t)}},e.prototype.zoom=function(t,r){var n=this.graphModel.transformModel;return n.zoom(t,r)},e.prototype.resetZoom=function(){var t=this.graphModel.transformModel;t.resetZoom()},e.prototype.setZoomMiniSize=function(t){var r=this.graphModel.transformModel;r.setZoomMiniSize(t)},e.prototype.setZoomMaxSize=function(t){var r=this.graphModel.transformModel;r.setZoomMaxSize(t)},e.prototype.getTransform=function(){var t=this.graphModel.transformModel,r=t.SCALE_X,n=t.SCALE_Y,o=t.TRANSLATE_X,i=t.TRANSLATE_Y;return{SCALE_X:r,SCALE_Y:n,TRANSLATE_X:o,TRANSLATE_Y:i}},e.prototype.translate=function(t,r){var n=this.graphModel.transformModel;n.translate(t,r)},e.prototype.resetTranslate=function(){var t=this.graphModel.transformModel,r=t.TRANSLATE_X,n=t.TRANSLATE_Y;this.translate(-r,-n)},e.prototype.translateCenter=function(){this.graphModel.translateCenter()},e.prototype.fitView=function(t,r){r===void 0&&(r=t),this.graphModel.fitView(t,r)},e.prototype.openEdgeAnimation=function(t){this.graphModel.openEdgeAnimation(t)},e.prototype.closeEdgeAnimation=function(t){this.graphModel.closeEdgeAnimation(t)},e.prototype.on=function(t,r){this.graphModel.eventCenter.on(t,r)},e.prototype.off=function(t,r){this.graphModel.eventCenter.off(t,r)},e.prototype.once=function(t,r){this.graphModel.eventCenter.once(t,r)},e.prototype.emit=function(t,r){this.graphModel.eventCenter.emit(t,r)},e.use=function(t,r){var n,o=t.pluginName;if(!o)throw new Error(" pluginName!");this.extensions.set(o,(n={},n[Ai]=Ai,n.extension=t,n.props=r,n))},e.prototype.installPlugins=function(t){var r=this;t===void 0&&(t=[]);var n=Array.from(e.extensions,function(i){var a=ao(i,2),s=a[1];return s}),o=Mi(Mi([],ao(this.plugins),!1),ao(n),!1);ht(o,function(i){var a,s;Ai in i?(a=i.extension,s=i.props):a=i;var l=a==null?void 0:a.pluginName;J_(t,l)===-1&&r.installPlugin(a,s)})},e.prototype.installPlugin=function(t,r){var n,o;if("pluginName"in t&&"install"in t){var i=t.pluginName,a=t.install,s=t.render;i&&(a&&a.call(t,this,e),s&&this.components.push(s.bind(t)),this.extension[i]=t);return}var l=t,u=l.pluginName,f=new l({lf:this,LogicFlow:e,props:r,options:(o=(n=this.options.pluginsOptions)===null||n===void 0?void 0:n[u])!==null&&o!==void 0?o:{}});f.render&&this.components.push(f.render.bind(f)),this.extension[u]=f},e.prototype.destroy=function(){var t;this.clearData(),Ls(null,this.container),this.keyboard.destroy(),this.graphModel.destroy(),this.tool.destroy(),this.history.destroy();for(var r in this.extension){var n=this.extension[r];"destroy"in n&&((t=n.destroy)===null||t===void 0||t.call(n))}},e.extensions=new Map,e}();(function(e){e.toStringTag="LF.".concat(e.name)})(ma||(ma={}));function $t(e){return Ia(e)}const k0=()=>{const e=[],t=async(l,u)=>{let f=_r.getFlowChart.url;console.log("flowtype",u);let d={Nodes:[],Links:[]},c=[];if(u!==we.POST){f=_r.getTaskProcessMap.url.toFetchUrl({params1:l});const{data:h,success:_,errorMessage:y}=await po(f,{processId:l});if(!_)return wr(y,"danger"),[];d=h.Process,c=h.Steps}else{const{data:h,success:_,errorMessage:y}=await po(f,{processId:l});if(!_)return wr(y,"danger"),[];d=h}const{Nodes:p,Links:v}=d;n(p,v,c)},r=async()=>{const l=await Object.assign({"/src/flowChart/nodes/ActivityNode.ts":()=>be(()=>import("./ActivityNode-Ck9zNWes.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url),"/src/flowChart/nodes/CallProcessNode.ts":()=>be(()=>import("./CallProcessNode-CHkK6tNm.js"),__vite__mapDeps([5,1,2,3,4]),import.meta.url),"/src/flowChart/nodes/ConditionNode.ts":()=>be(()=>import("./ConditionNode-CYl7dxNs.js"),__vite__mapDeps([6,1,2,3,4]),import.meta.url),"/src/flowChart/nodes/DecisionNode.ts":()=>be(()=>import("./DecisionNode-DJ8vpOy5.js"),__vite__mapDeps([7,1,2,3,4]),import.meta.url),"/src/flowChart/nodes/EndNode.ts":()=>be(()=>import("./EndNode-g8LYcBny.js"),__vite__mapDeps([8,1,2,3,4]),import.meta.url),"/src/flowChart/nodes/InformNode.ts":()=>be(()=>import("./InformNode-CgvM1kGY.js"),__vite__mapDeps([9,1,2,3,4]),import.meta.url),"/src/flowChart/nodes/NodeText.ts":()=>be(()=>import("./NodeText-Dmn4nlpl.js"),__vite__mapDeps([10,1,2,3,4]),import.meta.url),"/src/flowChart/nodes/NotifyNode.ts":()=>be(()=>import("./NotifyNode-BQABkVgM.js"),__vite__mapDeps([11,1,2,3,4]),import.meta.url),"/src/flowChart/nodes/StartNode.ts":()=>be(()=>import("./StartNode-ifew5xyC.js"),__vite__mapDeps([12,1,2,3,4]),import.meta.url)});for(let u in l){const d=await(await l[u])();d&&d.default&&e.push(d.default)}},n=(l,u,f)=>{const d=document.getElementById("flowContainer");if(!d){wr("","danger");return}const c=new ma({container:d,width:d.clientWidth,height:500}),p=[];for(const _ of l){const{ElementTypeName:y,Sprite:m,Name:S}=_,M=JSON.parse(m),A=i(y);if(A){c.register(A);const{sprites:b}=M;p.push({id:_.NodeId??S,type:y,x:M.translationX,y:M.translationY,Name:S,properties:{xValue:M.translationX,yValue:M.translationY,vName:S}});const g=i("NodeText");g&&(c.register(g),p.push({id:(_.NodeId??S)+"_"+b.text.text,type:"NodeText",x:M.translationX,y:M.translationY+25,Name:b.text.text+"_text",properties:{width:M.width,height:M.height,text:b.text.text,size:b.text.fontSize,fontFamily:b.text.fontFamily,color:b.text.fillStyle??"#000"}}))}}const v=o(f,p);p.push(...v);const h=[];a(p,d.clientWidth);for(const _ of u){const{FromNodeId:y,ToNodeId:m,Sprite:S,LinkID:M,DisplayString:A}=_,b=JSON.parse(S);if(b){const{points:g}=b;g.forEach(P=>{P.x-=15,P.y-=15});const x=p.find(P=>P.Name===y),T=p.find(P=>P.Name===m);x&&T&&h.push({id:M??_f(),type:"polyline",sourceNodeId:x.id,targetNodeId:T.id,pointsList:g,text:A})}}s(h),c.render({nodes:p,edges:h})},o=(l,u)=>{const f=[];if(l.length>0)for(const c of l){if(["sysInform","sysTaskOpt"].includes(c.NodeName))continue;var d=u.find(m=>m.Name===c.NodeName&&m.type!=="NodeText");const p=`${c.Finished?c.HandlerDisplayName:c.RecipientDisplayName}
                    (${c.Finished?c.HandlerAccount:c.RecipientAccount})`,v=`${c.Finished?c.FinishAt:c.ReceiveAt}`,h=c.SelActionDisplayString??c.SelAction,_=i("NodeText"),y=c.Finished?"#2eb731":"#c69a2f";_&&(f.push({id:c.StepID,type:"NodeText",x:d.x,y:d.y+45,Name:c.NodeName,properties:{text:p,color:y,size:"12px",fontFamily:"sans-serif"}}),f.push({id:c.StepID,type:"NodeText",x:d.x,y:d.y+62,Name:c.NodeName,properties:{text:v,color:y,size:"12px",fontFamily:"sans-serif"}}),h&&f.push({id:c.StepID,type:"NodeText",x:d.x,y:d.y+75,Name:c.NodeName,properties:{text:h,color:y,size:"12px",fontFamily:"sans-serif"}}))}return f},i=l=>e.find(u=>u.type===l),a=(l,u)=>{l.forEach(f=>{f.x>50&&f.y>50&&(f.x-=50,f.y-=50)})},s=l=>{l.forEach(u=>{u.pointsList.forEach(f=>{f.x>50&&f.y>50&&(f.x-=50,f.y-=50)})})};return{init:t,initNodes:r}},H0={key:0,id:"rotate-message",class:"rotate-message"},Y0=xa({__name:"MapPopup",props:mf({pageType:{}},{mapShow:{type:Boolean,default:!1},mapShowModifiers:{}}),emits:["update:mapShow"],setup(e){const t=yu(e,"mapShow"),{init:r,initNodes:n}=k0(),o=gu();let i="";xf(async()=>{if(e.pageType===we.POST){const{id:u}=o.params;i=String(u)}else if(e.pageType!==we.PROCESS){const{taskId:u}=o.params;i=String(u)}await n(),window.addEventListener("resize",s)}),Ti(()=>t.value,u=>{u&&bf(async()=>{s()||await r(i,e.pageType)})});const a=Ze(!1),s=()=>window.screen.orientation?(a.value=window.screen.orientation.type.includes("portrait"),a.value):(a.value=window.innerWidth<window.innerHeight,a.value);Ti(()=>a.value,u=>{u?l():(t.value=!1,r(i,e.pageType),setTimeout(()=>{t.value=!0},100))});const l=()=>{const u=document.getElementById("flowContainer");if(u&&u.children)for(let f=0;f<u.children.length;f++)u.children[f].remove()};return Ef(()=>{window.removeEventListener("resize",s)}),(u,f)=>{const d=Me("van-popup");return H(),Fe(d,{show:t.value,"onUpdate:show":f[0]||(f[0]=c=>t.value=c),position:"top",closeable:"","close-on-click-overlay":!0,"safe-area-inset-top":""},{default:Lt(()=>[gt(a)?(H(),q("div",H0,F(u.$t("Form.MapPou")),1)):Dt("",!0),f[1]||(f[1]=lt("div",{class:"flowContainer",id:"flowContainer"},null,-1))]),_:1},8,["show"])}}}),G0=Ea(Y0,[["__scopeId","data-v-e67a8410"]]),U0={class:"record-div"},z0={class:"record-header"},W0={class:"record-content"},V0={class:"tab-content"},K0={key:0},Z0={key:1},q0={class:"r-card-list"},J0={key:0},Q0={key:2},tb={key:3},eb={class:"tab-content"},rb={key:0},nb={key:1},ob={class:"tab-content"},ib={key:0},ab={key:1},sb={class:"r-card-list"},lb={key:0},ub={key:1,class:"no-user"},db=xa({__name:"RecordPopup",props:{moreShow:{type:Boolean,default:!1},moreShowModifiers:{}},emits:["update:moreShow"],setup(e){const t=Of(),r=yu(e,"moreShow"),{getFormEnv:n}=Mf(),o=n(),i=Ze("process"),a=wf(()=>t.getCurrentFormId),s=({name:g})=>{switch(g){case"process":v();break;case"timeline":_();break;case"proceefeat":p();break}},l=gu(),u=Ze([]),f=Ze([]),d=Ze([]),c=(g,x,T)=>o===we.POST?_r.getPostForecast.url.toFetchUrl({params1:g}):_r.getProcessForecast.url.toFetchUrl({params1:x,params2:T}),p=async()=>{const g=a.value,T={...t.getRuningHeader(g)},P=t.getRuningProviderName(g),j=t.getRuningMember(g),L=t.getRuningOuId(g);T.ouid=`${P}.${L}`,T.ownerPosition=`${P}.${j}`;const U=t.getRuningFormData(g);delete T.draftId;const{id:D,stepId:tt,taskId:et}=l.params,jt=c(String(D),String(et),String(tt)),zt={formData:U,header:T},{data:Et,success:Tt,errorMessage:X}=await Sf(jt,zt);if(!Tt){wr(X,"danger");return}u.value=Et.children??[]},v=async()=>{const{stepId:g,taskId:x}=l.params,T=_r.getTraceList.url.toFetchUrl({params1:x}),{data:P,success:j,errorMessage:L}=await po(T,{page:1,start:0,limit:100});if(!j){wr(L,"danger");return}const U=[];if(P&&P.children&&P.children.length>0)for(const D of P.children)U.push({...D}),D.fllowSteps&&D.fllowSteps.length>0&&U.push(...D.fllowSteps);f.value=U},h=g=>{const x=(g.SelAction||"").toLowerCase();if(g.IsTaskOptStep)switch(x){case"sysabort":return pt("Work.WithdrawApplication");case"sysreactive":return pt("Work.HandlerActive");case"sysdelete":return pt("Work.HandlerRemove");case"syscontinue":return pt("Work.HandlerRecovery");case"sysinform":return pt("Work.HandlerNotify")}return g.NodeName==="sysInform"?"":g.NodeDisplayName},_=async()=>{const{stepId:g,taskId:x}=l.params,T=_r.getTaskTimeLine.url.toFetchUrl({params1:x}),{data:P,success:j,errorMessage:L}=await po(T,{Method:"GetTimellineSteps",TaskID:x,limit:100,page:1,start:0});if(!j){wr(L,"danger");return}const{children:U}=P,D=[];U.forEach(tt=>{let et={...tt};et.Comments||(et.Comments=pt("Global.noCommentsfilled")),et.Finished?tt.NodeName===""?(et.handlerText=`${pt("Global.SignerGenerate")}`,et.handlerColor="color:#000000"):tt.isEndStep?(et.handlerText=`${tt.NodeDisplayName}`,et.handlerColor="color:red"):(et.handlerText=`${pt("Global.Signer")}${tt.HandlerDisplayName}`,et.handlerColor="color:#000000"):(et.handlerText=`${tt.RecipientDisplayName}${pt("Form.Processing")}...`,et.handlerColor="color:red"),et=y(tt,et),D.push(et)}),A(D),d.value=D},y=(g,x)=>{let T={};switch(g.SelAction){case"sysInform":x.NodeDisplayName=g.RecipientDisplayName,x.handlerText=pt("Work.Initiator")+`:${g.HandlerDisplayName}`,g.fllowSteps&&g.fllowSteps.length>0&&(x.otherRedText=`${pt("Form.NotifyTo")}: ${m(g.fllowSteps)}`);break;case"sysTransfer":g.nextSteps&&g.nextSteps.length>0&&(x.otherRedText=`${pt("Form.UrgFor")} ${m(g.nextSteps)}`);break;case"sysRecedeBack":g.nextSteps&&g.nextSteps.length>0&&(T=S(g.nextSteps),x.otherRedText=`${pt("Form.Return")}-->${T.nodes.join(",")}(${T.users.join(",")})`);break;case"sysRecedeRestart":x.otherRedText=pt("Work.WithdrawToRefill");break;case"sysReject":x.otherRedText=pt("Work.Rejected");break;case"sysPickBackRestart":g.nextSteps&&g.nextSteps.length>0&&(T=S(g.nextSteps),x.otherRedText=`${pt("Work.RetrieveToRefill")}-->${T.nodes.join(",")}(${T.users.join(",")})`);break;case"sysPickBack":g.nextSteps&&g.nextSteps.length>0&&(T=S(g.nextSteps),x.otherRedText=`${pt("Work.RetrieveToApproval")}-->${T.nodes.join(",")}(${T.users.join(",")})`);break;case"sysAbort":x.otherRedText=pt("Work.WithdrawApplication"),x.NodeDisplayName=pt("Work.WithdrawApplication");break}return x},m=g=>{const x=[];return g.forEach(T=>{x.push(T.RecipientDisplayName)}),x.join(",")},S=g=>{const x=[],T=[];return g.forEach(P=>{x.push(P.RecipientDisplayName),T.push(P.NodeDisplayName)}),{users:x,nodes:T}},M=Ze(0),A=g=>{const x=g.findIndex(T=>!T.Finished);if(M.value=100,x>-1)M.value=x;else{const T=g.findIndex(P=>P.isEndStep);T>-1&&(M.value=T)}},b=Ze(!1);return Ti(()=>r.value,(g,x)=>{g&&s({name:o===we.POST?"proceefeat":"process"})}),(g,x)=>{const T=Me("YZNav"),P=Me("van-empty"),j=Me("van-tab"),L=Me("van-tabs"),U=Me("van-popup");return H(),q(Or,null,[de(U,{show:r.value,"onUpdate:show":x[2]||(x[2]=D=>r.value=D),"close-icon":"close",position:"bottom","close-on-click-overlay":!1},{default:Lt(()=>[lt("div",U0,[lt("div",z0,[de(T,{title:g.$t("Work.TaskDetail"),"left-text":g.$t("Global.Close"),onOnLeftClick:x[0]||(x[0]=D=>r.value=!1)},{right:Lt(()=>x[4]||(x[4]=[])),_:1},8,["title","left-text"])]),lt("div",W0,[de(L,{active:gt(i),"onUpdate:active":x[1]||(x[1]=D=>Qa(i)?i.value=D:null),onClickTab:s},{default:Lt(()=>[gt(o)!==gt(we).POST?(H(),Fe(j,{key:0,title:g.$t("Form.approveList"),name:"process"},{default:Lt(()=>[lt("div",V0,[gt(f).length===0?(H(),q("div",K0,[de(P,{image:"search",description:g.$t("Form.approveListND")},null,8,["description"])])):(H(),q("div",Z0,[(H(!0),q(Or,null,en(gt(f),D=>(H(),q("div",{class:"r-card",key:D.NodeName},[lt("div",q0,[lt("p",null,F(g.$t("Form.processSteps"))+": "+F(h(D)),1),D.isEndStep?Dt("",!0):(H(),q("p",J0,F(g.$t("Form.processPersons"))+": "+F(D.RecipientDisplayName),1)),D.isEndStep?Dt("",!0):(H(),q("p",{key:1,style:hu({color:D.Finished?"":"#ee7739"})},F(g.$t("Form.processDeal"))+": "+F(D.SelActionDisplayString),5)),lt("p",null,F(g.$t("Form.processDate"))+": "+F(D.ReceiveAt),1),D.isEndStep?Dt("",!0):(H(),q("p",Q0,F(g.$t("Form.processDealDate"))+": "+F(D.FinishAt),1)),D.isEndStep?Dt("",!0):(H(),q("p",tb,F(g.$t("Form.processComment"))+": "+F(D.Comments),1))])]))),128))]))])]),_:1},8,["title"])):Dt("",!0),gt(o)!==gt(we).POST?(H(),Fe(j,{key:1,title:g.$t("Form.timeline"),name:"timeline"},{default:Lt(()=>[lt("div",eb,[gt(d).length===0?(H(),q("div",rb,[de(P,{image:"search",description:g.$t("Form.timelineND")},null,8,["description"])])):(H(),q("div",nb,[de(Vf,{steps:gt(d)},null,8,["steps"])]))])]),_:1},8,["title"])):Dt("",!0),gt(o)===gt(we).POST||gt(o)===gt(we).PROCESS?(H(),Fe(j,{key:2,title:g.$t("Form.approveForecast"),name:"proceefeat"},{default:Lt(()=>[lt("div",ob,[gt(u).length===0?(H(),q("div",ib,[de(P,{image:"search",description:g.$t("Form.approveForecastND")},null,8,["description"])])):(H(),q("div",ab,[(H(!0),q(Or,null,en(gt(u),D=>(H(),q("div",{class:"r-card",key:D.NodeName},[lt("div",sb,[lt("p",null,F(g.$t("Form.stepName"))+": "+F(D.StepDisplayName),1),D.OwnerAccount?(H(),q("p",lb,F(g.$t("Form.stepOwner"))+": "+F(`${D.OwnerDisplayName}(${D.OwnerAccount})`),1)):(H(),q("p",ub,F(g.$t("Form.stepName"))+": "+F(g.$t("Form.nobodyDeal")),1)),lt("p",null,F(g.$t("Form.stepAgent"))+": "+F(D.AgentDisplayName?`${D.AgentDisplayName}(${D.AgentAccount})`:""),1)])]))),128))]))])]),_:1},8,["title"])):Dt("",!0)]),_:1},8,["active"])])])]),_:1},8,["show"]),de(G0,{"map-show":gt(b),"onUpdate:mapShow":x[3]||(x[3]=D=>Qa(b)?b.value=D:null),"page-type":gt(o)},null,8,["map-show","page-type"])],64)}}}),fb=Ea(db,[["__scopeId","data-v-9ec3a7b2"]]),vb=Object.freeze(Object.defineProperty({__proto__:null,default:fb},Symbol.toStringTag,{value:"Module"}));export{Jl as H,fb as R,au as a,vb as b};
