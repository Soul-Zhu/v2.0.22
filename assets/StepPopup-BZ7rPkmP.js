import{d as I,aO as w,m as u,w as L,s as C,e as l,i as P,u as h,r as p,g as k,h as T,b as _,a as U,j as E,k as N,t as i,F as O,A as R,q as b,p as q,K as A}from"./main-BnXXyOo5.js";const j=I({__name:"StepPopup",props:{title:{default:"退单"},stepPicker:{type:Boolean,default:!1},type:{default:w.STEP}},emits:["update:stepPicker","update:stepChecked"],setup(B,{emit:D}){const c=u([]),a=u([]),d=u([]),g=B,n=u(!1),y=D,x=()=>{a.value.length!==0&&(d.value=c.value.filter(t=>a.value.includes(t.StepID)).map(t=>t.NodeDisplayName),y("update:stepChecked",a.value,d.value))},V=()=>{a.value.length=0,c.value.length=0,d.value.length=0,y("update:stepPicker")},S=R(),F=()=>new Promise((t,o)=>{let r="";if(g.type===w.STEP){const{stepId:s}=S.params;r=b.getReturnStepList.url.toFetchUrl({params1:s})}else{const{taskId:s}=S.params;r=b.getPickBackSteps.url.toFetchUrl({params1:s})}q(r,{page:1,start:0,limit:50}).then(s=>{const{success:m,data:f,errorMessage:v}=s;if(!m)A(v,"danger"),o(!1);else{const e=f.children;c.value=e,t(!0)}})});return L(()=>g.stepPicker,async t=>{t?(await F(),n.value=!0):n.value=!1}),(t,o)=>{const r=p("van-checkbox"),s=p("van-tag"),m=p("van-cell"),f=p("van-checkbox-group"),v=p("van-dialog");return k(),C(v,{show:h(n),"onUpdate:show":o[1]||(o[1]=e=>P(n)?n.value=e:null),title:t.title,teleport:"body",onConfirm:x,onCancel:V,"before-close":()=>!1,"show-cancel-button":""},{default:l(()=>[T("div",null,[_(f,{modelValue:h(a),"onUpdate:modelValue":o[0]||(o[0]=e=>P(a)?a.value=e:null),shape:"square"},{default:l(()=>[(k(!0),U(O,null,E(h(c),e=>(k(),C(m,{key:e.StepID},{title:l(()=>[_(r,{name:e.StepID},{default:l(()=>[N(i(t.$t("Form.stepName"))+"("+i(e.NodeDisplayName)+")",1)]),_:2},1032,["name"])]),value:l(()=>[_(s,{type:"primary",size:"large"},{default:l(()=>[N(i(e.OwnerDisplayName)+"("+i(e.OwnerAccount)+")",1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])])]),_:1},8,["show","title"])}}});export{j as default};
