import{d as D,L as k,M as E,m as v,o as K,x as q,w as A,J as F,K as U,Q as p,a as g,l as H,v as L,u as s,h as W,b,e as w,i as C,r as N,G as Y,g as h,n as Z,F as I,j as P,s as T,k as z,t as G,q as J}from"./main-BnXXyOo5.js";import Q from"./YZOrgSelect-CbvC4m2r.js";import{_ as X}from"./YZChangeFieldTag.vue_vue_type_style_index_0_lang-CU_sMXjx.js";import{u as ee}from"./formWatch-KqHO0hI-.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./encodeext-DBC3bVZy.js";import"./useFormEnv-VwQXjqJl.js";import"./useInitFieldState-EKN-2KHT.js";const ae={key:0},se=D({__name:"YZOus",props:k({cfg:{},formRow:{}},{modelValue:{type:String},modelModifiers:{}}),emits:k(["update:field"],["update:modelValue"]),setup(y,{emit:S}){const n=E(y,"modelValue"),m=y,l=v(m.cfg),f=v([]),o=v(),{WatchChageExpress:O,WatchSelfExpress:x}=ee();K(()=>{M(),q(async()=>{n.value&&await V(n.value.split(",")),x(l.value,m.formRow,e=>{},e=>{l.value.hidden=e,c("update:field",l.value)},e=>{l.value.disabled=e,c("update:field",l.value)},e=>{l.value.hidden=e,c("update:field",l.value)})})}),A(()=>n.value,(e,a)=>{if(O(m.cfg,e,m.formRow),e){const u=e.split(",");V(u)}});const _=v(!1),V=async e=>{const a=J.getSimpleDept.url,{success:u,data:t,errorMessage:i}=await F(a,{ouids:e,showFullPath:!0});if(!u)return U(i,"danger"),null;t&&(o.value=t&&t.map(r=>r.text).join(","),n.value=t&&t.map(r=>`${r.providerName}.${r.ouid}`).join(","))},c=S,$=v(""),M=()=>{const e=l.value,a=`setDisabled_${e.uuid}_${e.fullKey}`,u=`setHidden_${e.uuid}_${e.fullKey}`,t=`setColumnHidden_${e.uuid}_${e.fullKey}`,i=`setRules_${e.uuid}_${e.fullKey}`,r=`setClose_${e.uuid}`;p.on(a,d=>{l.value.disabled=d,c("update:field",l.value)}),p.on(u,d=>{l.value.hidden=d,c("update:field",l.value)}),p.on(t,d=>{l.value.hidden=d,c("update:field",l.value)}),p.on(i,d=>{l.value.rules=[d],c("update:field",l.value)}),p.on(r,d=>{$.value=d})},j=()=>{var e;if(!m.cfg.disabled){if(o.value&&n.value){const a=n.value.split(","),u=(e=o.value)==null?void 0:e.split(",");f.value=[];for(let t=0;t<u.length;t++)f.value.push({name:u[t],ouid:String(a[t].split(".")[1]),code:"",modelValue:""})}_.value=!0}},B=e=>{e&&e.length>0?(n.value=e.map(a=>a.modelValue).join(","),o.value=e.map(a=>a.name).join(",")):(n.value="",o.value="",f.value.length=0)},R=e=>{if(o.value&&n.value){let a=o.value.split(","),u=n.value.split(",");a.splice(e,1),u.splice(e,1),o.value=a.join(","),n.value=u.join(",")}};return(e,a)=>{const u=N("van-tag"),t=N("van-field");return h(),g("div",{class:Y(s($))},[H(W("div",null,[b(t,{readonly:"",name:s(l).bindModel,label:s(l).fieldLabel,placeholder:s(l).placeholder,required:s(l).required,rules:s(l).rules,disabled:s(l).disabled,clickable:"","is-link":!s(l).disabled,modelValue:s(o),"onUpdate:modelValue":a[0]||(a[0]=i=>C(o)?o.value=i:null),onClick:j},{input:w(()=>[s(o)?(h(),g("div",ae,[(h(!0),g(I,null,P(s(o).split(","),(i,r)=>(h(),T(u,{class:"user-tag",closeable:!s(l).disabled,key:r,type:"primary",plain:"",onClose:d=>R(r)},{default:w(()=>[z(G(i),1)]),_:2},1032,["closeable","onClose"]))),128))])):Z("",!0)]),button:w(()=>[b(X,{field:s(l)},null,8,["field"])]),_:1},8,["name","label","placeholder","required","rules","disabled","is-link","modelValue"]),b(Q,{show:s(_),"onUpdate:show":a[1]||(a[1]=i=>C(_)?_.value=i:null),multiple:"",defaultOrgs:s(f),onOnSave:B},null,8,["show","defaultOrgs"])],512),[[L,!s(l).hidden]])],2)}}}),me=le(se,[["__scopeId","data-v-5936ed0f"]]);export{me as default};
