import{d as Z,L as N,M as I,m,c as J,aw as n,w as X,o as j,x as O,Q as p,a as ee,l as ae,v as te,u as s,h as le,b as h,e as $,r as _,i as H,G as se,ax as oe,ay as ne,az as C,aA as Y,g as E,s as ue,n as ie,as as x,aB as de}from"./main-BnXXyOo5.js";import{_ as ce}from"./YZChangeFieldTag.vue_vue_type_style_index_0_lang-CU_sMXjx.js";import{u as re}from"./formWatch-KqHO0hI-.js";import"./encodeext-DBC3bVZy.js";import"./useFormEnv-VwQXjqJl.js";import"./useInitFieldState-EKN-2KHT.js";const _e=Z({__name:"YZDatetime",props:N({cfg:{},formRow:{}},{modelValue:{type:String},modelModifiers:{}}),emits:N(["update:field"],["update:modelValue"]),setup(T,{emit:B}){const{WatchChageExpress:b,WatchSelfExpress:F}=re(),u=I(T,"modelValue",{get(e){if(e)return x[k](e)}}),o=T,t=m(o.cfg),k=o.cfg.formatter,v=m(!1),R=m([]),S=J(()=>k===n.Hi?["hour","minute"]:["hour","minute","second"]),K=()=>{o.cfg.disabled||(z(),R.value=de(k),v.value=!0)},w=m(["选择日期"]),y=m(!1),P=new Date().getFullYear(),U=new Date().getMonth()+1,W=new Date().getDate(),q=new Date().getHours(),A=new Date().getMinutes();new Date().getSeconds();const d=m([P,U,W]),i=m([q,A]),L=e=>{if(e&&e.length>0)if(e.length===1){const{selectedValues:a}=e[0],c=o.cfg.formatter,r=x[c](a);u.value=r}else{const{selectedValues:a}=e[0],{selectedValues:c}=e[1],r=o.cfg.formatter,g=x[r](a,c);u.value=g}v.value=!1},z=()=>{const e=o.cfg.formatter;y.value=!1,e===n.YmdHi||e===n.YmdHis?w.value=["选择日期","选择时间"]:e===n.Hi||e===n.His?(y.value=!0,w.value=["选择时间"]):w.value=["选择日期"]};X(()=>u.value,(e,a)=>{b(o.cfg,e,o.formRow)},{});const G=e=>{const a=e??d.value.join("/");switch(k){case n.Ymd:d.value=a.split("/");break;case n.YmdHi:d.value=Y(a).split("/"),i.value=C(a).split(":");break;case n.YmdHis:d.value=Y(a).split("/"),i.value=C(a).split(":");break;case n.Hi:/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])$/.test(a)?i.value=a.split(":"):i.value=C(a).split(":");break;case n.Ym:d.value=ne(a).split("/");break;case n.His:/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])$/.test(a)?i.value=a.split(":"):i.value=oe(a).split(":");break}};j(()=>{G(u.value),O(()=>{Q(),F(t.value,o.formRow,e=>{u.value=e},e=>{t.value.hidden=e,f("update:field",t.value)},e=>{t.value.disabled=e,f("update:field",t.value)},e=>{t.value.hidden=e,f("update:field",t.value)}),o.cfg.needWatchChange&&b(o.cfg,u.value,o.formRow)})});const f=B,M=m(""),Q=()=>{const e=t.value,a=`setDisabled_${e.uuid}_${e.fullKey}`,c=`setHidden_${e.uuid}_${e.fullKey}`,r=`setColumnHidden_${e.uuid}_${e.fullKey}`,g=`setRules_${e.uuid}_${e.fullKey}`,V=`setClose_${e.uuid}`,D=`autoActiveEvent_${e.uuid}_${e.fullKey}`;p.on(D,()=>{b(o.cfg,u.value,o.formRow)}),p.on(a,l=>{t.value.disabled=l,f("update:field",t.value)}),p.on(c,l=>{t.value.hidden=l,f("update:field",t.value)}),p.on(r,l=>{t.value.hidden=l,f("update:field",t.value)}),p.on(g,l=>{t.value.rules=[l],f("update:field",t.value)}),p.on(V,l=>{M.value=l})};return(e,a)=>{const c=_("van-field"),r=_("van-date-picker"),g=_("van-time-picker"),V=_("van-picker-group"),D=_("van-popup");return E(),ee("div",{class:se(s(M))},[ae(le("div",null,[h(c,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=l=>u.value=l),"is-link":!s(t).disabled,readonly:"",name:s(t).bindModel,label:s(t).fieldLabel,placeholder:s(t).placeholder,onClick:K,disabled:s(t).disabled,required:s(t).required,rules:s(t).rules},{button:$(()=>[h(ce,{field:s(t)},null,8,["field"])]),_:1},8,["modelValue","is-link","name","label","placeholder","disabled","required","rules"]),h(D,{show:s(v),"onUpdate:show":a[4]||(a[4]=l=>H(v)?v.value=l:null),position:"bottom"},{default:$(()=>[h(V,{title:s(t).fieldLabel,tabs:s(w),onConfirm:L,onCancel:a[3]||(a[3]=l=>v.value=!1)},{default:$(()=>[s(y)?ie("",!0):(E(),ue(r,{key:0,modelValue:s(d),"onUpdate:modelValue":a[1]||(a[1]=l=>H(d)?d.value=l:null),"columns-type":s(R)},null,8,["modelValue","columns-type"])),h(g,{modelValue:s(i),"onUpdate:modelValue":a[2]||(a[2]=l=>H(i)?i.value=l:null),"columns-type":s(S)},null,8,["modelValue","columns-type"])]),_:1},8,["title","tabs"])]),_:1},8,["show"])],512),[[te,!s(t).hidden]])],2)}}});export{_e as default};
