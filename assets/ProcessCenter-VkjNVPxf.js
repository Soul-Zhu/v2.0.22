const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SearchPanel-BQIkH5_M.js","./main-BnXXyOo5.js","./main-CVDmtNd4.css","./_plugin-vue_export-helper-DlAUqK2U.js","./RecentApp-Cod6tgb6.js","./RecentApp-Cm9TasN-.css","./SearchPanel-Cd2vDVgf.css"])))=>i.map(i=>d[i]);
import{m as u,E as te,o as ae,aH as ce,p as G,q as V,K as q,d as ne,a as S,g as y,h as i,l as Z,b as v,u as n,r as _,v as H,e as m,F as J,j as Q,i as L,J as re,y as U,P as X,s as W,V as ee,G as oe,t as A,aG as ie,n as K,f as de,_ as ue,k as he}from"./main-BnXXyOo5.js";import{R as se}from"./RecentApp-Cod6tgb6.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const pe=()=>{const T=u(30),j=u(["1"]),w=u(0),P=u([]),x=u([]),C=u([]),g=u([]),I=u([]),h=u([]),E=u(""),N=u(!1),k=te();ae(async()=>{const e=ce("home-title");e>0&&(T.value=e+30),await $()});const $=async()=>{await O(),await F(),await s()},F=async()=>{P.value.length=0;const e=x.value,{success:t,data:o}=await G(V.getCommonuseProcss.url,{page:1,start:0,limit:25});if(t){const{data:r}=o;Array.from(r).forEach(p=>{p.MobileInitiation&&(p.textName=p.ProcessName,p.ShortName&&(p.textName=p.ShortName),e.find(le=>le.ProcessName===p.ProcessName)&&(p.IsCollection=!0)),P.value.push(p)})}},O=async()=>{x.value.length=0;const{success:e,data:t}=await G(V.getMyCollection.url,{page:1,start:0,limit:25});if(e){const{data:o}=t;Array.from(o).forEach(l=>{l.MobileInitiation&&(l.textName=l.ProcessName,l.ShortName&&(l.textName=l.ShortName)),x.value.push(l)})}},s=async()=>{C.value.length=0;const{success:e,data:t,errorMessage:o}=await G(V.getProcessTree.url,{perm:"Execute",expand:!0,node:"root"});if(!e){q(o,"danger");return}if(t&&t.children&&t.children.length>0){const{children:r}=t;r.forEach(l=>{const p={text:l.text,fid:l.fid,children:l.children,processVersion:l.processVersion??null,isProcess:!1,IconCls:l.IconCls??null,IconColor:l.IconColor??null};C.value.push(p)})}I.value=f(t.children,""),h.value=[{text:"全部",fid:""}]},d=(e,t="")=>({text:e.text,fid:e.fid,parentId:t,processVersion:e.processVersion??null,isProcess:!1,IconCls:e.IconCls??null,IconColor:e.IconColor??null}),c=e=>{let t=e.ProcessName;return e.ShortName&&(t=e.ShortName),{text:t,fid:e.Id,IconCls:e.IconCls,isProcess:!0,processVersion:e.ProcessVersion,IconColor:e.IconColor,IsCollection:e.IsCollection,children:[]}},f=(e,t)=>{const o=[];return e.forEach(r=>{if(r.children&&r.children.length>0){const l=d(r,t);o.push(l),o.push(...f(r.children,r.fid))}else{const l=d(r,t);o.push(l)}}),o},b=async e=>{e.isProcess||h.value.find(o=>o.fid===e.fid)||h.value.push({text:e.text,fid:e.fid}),e.isProcess?k.push({path:"/post/"+e.fid}):(C.value.length=0,R(e.fid),await D(e))},D=async e=>{const{success:t,data:o,errorMessage:r}=await G(V.getFolderProcess.url.toFetchUrl({params1:e.fid}),{perm:"Execute",favorite:!0,start:0,page:1,limit:100});if(!t){q(r,"danger");return}const{children:l}=o;l&&l.length>0&&l.forEach(p=>{const Y=c(p);C.value.push(Y)})},R=e=>{const t=I.value.filter(o=>o.parentId===e);t&&t.length>0&&t.forEach(o=>{C.value.push({text:o.text,fid:o.fid,processVersion:o.processVersion??null,isProcess:!1,IconCls:o.IconCls??null,IconColor:o.IconColor??null,children:[]})})};return{width:T,activeColl:j,commonuse:P,processData:C,collection:x,onFolderClick:b,homeBread:h,onBreadClick:(e,t)=>{if(e==="全部")h.value.length=0,s();else{const o=I.value.find(r=>r.text===e&&r.fid===t);if(o){b({text:o.text,fid:o.fid,isProcess:!1,processVersion:o.processVersion??null,IconCls:o.IconCls??null,IconColor:o.IconColor??null});let r=h.value.findIndex(l=>l.fid===o.fid);h.value=h.value.slice(0,r+1)}}},onSearch:async e=>{N.value=!0;const{success:t,data:o,errorMessage:r}=await G(V.searchProcess.url,{perm:"Execute",favorite:!0,searchType:"QuickSearch",kwd:e,start:0,page:1,limit:100});if(!t)return q(r,"danger"),!1;const{children:l}=o;g.value.length=0,l.forEach(p=>{const Y=c(p);g.value.push(Y)})},searchKwd:E,isSearch:N,onClear:()=>{N.value=!1,C.value.length=0,g.value.length=0,$()},searchProcessData:g,onCollect:()=>{O()},taskActive:w}},ve={class:"recent-type"},Ce={class:"grid-item"},me={class:"grid-text"},_e=["onClick"],ge={class:"flex-folder-item-text"},ye=ne({__name:"RecentFolder",props:{processData:{}},emits:["onClick","onCollect"],setup(T,{emit:j}){const w=u(!1),P=j,x=te(),C=s=>{P("onClick",s)},g=u(!1),I=u([]),h=u(),E=s=>{if(!s.isProcess)return;const d=U("home.CanColl"),c=U("home.AddColl"),f=U("home.Delegation");I.value=[{name:s.IsCollection?d:c,type:"collect"},{name:f,type:"otherFill"}],g.value=!0,h.value=s},N=s=>{switch(s.type){case"otherFill":$();break;case"collect":O();break}},k=u(!1),$=()=>{k.value=!0},F=s=>{var c;if(s.length==0){q("请选择代填人");return}const d=String((c=h.value)==null?void 0:c.fid);x.push({path:"/post/"+d,query:{memberId:s[0].memberId,providerName:s[0].providerName}})},O=async()=>{let s=h.value,d=s.IsCollection?V.cancleCollection.url.toFetchUrl({params1:s.fid}):V.addCollection.url.toFetchUrl({params1:s.fid});if((await re(d,{})).success){const f=U("home.CacnleEnd"),b=U("home.AddEnd");X({type:"success",message:s.IsCollection?`${s.text}-${f}`:`${s.text}-${b}`});let D=!s.IsCollection;s.IsCollection=D,P("onCollect")}else X({type:"danger",message:U("home.ControlFa")})};return(s,d)=>{const c=_("van-icon"),f=_("van-grid-item"),b=_("van-grid"),D=_("van-action-sheet"),R=_("YZMemberSelect"),M=ie("longpress");return y(),S("div",null,[i("div",ve,[i("div",{class:"rty rty-right",onClick:d[0]||(d[0]=a=>w.value=!n(w))},[v(c,{name:n(w)?"list-switch":"apps-o"},null,8,["name"])])]),Z(i("div",null,[v(b,{square:"",border:!0},{default:m(()=>[(y(!0),S(J,null,Q(s.processData,(a,B)=>Z((y(),W(f,{onClick:z=>C(a),key:B},{default:m(()=>[i("div",Ce,[i("div",{class:"grid-icon",style:ee({background:a.isProcess?a.IconColor??"#5dc663":"#db6541"})},[i("div",{class:oe(["icon-content "+(a.isProcess?a.IconCls??"iconfont icon-zhidu":"fa fa-folder")])},null,2)],4),i("span",me,A(a.text),1)])]),_:2},1032,["onClick"])),[[M,()=>E(a)]])),128))]),_:1})],512),[[H,n(w)]]),Z(i("div",null,[(y(!0),S(J,null,Q(s.processData,(a,B)=>Z((y(),S("div",{class:"flex-folder-list",key:B,onClick:z=>C(a)},[i("div",{class:"flex-folder-item-list",style:ee({background:a.isProcess?"#f8f8f8f8":"#db6541",color:a.IconColor})},[i("div",{class:oe(["icon-content "+(a.isProcess?a.IconCls??"iconfont icon-zhidu":"fa fa-folder")])},null,2)],4),i("div",ge,A(a.text),1)],8,_e)),[[M,()=>E(a)]])),128))],512),[[H,!n(w)]]),v(D,{show:n(g),"onUpdate:show":d[1]||(d[1]=a=>L(g)?g.value=a:null),actions:n(I),onSelect:N,"cancel-text":s.$t("Global.Cancle"),"close-on-click-action":""},null,8,["show","actions","cancel-text"]),v(R,{show:n(k),"onUpdate:show":d[2]||(d[2]=a=>L(k)?k.value=a:null),multiple:!1,onOnSave:F},null,8,["show"])])}}}),Pe=fe(ye,[["__scopeId","data-v-c9778523"]]),ke={class:"home-page"},we={class:"home-search-div"},xe={class:"home-content"},Ie={key:0,class:"home-tabs"},be={class:"home-title",id:"home-title"},Se={class:"home-all"},Ne={class:"home-bread"},$e=["onClick"],De={class:"home-content-div"},Ve={class:"home-title",id:"home-title"},Ae={class:"home-colse-title"},Ee={class:"home-colse-title"},Fe=ne({__name:"ProcessCenter",setup(T){const j=de(()=>ue(()=>import("./SearchPanel-BQIkH5_M.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url)),{width:w,activeColl:P,commonuse:x,collection:C,processData:g,onFolderClick:I,homeBread:h,onBreadClick:E,onSearch:N,searchKwd:k,isSearch:$,onClear:F,searchProcessData:O,onCollect:s,taskActive:d}=pe();return(c,f)=>{const b=_("YZNav"),D=_("van-search"),R=_("van-icon"),M=_("van-tab"),a=_("van-collapse-item"),B=_("van-collapse"),z=_("van-tabs");return y(),S("div",ke,[v(b,{title:c.$t("LayOut.Center"),rightText:""},null,8,["title"]),i("div",we,[v(D,{shape:"round","clear-trigger":"always",clearable:"","model-value":n(k),"onUpdate:modelValue":f[0]||(f[0]=e=>L(k)?k.value=e:null),onSearch:n(N),onClear:n(F),placeholder:c.$t("Global.keywordsSearch")},null,8,["model-value","onSearch","onClear","placeholder"])]),i("div",xe,[n($)?K("",!0):(y(),S("div",Ie,[v(z,{active:n(d),"onUpdate:active":f[2]||(f[2]=e=>L(d)?d.value=e:null),"line-width":n(w)},{default:m(()=>[v(M,{title:"全部流程"},{title:m(()=>[i("span",be,A(c.$t("home.AllProcess")),1)]),default:m(()=>[i("div",Se,[i("div",Ne,[(y(!0),S(J,null,Q(n(h),(e,t)=>(y(),S("span",{key:e.fid,onClick:o=>n(E)(e.text,e.fid)},[he(A(e.text)+" ",1),t<n(h).length-1?(y(),W(R,{key:0,name:"arrow"})):K("",!0)],8,$e))),128))]),i("div",De,[v(Pe,{"process-data":n(g),onOnClick:n(I),onOnCollect:n(s)},null,8,["process-data","onOnClick","onOnCollect"])])])]),_:1}),v(M,{title:c.$t("home.UseProcess")},{title:m(()=>[i("span",Ve,A(c.$t("home.UseProcess")),1)]),default:m(()=>[v(B,{modelValue:n(P),"onUpdate:modelValue":f[1]||(f[1]=e=>L(P)?P.value=e:null)},{default:m(()=>[v(a,{title:c.$t("home.Recent"),name:"1"},{title:m(()=>[i("span",Ae,A(c.$t("home.Recent")),1)]),default:m(()=>[v(se,{apps:n(x),onOnCollect:n(s),"show-grid":!1},null,8,["apps","onOnCollect"])]),_:1},8,["title"]),v(a,{title:c.$t("home.MyCollection"),name:"2"},{title:m(()=>[i("span",Ee,A(c.$t("home.MyCollection")),1)]),default:m(()=>[v(se,{apps:n(C),onOnCollect:n(s),"show-grid":!1},null,8,["apps","onOnCollect"])]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1},8,["title"])]),_:1},8,["active","line-width"])])),n($)?(y(),W(n(j),{key:1,processData:n(O),onOnSarchBack:n(F)},null,8,["processData","onOnSarchBack"])):K("",!0)])])}}}),Ue=Object.freeze(Object.defineProperty({__proto__:null,default:Fe},Symbol.toStringTag,{value:"Module"}));export{Ue as P,Pe as R};
