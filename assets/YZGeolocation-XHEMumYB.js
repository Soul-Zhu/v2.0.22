import{d as S,L as b,M as E,m,o as K,x as B,Q as c,a as D,l as M,v as g,h as q,b as v,e as F,r as C,G as H,g as R,I as Y}from"./main-BnXXyOo5.js";import{_ as Z}from"./YZChangeFieldTag.vue_vue_type_style_index_0_lang-CU_sMXjx.js";import{u as G}from"./formWatch-KqHO0hI-.js";import"./encodeext-DBC3bVZy.js";import"./useFormEnv-VwQXjqJl.js";import"./useInitFieldState-EKN-2KHT.js";const T=S({__name:"YZGeolocation",props:b({cfg:{},formRow:{}},{modelValue:{type:String},modelModifiers:{}}),emits:b(["update:field"],["update:modelValue"]),setup(p,{emit:V}){const f=E(p,"modelValue"),n=p,e=m(n.cfg),h=m(""),r=m(!1),{WatchSelfExpress:$}=G(),t=V;K(()=>{$(e.value,n.formRow,l=>{},l=>{e.value.hidden=l,t("update:field",e.value)},l=>{e.value.disabled=l,t("update:field",e.value)},l=>{e.value.hidden=l,t("update:field",e.value)}),B(()=>{x()})});const k=()=>{n.cfg.disabled||(r.value=!0)},w=l=>{const a=`${l.pcd.replaceAll("/","")} ${l.pcdDetail}`;f.value=a,h.value=a,r.value=!1,N(l)},y=()=>{r.value=!1},{setFormValue:L}=Y(),N=l=>{if(n.cfg.map){const a=n.cfg.map;Object.keys(a).forEach(i=>{const d=i,s=a[d];let u="";d==="address"?u=l.pcdDetail:d==="latitude"?u=String(l.lat):d==="longitude"&&(u=String(l.lng)),L(n.cfg,s,u)})}},_=m(""),x=()=>{const l=e.value,a=`setDisabled_${l.uuid}_${l.fullKey}`,i=`setHidden_${l.uuid}_${l.fullKey}`,d=`setColumnHidden_${l.uuid}_${l.fullKey}`,s=`setRules_${l.uuid}_${l.fullKey}`,u=`setClose_${l.uuid}`;c.on(a,o=>{e.value.disabled=o,t("update:field",e.value)}),c.on(i,o=>{e.value.hidden=o,t("update:field",e.value)}),c.on(d,o=>{e.value.hidden=o,t("update:field",e.value)}),c.on(s,o=>{e.value.rules=[o],t("update:field",e.value)}),c.on(u,o=>{_.value=o})};return(l,a)=>{const i=C("van-field"),d=C("YZMap");return R(),D("div",{class:H(_.value)},[M(q("div",null,[M(v(i,{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=s=>f.value=s),rules:e.value.rules,name:e.value.bindModel,label:e.value.fieldLabel,required:e.value.required,readonly:"",disabled:e.value.disabled,"right-icon":"location-o",onClick:k,placeholder:e.value.placeholder},{button:F(()=>[v(Z,{field:e.value},null,8,["field"])]),_:1},8,["modelValue","rules","name","label","required","disabled","placeholder"]),[[g,!e.value.hidden]]),v(d,{showLocation:r.value,bindModel:e.value.uuid,isLimited:e.value.limitMap,enableMapClick:e.value.mapClick,defualtLocation:h.value,onConfirm:w,onCancel:y},null,8,["showLocation","bindModel","isLimited","enableMapClick","defualtLocation"])],512),[[g,!e.value.hidden]])],2)}}});export{T as default};
