import{d as B,L as h,M as T,m as c,o as Z,Z as $,x as Y,Q as m,a as z,l as I,v as K,u as s,h as k,s as L,b as O,e as R,r as w,G as U,g as y,k as W,t as j,P as G,y as H,I as Q}from"./main-BnXXyOo5.js";import"./encodeext-DBC3bVZy.js";import{u as q}from"./useFormEnv-VwQXjqJl.js";import{u as A}from"./formWatch-KqHO0hI-.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useInitFieldState-EKN-2KHT.js";const X={class:"data-btn"},ee=B({__name:"YZDatabrowserbtn",props:h({cfg:{},formRow:{}},{modelValue:{type:String},modelModifiers:{}}),emits:h(["update:field"],["update:modelValue"]),setup(f,{emit:F}){const{setFormValue:V}=Q(),{WatchSelfExpress:C}=A(),{getFormEnv:D}=q(),x=D(),u=T(f,"modelValue"),v=c(""),o=f,e=c(o.cfg),r=c(!1);Z(async()=>{x===$.POST&&u.value&&(v.value=u.value),Y(()=>{P(),C(e.value,o.formRow,a=>{},a=>{e.value.hidden=a,i("update:field",e.value)},a=>{e.value.disabled=a,i("update:field",e.value)},a=>{})})});const E=()=>{if(!o.cfg.disabled){if(!o.cfg.ds){G({type:"danger",message:H("Form.unConfigDs")});return}r.value=!0}},p=a=>{r.value=a},N=async a=>{const l=o.cfg;if(!l.ds)return;const n=l.ds.map,d=Object.keys(n),t=l.ds.valueField;d.forEach(b=>{const S=a[b],M=n[b];V(o.cfg,M,S)});const _=String(a[t]);u.value=_,v.value=_,p(!1)},i=F,g=c(""),P=()=>{const a=e.value,l=`setDisabled_${a.uuid}_${a.fullKey}`,n=`setHidden_${a.uuid}_${a.fullKey}`,d=`setClose_${a.uuid}`;m.on(l,t=>{e.value.disabled=t,i("update:field",e.value)}),m.on(n,t=>{e.value.hidden=t,i("update:field",e.value)}),m.on(d,t=>{g.value=t})};return(a,l)=>{const n=w("van-button"),d=w("YZDataDialog");return y(),z("div",{class:U(s(g))},[I(k("div",null,[k("div",X,[O(n,{icon:"search",size:"small",block:"",onClick:E,disabled:s(e).disabled},{default:R(()=>[W(j(s(e).btnText),1)]),_:1},8,["disabled"])]),(y(),L(d,{showPicker:s(r),title:s(e).dialogTitle,ds:s(e).ds,currentField:s(e),viewColumns:s(e).viewColumns,onUpdatePicker:p,multiple:!1,"onUpdate:field":N,key:Math.random()},null,8,["showPicker","title","ds","currentField","viewColumns"]))],512),[[K,!s(e).hidden]])],2)}}}),de=J(ee,[["__scopeId","data-v-b681fde1"]]);export{de as default};
